/* all.min.js - Tiger skin scripts */
var VER='5.7.2',DEBUG=false,LOCALE='en-US';
;Texts = {and:'and',from:'From {0}',databaseMissingOrBroken:'The current folder´s database file is missing or broken!',checkProcessSubdirectories:'Check if you´ve allowed jAlbum to process the subdirectories and "Make album" again!',uploadAlbumAgain:'If you´re the owner try to "Upload" the album again!',localAccessBlocked:'Local access to the album´s database file is blocked by your browser. This does not affect the uploaded album! Use jAlbum´s Preview (F12) for testing!',cantLoadDataForFolder:'Can´t load data for folder "{0}"!',closeWindow:'Close window',okButton:'OK',warning:'Warning',error:'Error',restrictedLinkTitle:'Restricted material',restrictedLinkQuestion:'Please verify your age to proceed!',restrictedLinkYes:'I´m over 18',restrictedLinkNo:'I´m below 18',today:'today',yesterday:'yesterday',daysAgo:'{0} days ago',monthsAgo:'{0} months ago',yearsAgo:'{0} years ago',view:'View',addCart:'Add to Cart',shoppingCart:'Shopping cart',edit:'Edit',continueShopping:'Continue shopping',added:'Added...',buyNow:'Buy Now',processedByPaypal:'Payment processed by PayPal',selectItems:'Select items to add!',addSelectedItems:'Add selected items!',addThisItem:'Add this item!',emptyCart:'Empty Cart',removeAllItems:'Remove all items?',noMoreItems:'You can´t buy more than 99 items at once at PayPal. Added only the first 99.',item:'item',items:'items',success:'Success',couponCode:'Coupon code',redeem:'Redeem',noSuch:'No such coupon exists!',expired:'The coupon code <b>{0}</b> has expired!',lowerThanCurrent:'This coupon offers a lower discount than the current <b>{0}</b>.',reclaimed:'This coupon has already been used!',selectedItems:'Selected items',shoppingcartInfo:'This item has been added to the "Shopping cart". You can buy it by clicking the "Buy now" button after you quit the lightbox.',subtotal:'Subtotal',total:'Total',shippingAndHandling:'Shipping and handling',reduction:'Reduction',discount:'Discount',tax:'Tax',remove:'Remove',couponAccepted:'Coupon code accepted, discounting <b>{0}</b>.',couponRemoved:'The coupon has been removed.',amountLowerThan:'The amount is lower than the discount <b>{0}</b>.',addMoreItems:'Add {0} more item(s) to use this coupon!',validAbove:'Valid only above {0} cart value.',higherThanTotal:'The coupon provides a higher discount (<b>{0}</b>) than the cart total.',minAmountWarning:'This coupon can only be used if the total amount exceeds <b>{0}</b>.',minQuantityWarning:'This coupon can only be used if the number of items exceeds <b>{0}</b>.',maxNItems:'Maximum <b>{0}</b> items allowed!',cartIsEmpty:'The cart is empty',minimumCartValue:'The minimal cart value is <b>{0}</b>',proceedToPayPal:'Proceed to PayPal!',yes:'Yes',no:'No',select:'Select',all:'All',none:'None',continueBrowsing:'Continue browsing',removeAll:'Remove all',removeAllItems:'Remove all items?',to:'To',subject:'Subject',warning:'Warning',copiedToClipboard:'Copied to clipboard!',errorSending:'Error sending',emailMissing:'Email missing',tooLong:'This is too long to pass to the email application directly.',copyInstructions:'The text has been copied to your clipboard. Now switch to the email application (or webmail) and paste it. Move "To" and "Subject" into the appropriate boxes!',feedbackButtonExplanation:'Try "Send" if you have an email application installed, use "Copy" for webmail!',message:'Message',share:'Share',shareOn:'Share on',checkThisOut:'This album is worth checking out',email:'Email',copy:'Copy',copied:'Copied',slideshow:'Slideshow',localWarning:'Can´t share local albums. Please upload your album first!',foundNTimes:'{0} image(s)',notFound:'not found',search:'Search',searchPlaceholder:'Search...',newImages:'New images',results:'Results',reset:'Reset',label:'Label',return:'return',select:'Select',sortBy:'Sort by',sortedBy:'Sorted by',ascending:'ascending',descending:'descending',multipleSelectHint:'Use SHIFT to select range, CTRL for multiple entries',noRating:'No rating',newItem:'NEW',today:'today',inThePast24Hours:'in the past 24 hours',inThePast48Hours:'in the past 48 hours',inTheLastDay:'in the last day',inThePastNDays:'in the past {0} days',inThePastNMonths:'in the past {0} months',inThePastNYears:'in the past {0} years',sinceMyLastVisit:'since my last visit',betweenDays:'between {0} and {1}',onDay:'on {0}',beforeDay:'before {0}',afterDay:'after {0}',imagesAdded:'Images added',imagesModified:'Images modified',imagesTaken:'Images taken',startSlideshow:'Start slideshow',startSlideshowShort:'Play',atFirstPage:'At first page',atLastPage:'At last page',atLastPageQuestion:'Where to go next?',startOver:'Start over',backToHome:'Back to home',nextIndex:'Next index page',stop:'Stop',timing:'Timing',pause:'Pause',pauseShort:'Pause',upOneLevel:'Up one level',upOneLevelShort:'Exit',backToIndex:'Back to index page',previousPicture:'Previous picture',previousPictureShort:'Prev',nextPicture:'Next picture',nextPictureShort:'Next',previousFolder:'Previous folder',nextFolder:'Next folder',nextFoldersFirstImage:'Next folder&apos;s first image',zoom:'Zoom',oneToOneSize:'1:1 size',oneToOneSizeShort:'1:1',fullscreen:'Fullscreen',exitFullscreen:'Exit fullscreen',fullscreenShort:'Fullscr',exitFullscreenShort:'Normal',fitToScreen:'Fit to screen',fitToScreenShort:'Fit',showInfo:'Show caption / info',showInfoShort:'Info',hideInfo:'Hide caption / info',hideInfoShort:'Hide info',showThumbs:'Show thumbnails',showThumbsShort:'Thumbnails',hideThumbs:'Hide thumbnails',hideThumbsShort:'Hide thumbs',clickToOpen:'Click to open this document with the associated viewer',play:'Play',audioClipLabel:'Play / pause the attached audio clip',rating:'Rating',metaBtn:'Photo data',metaLabel:'Display photographic (Exif/Iptc) data',mapBtn:'Map',mapLabel:'Show the photo location on the map',shopBtn:'Buy',shopLabel:'Add this item to the shopping cart',viewCart:'View cart',viewCartLabel:'View shopping cart',feedbackLabel:'View feedback window',shareBtn:'Share',shareLabel:'Share this photo over social sites',download:'Download',print:'Print',printLabel:'Print out this photo on your printer',fotomotoBtn:'Buy / Share',fotomotoTooltip:'Buy prints or digital files, share, send free eCards',mostphotosBtn:'Purchase',mostphotosLabel:'Download this image from <b>mostphotos.com</b>!',regionsBtn:'People',regionsLabel:'Show tagged people',scrollTopTooltip:'Top',new:'New',more:'more',less:'less',locationWarning:'Works only when uploaded',cookiePolicyText:'This album is using cookies to remember your preferences. It does not track you, nor does it store personal data.',cookiePolicyAgree:'Got it',cookiePolicyLearnMore:'Learn more',gdprComplianceText:'This site is using the following external services that might track your visits anonymously. Disabling tracking will stop their functionality.',allowAll:'Allow all',denyAll:'Deny all',allowSelected:'Allow selected',image:'image',images:'images',audio:'audio',audios:'audios',video:'video',videos:'videos',other:'other',others:'others'};
/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-backgroundsize-bgsizecover-cssanimations-cssgradients-csstransforms-csstransforms3d-csstransitions-cssvhunit-fullscreen-history-preserve3d-requestanimationframe-svg-touchevents-setclasses !*/
!function(e,t,n){function r(e,t){return typeof e===t}function s(){var e,t,n,s,o,i,a;for(var l in x)if(x.hasOwnProperty(l)){if(e=[],t=x[l],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(s=r(t.fn,"function")?t.fn():t.fn,o=0;o<e.length;o++)i=e[o],a=i.split("."),1===a.length?Modernizr[a[0]]=s:(!Modernizr[a[0]]||Modernizr[a[0]]instanceof Boolean||(Modernizr[a[0]]=new Boolean(Modernizr[a[0]])),Modernizr[a[0]][a[1]]=s),C.push((s?"":"no-")+a.join("-"))}}function o(e){var t=b.className,n=Modernizr._config.classPrefix||"";if(z&&(t=t.baseVal),Modernizr._config.enableJSClass){var r=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(r,"$1"+n+"js$2")}Modernizr._config.enableClasses&&(t+=" "+n+e.join(" "+n),z?b.className.baseVal=t:b.className=t)}function i(){return"function"!=typeof t.createElement?t.createElement(arguments[0]):z?t.createElementNS.call(t,"http://www.w3.org/2000/svg",arguments[0]):t.createElement.apply(t,arguments)}function a(t,n,r){var s;if("getComputedStyle"in e){s=getComputedStyle.call(e,t,n);var o=e.console;if(null!==s)r&&(s=s.getPropertyValue(r));else if(o){var i=o.error?"error":"log";o[i].call(o,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}}else s=!n&&t.currentStyle&&t.currentStyle[r];return s}function l(e,t){return e-1===t||e===t||e+1===t}function u(e){return e.replace(/([a-z])-([a-z])/g,function(e,t,n){return t+n.toUpperCase()}).replace(/^-/,"")}function f(){var e=t.body;return e||(e=i(z?"svg":"body"),e.fake=!0),e}function d(e,n,r,s){var o,a,l,u,d="modernizr",c=i("div"),p=f();if(parseInt(r,10))for(;r--;)l=i("div"),l.id=s?s[r]:d+(r+1),c.appendChild(l);return o=i("style"),o.type="text/css",o.id="s"+d,(p.fake?p:c).appendChild(o),p.appendChild(c),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),c.id=d,p.fake&&(p.style.background="",p.style.overflow="hidden",u=b.style.overflow,b.style.overflow="hidden",b.appendChild(p)),a=n(c,e),p.fake?(p.parentNode.removeChild(p),b.style.overflow=u,b.offsetHeight):c.parentNode.removeChild(c),!!a}function c(e,t){return!!~(""+e).indexOf(t)}function p(e,t){return function(){return e.apply(t,arguments)}}function m(e,t,n){var s;for(var o in e)if(e[o]in t)return n===!1?e[o]:(s=t[e[o]],r(s,"function")?p(s,n||t):s);return!1}function g(e){return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-")}function h(t,r){var s=t.length;if("CSS"in e&&"supports"in e.CSS){for(;s--;)if(e.CSS.supports(g(t[s]),r))return!0;return!1}if("CSSSupportsRule"in e){for(var o=[];s--;)o.push("("+g(t[s])+":"+r+")");return o=o.join(" or "),d("@supports ("+o+") { #modernizr { position: absolute; } }",function(e){return"absolute"==a(e,null,"position")})}return n}function v(e,t,s,o){function a(){f&&(delete R.style,delete R.modElem)}if(o=r(o,"undefined")?!1:o,!r(s,"undefined")){var l=h(e,s);if(!r(l,"undefined"))return l}for(var f,d,p,m,g,v=["modernizr","tspan","samp"];!R.style&&v.length;)f=!0,R.modElem=i(v.shift()),R.style=R.modElem.style;for(p=e.length,d=0;p>d;d++)if(m=e[d],g=R.style[m],c(m,"-")&&(m=u(m)),R.style[m]!==n){if(o||r(s,"undefined"))return a(),"pfx"==t?m:!0;try{R.style[m]=s}catch(y){}if(R.style[m]!=g)return a(),"pfx"==t?m:!0}return a(),!1}function y(e,t,n,s,o){var i=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+O.join(i+" ")+i).split(" ");return r(t,"string")||r(t,"undefined")?v(a,t,s,o):(a=(e+" "+N.join(i+" ")+i).split(" "),m(a,t,n))}function S(e,t,r){return y(e,n,n,t,r)}var C=[],x=[],w={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){x.push({name:e,fn:t,options:n})},addAsyncTest:function(e){x.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=w,Modernizr=new Modernizr,Modernizr.addTest("history",function(){var t=navigator.userAgent;return-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone")||"file:"===location.protocol?e.history&&"pushState"in e.history:!1}),Modernizr.addTest("svg",!!t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect);var b=t.documentElement,T="CSS"in e&&"supports"in e.CSS,_="supportsCSS"in e;Modernizr.addTest("supports",T||_);var z="svg"===b.nodeName.toLowerCase(),k=w._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];w._prefixes=k,Modernizr.addTest("cssgradients",function(){for(var e,t="background-image:",n="gradient(linear,left top,right bottom,from(#9f9),to(white));",r="",s=0,o=k.length-1;o>s;s++)e=0===s?"to ":"",r+=t+k[s]+"linear-gradient("+e+"left top, #9f9, white);";Modernizr._config.usePrefixes&&(r+=t+"-webkit-"+n);var a=i("a"),l=a.style;return l.cssText=r,(""+l.backgroundImage).indexOf("gradient")>-1}),Modernizr.addTest("preserve3d",function(){var t,n,r=e.CSS,s=!1;return r&&r.supports&&r.supports("(transform-style: preserve-3d)")?!0:(t=i("a"),n=i("a"),t.style.cssText="display: block; transform-style: preserve-3d; transform-origin: right; transform: rotateY(40deg);",n.style.cssText="display: block; width: 9px; height: 1px; background: #000; transform-origin: right; transform: rotateY(40deg);",t.appendChild(n),b.appendChild(t),s=n.getBoundingClientRect(),b.removeChild(t),s=s.width&&s.width<4)});var P=w.testStyles=d;P("#modernizr { height: 50vh; }",function(t){var n=parseInt(e.innerHeight/2,10),r=parseInt(a(t,null,"height"),10);Modernizr.addTest("cssvhunit",l(r,n))});var E="Moz O ms Webkit",O=w._config.usePrefixes?E.split(" "):[];w._cssomPrefixes=O;var A=function(t){var r,s=k.length,o=e.CSSRule;if("undefined"==typeof o)return n;if(!t)return!1;if(t=t.replace(/^@/,""),r=t.replace(/-/g,"_").toUpperCase()+"_RULE",r in o)return"@"+t;for(var i=0;s>i;i++){var a=k[i],l=a.toUpperCase()+"_"+r;if(l in o)return"@-"+a.toLowerCase()+"-"+t}return!1};w.atRule=A;var N=w._config.usePrefixes?E.toLowerCase().split(" "):[];w._domPrefixes=N;var j={elem:i("modernizr")};Modernizr._q.push(function(){delete j.elem});var R={style:j.elem.style};Modernizr._q.unshift(function(){delete R.style}),w.testAllProps=y;var q=w.prefixed=function(e,t,n){return 0===e.indexOf("@")?A(e):(-1!=e.indexOf("-")&&(e=u(e)),t?y(e,t,n):y(e,"pfx"))};Modernizr.addTest("fullscreen",!(!q("exitFullscreen",t,!1)&&!q("cancelFullScreen",t,!1))),Modernizr.addTest("requestanimationframe",!!q("requestAnimationFrame",e),{aliases:["raf"]}),w.testAllProps=S,Modernizr.addTest("cssanimations",S("animationName","a",!0)),Modernizr.addTest("backgroundsize",S("backgroundSize","100%",!0)),Modernizr.addTest("bgsizecover",S("backgroundSize","cover")),Modernizr.addTest("csstransforms",function(){return-1===navigator.userAgent.indexOf("Android 2.")&&S("transform","scale(1)",!0)}),Modernizr.addTest("csstransforms3d",function(){return!!S("perspective","1px",!0)}),Modernizr.addTest("csstransitions",S("transition","all",!0)),Modernizr.addTest("touchevents",function(){var n;if("ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch)n=!0;else{var r=["@media (",k.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");P(r,function(e){n=9===e.offsetTop})}return n}),s(),o(C),delete w.addTest,delete w.addAsyncTest;for(var L=0;L<Modernizr._q.length;L++)Modernizr._q[L]();e.Modernizr=Modernizr}(window,document);
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("whatInput",[],t):"object"==typeof exports?exports.whatInput=t():e.whatInput=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t){"use strict";e.exports=function(){if("undefined"==typeof document||"undefined"==typeof window)return{ask:function(){return"initial"},element:function(){return null},ignoreKeys:function(){},specificKeys:function(){},registerOnChange:function(){},unRegisterOnChange:function(){}};var e=document.documentElement,t=null,n="initial",o=n,i=Date.now();try{window.sessionStorage.getItem("what-input")&&(n=window.sessionStorage.getItem("what-input")),window.sessionStorage.getItem("what-intent")&&(o=window.sessionStorage.getItem("what-intent"))}catch(e){}var r=["button","input","select","textarea"],s=[],a=[16,17,18,91,93],u=[],d={keydown:"keyboard",keyup:"keyboard",mousedown:"mouse",mousemove:"mouse",MSPointerDown:"pointer",MSPointerMove:"pointer",pointerdown:"pointer",pointermove:"pointer",touchstart:"touch",touchend:"touch"},c=!1,w={x:null,y:null},p={2:"touch",3:"touch",4:"mouse"},f=!1;try{var l=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("test",null,l)}catch(e){}var h=function(){var e=!!f&&{passive:!0};window.PointerEvent?(window.addEventListener("pointerdown",m),window.addEventListener("pointermove",y)):window.MSPointerEvent?(window.addEventListener("MSPointerDown",m),window.addEventListener("MSPointerMove",y)):(window.addEventListener("mousedown",m),window.addEventListener("mousemove",y),"ontouchstart"in window&&(window.addEventListener("touchstart",m,e),window.addEventListener("touchend",m))),window.addEventListener(b(),y,e),window.addEventListener("keydown",m),window.addEventListener("keyup",m),window.addEventListener("focusin",g),window.addEventListener("focusout",E)},m=function(e){var t=e.which,i=d[e.type];"pointer"===i&&(i=L(e));var s=!u.length&&-1===a.indexOf(t),c=u.length&&-1!==u.indexOf(t),w="keyboard"===i&&t&&(s||c)||"mouse"===i||"touch"===i;if(x(i)&&(w=!1),w&&n!==i){n=i;try{window.sessionStorage.setItem("what-input",n)}catch(e){}v("input")}if(w&&o!==i){var p=document.activeElement;if(p&&p.nodeName&&-1===r.indexOf(p.nodeName.toLowerCase())||"button"===p.nodeName.toLowerCase()&&!k(p,"form")){o=i;try{window.sessionStorage.setItem("what-intent",o)}catch(e){}v("intent")}}},v=function(t){e.setAttribute("data-what"+t,"input"===t?n:o),S(t)},y=function(e){var t=d[e.type];if("pointer"===t&&(t=L(e)),M(e),!c&&!x(t)&&o!==t){o=t;try{window.sessionStorage.setItem("what-intent",o)}catch(e){}v("intent")}},g=function(n){n.target.nodeName?(t=n.target.nodeName.toLowerCase(),e.setAttribute("data-whatelement",t),n.target.classList&&n.target.classList.length&&e.setAttribute("data-whatclasses",n.target.classList.toString().replace(" ",","))):E()},E=function(){t=null,e.removeAttribute("data-whatelement"),e.removeAttribute("data-whatclasses")},L=function(e){return"number"==typeof e.pointerType?p[e.pointerType]:"pen"===e.pointerType?"touch":e.pointerType},x=function(e){var t=Date.now(),o="mouse"===e&&"touch"===n&&t-i<200;return i=t,o},b=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},S=function(e){for(var t=0,i=s.length;t<i;t++)s[t].type===e&&s[t].fn.call(void 0,"input"===e?n:o)},M=function(e){w.x!==e.screenX||w.y!==e.screenY?(c=!1,w.x=e.screenX,w.y=e.screenY):c=!0},k=function(e,t){var n=window.Element.prototype;if(n.matches||(n.matches=n.msMatchesSelector||n.webkitMatchesSelector),n.closest)return e.closest(t);do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null};return"addEventListener"in window&&Array.prototype.indexOf&&(d[b()]="mouse",h(),v("input"),v("intent")),{ask:function(e){return"intent"===e?o:n},element:function(){return t},ignoreKeys:function(e){a=e},specificKeys:function(e){u=e},registerOnChange:function(e,t){s.push({fn:e,type:t||"input"})},unRegisterOnChange:function(e){var t=function(e){for(var t=0,n=s.length;t<n;t++)if(s[t].fn===e)return t}(e);(t||0===t)&&s.splice(t,1)}}}()}])});
window.console=window.console||{log:function(e){}};var log=function(){},UNDEF="undefined",OBJECT="object",FUNCTION="function",STRING="string",NUMBER="number",BOOLEAN="boolean",NOLINK="javascript:void(0)",LOCAL="file:"===document.location.protocol,ONEDAY_S=86400,ONEDAY_MS=864e5,STARS='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="80" height="16" viewBox="0 0 80 16" xml:space="preserve"><path d="M12,10.094l0.938,5.5L8,13l-4.938,2.594L4,10.094L0,6.219l5.531-0.813l2.469-5l2.469,5L16,6.219L12,10.094z"/><path d="M28,10.094l0.938,5.5L24,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L32,6.219L28,10.094z"/><path d="M44,10.094l0.938,5.5L40,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L48,6.219L44,10.094z"/><path d="M60,10.094l0.938,5.5L56,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L64,6.219L60,10.094z"/><path d="M76,10.094l0.938,5.5L72,13l-4.938,2.594l0.938-5.5l-4-3.875l5.531-0.813l2.469-5l2.469,5L80,6.219L76,10.094z"/></svg>';if(DIR_PATH=function(){let e=window.location.pathname,t=document.getElementsByTagName("html")[0].getAttribute("data-level")||0;do{e=e.substring(0,e.lastIndexOf("/"))}while(t--);return e+"/"}(),LOCALSTORAGE=function(){try{return localStorage.setItem("_t",UNDEF),localStorage.removeItem("_t"),!0}catch(e){return!1}}(),HISTORY=function(){let e=navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}(),VEND=function(){let e=navigator.userAgent;return e.indexOf("Trident")>0||e.indexOf("Edge")>0?"ms":e.indexOf("AppleWebKit")>0?"webkit":e.indexOf("Gecko")>0?"moz":e.indexOf("Presto")>0?"o":e.indexOf("Blink")>0?"webkit":""}(),JAVAFXBROWSER=navigator.userAgent.indexOf("JavaFX/14")>0,BACKFACEBUG=navigator.userAgent.indexOf("Edge")>0&&parseInt(navigator.userAgent.match(/Edge\/(\d+\.\d+)/)[1])<=16,TOUCH=/Trident|Edge/.test(navigator.userAgent)?window.navigator.pointerEnabled?{START:"pointerdown",MOVE:"pointermove",END:"pointerup",CANCEL:"pointercancel"}:{START:"MSPointerDown",MOVE:"MSPointerMove",END:"MSPointerUp",CANCEL:"MSPointerCancel"}:{START:"touchstart",MOVE:"touchmove",END:"touchend",CANCEL:"touchcancel"},TOUCHENABLED=/Trident/.test(navigator.userAgent)?typeof navigator.maxTouchPoints!==UNDEF&&navigator.maxTouchPoints:/Edge/.test(navigator.userAgent)?0==scrollbarWidth():/(Chrome|CriOS)/.test(navigator.userAgent)?/Mobile/.test(navigator.userAgent)||"ontouchstart"in window:"ontouchstart"in window,ISIOSDEVICE=/^iP/.test(navigator.platform)||/^Mac/.test(navigator.platform)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>4,SMALLSCREEN=window.innerWidth<=480||window.innerHeight<=480||window.innerWidth<=640&&window.innerHeight<=640,PIXELRATIO=window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1,ZOOM=window.hasOwnProperty("visualViewport")?window.visualViewport.scale:1,HIDPI=PIXELRATIO>1.9,HASPDFVIEWER=navigator.mimeTypes["application/pdf"]||function(){var e=function(e){try{return new ActiveXObject(e)}catch(e){}};return e("AcroPDF.PDF")||e("PDF.PdfCtrl")}()||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,LANGUAGE=navigator.hasOwnProperty("languages")?navigator.languages[0]:navigator.language,WEBP_LOSSY=!1,WEBP_LOSSLESS=!1,checkWebpSupport=function(e,t){let n=new Image;n.onload=function(){t(n.width>0&&n.height>0)},n.onerror=function(){t(!1)},n.src="data:image/webp;base64,"+e},checkWebpSupport("UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",function(e){WEBP_LOSSY=e}),checkWebpSupport("UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",function(e){WEBP_LOSSLESS=e}),typeof DEBUG===UNDEF)var DEBUG=!1;if(typeof REL_PATH===UNDEF)var REL_PATH="";if(typeof PAGE_NAME===UNDEF)var PAGE_NAME="index.html";if(typeof THUMBS_DIR===UNDEF)var THUMBS_DIR="thumbs";if(typeof SLIDES_DIR===UNDEF)var SLIDES_DIR="slides";String.prototype.hasOwnProperty("trim")||(String.wsp=[],String.wsp[9]=!0,String.wsp[10]=!0,String.wsp[11]=!0,String.wsp[12]=!0,String.wsp[13]=!0,String.wsp[32]=!0,String.wsp[133]=!0,String.wsp[160]=!0,String.wsp[5760]=!0,String.wsp[6158]=!0,String.wsp[8192]=!0,String.wsp[8193]=!0,String.wsp[8194]=!0,String.wsp[8195]=!0,String.wsp[8196]=!0,String.wsp[8197]=!0,String.wsp[8198]=!0,String.wsp[8199]=!0,String.wsp[8200]=!0,String.wsp[8201]=!0,String.wsp[8202]=!0,String.wsp[8203]=!0,String.wsp[8232]=!0,String.wsp[8233]=!0,String.wsp[8239]=!0,String.wsp[8287]=!0,String.wsp[12288]=!0,String.prototype.trim=function(){var e=this+"",t=e.length;if(t){var n=String.wsp,r=0;for(--t;t>=0&&n[e.charCodeAt(t)];)--t;for(++t;r<t&&n[e.charCodeAt(r)];)++r;e=e.substring(r,t)}return e}),String.prototype.hasOwnProperty("trunc")||(String.prototype.trunc=function(e){var t=this+"";if(t.length<=e)return t.toString();var n=t.substring(0,e-1),r=n.lastIndexOf(" ");return(r>6&&n.length-r<20?n.substring(0,r):n)+"..."}),String.prototype.hasOwnProperty("startsWith")||(String.prototype.startsWith=function(e){return(this+"").substring(0,e.length)===e}),String.prototype.hasOwnProperty("endsWith")||(String.prototype.endsWith=function(e){return(this+"").substring(this.length-e.length)===e}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.unCamelCase=function(){return this.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},String.prototype.getExt=function(){var e=this+"",t=e.lastIndexOf(".");return t<=0||t>=e.length-1?"":e.substring(t+1)},String.prototype.stripExt=function(){var e=this+"",t=e.lastIndexOf(".");return t<=0||t>e.length-1?e:e.substring(0,t)},String.prototype.hasExt=function(e){var t=this+"",n=t.lastIndexOf(".");return n>=0&&(t=t.substring(n+1).toLowerCase(),(e+",").indexOf(t+",")>=0)},String.prototype.replaceExt=function(e){var t=this+"",n=t.lastIndexOf(".");return n<=0?t:t.substring(0,n+1)+e},String.prototype.fixExtension=function(){return(this+"").replace(/.gif$/gi,".png").replace(/.tif+$/gi,".jpg")},String.prototype.getDir=function(){var e=(this+"").split("#")[0];return e.substring(0,e.lastIndexOf("/")+1)},String.prototype.getFile=function(){var e=(this+"").split("#")[0];return e.substring(e.lastIndexOf("/")+1)},String.prototype.getRelpath=function(e){var t=this+"",n=t.lastIndexOf("#");for(-1===n?n=t.length-1:n--;n>=0&&("/"!==t[n]||0!=e--);n--);return t.substring(n+1)},String.prototype.fixUrl=function(){for(var e,t,n=this+"";(e=n.indexOf("../"))>0;){if(1===e||-1===(t=n.lastIndexOf("/",e-2)))return n.substring(e+3);n=n.substring(0,t)+n.substring(e+2)}return n},String.prototype.fullUrl=function(){var e=this+"";return e.match(/^(http|ftp|file)/)||(e=window.location.href.getDir()+e),e.fixUrl()},String.prototype.cleanupHTML=function(){for(var e=[[/<(b|h)r\/?>/gi,"\n"],[/\&amp;/g,"&"],[/\&nbsp;/g," "],[/\&lt;/g,"<"],[/\&gt;/g,">"],[/\&(m|n)dash;/g,"-"],[/\&apos;/g,"'"],[/\&quot;/g,'"']],t=this+"",n=e.length-1;n>=0;n--)t=t.replace(e[n][0],e[n][1]);return t.replace},String.prototype.stripHTML=function(e){var t=this+"";return e&&(t=t.cleanupHTML()),t.replace(/<\/?[^>]+>/g," ")},String.prototype.stripQuote=function(){return(this+"").replace(/\"/gi,"&quot;")},String.prototype.appendSep=function(e,t){return(this.length?this+(t||" &middot; "):"")+e},String.prototype.rgb2hex=function(){var e=this+"";if("#"===e.charAt(0)||"transparent"===e)return e;var t,n=e.match(/\d+/g),r="";if(n){for(var o=0;o<n.length&&o<3;++o)r+=((t=parseInt(n[o],10).toString(16)).length<2?"0":"")+t;return"#"+r}return"transparent"},String.prototype.template=function(e){if(typeof e===UNDEF||!this)return this;!isNaN(parseFloat(e))&&isFinite(e)&&(e+="");var t=this+"";if(e.constructor===Array)for(var n=0;n<e.length;++n)t=t.replace(new RegExp("\\{"+n+"\\}","gi"),e[n]);else t=t.replace(/\{0\}/gi,e);return t},String.prototype.getSearchTerms=function(){var e=this+"";if(-1===e.indexOf('"'))return e.split(" ");var t,n=[];do{if((t=e.indexOf('"'))>0&&n.push.apply(n,e.substring(0,t).split(" ")),e=e.substring(t+1),(t=e.indexOf('"'))<0){n.push(e);break}n.push(e.substring(0,t)),e=e.substring(t+1)}while(e.length);return n},String.prototype.objectify=function(){if(!this||!this.length)return this;var e=this+"";"?"!==e.charAt(0)&&"#"!==e.charAt(0)||(e=e.substring(1));for(var t,n={},r=e.split("&"),o=0,i=r.length;o<i;++o)(t=r[o].split("=")).length>1?"img"===t[0]?n.img=t[1]:n[t[0]]=decodeURIComponent(t[1]):n[t[0]]=null;return n},String.prototype.testIn=function(e){return"string"!=typeof e&&(e+=""),new RegExp(this,"i").test(e)},String.prototype.testExactMatch=function(e){if(e.constructor!==Array)return this==e+"";for(var t=0,n=e.length;t<n;++t)if(this==e[t])return!0;return!1},String.prototype.fixjAlbumPaths=function(e,t,n){var r=(this+"").replace(/\%24/g,"$");return e&&(r=r.replace(/\${resPath}/g,e)),t&&(r=r.replace(/\${rootPath}/g,t)),n&&(r=r.replace(/\${relPath}/g,n)),r},String.prototype.testMatch=function(e){if(typeof e===UNDEF)return!1;var t=this.toLowerCase();if(e.constructor!==Array)return t===(e+"").toLowerCase();for(var n=0,r=e.length;n<r;++n)if(t===e[n].toLowerCase())return!0;return!1},String.prototype.searchTerm=function(e,t,n,r){if(typeof e===UNDEF||!this.length)return!1;var o=typeof r!==UNDEF&&r,i=this+"",t=typeof t!==UNDEF&&t,n=typeof n!==UNDEF&&n,a=function(e,n){return t?o?e===n:e===n.toLowerCase():-1!==(" "+e).indexOf(" "+(o?n:n.toLowerCase()))};if(e.constructor===Array&&1===e.length&&(e=e[0]),o||(i=i.toLowerCase()),Array.isArray(e)){var s,l=e.length,c=0;for(s=0;s<l;s++)if(a(i,e[s])){if(!n)return!0;c++}else if(n)return!1;return c===l}return a(i,e)},String.prototype.hashCode=function(){for(var e=0,t=0,n=this.length;t<n;++t)e=(e<<5)-e+this.charCodeAt(t),e&=e;return e},Math.minMax=function(e,t,n){return(t=isNaN(t)?parseFloat(t):t)<e?e:t>n?n:t},Math.getRange=function(e,t){if(t.constructor!==Array)return e>=t?1:0;if(1===t.length)return e>=t[0]?1:0;if(e<t[0])return 0;for(var n=1;n<t.length&&!(e>=t[n-1]&&e<t[n]);n++);return n};var encodeJ=[];encodeJ[33]="%21",encodeJ[35]="%23",encodeJ[36]="%24",encodeJ[38]="%26",encodeJ[39]="%27",encodeJ[40]="%28",encodeJ[41]="%29",encodeJ[43]="%2B",encodeJ[44]="%2C",encodeJ[59]="%3B",encodeJ[60]="%3C",encodeJ[61]="%3D",encodeJ[62]="%3E",encodeJ[63]="%3F",encodeJ[64]="%40",encodeJ[123]="%7B",encodeJ[124]="%7C",encodeJ[125]="%7D",transCodeJ=[],transCodeJ[33]="%21",transCodeJ[39]="%27",transCodeJ[40]="%28",transCodeJ[41]="%29";var isEmpty=function(e){return null==e||0===Object.getOwnPropertyNames(e).length},paramize=function(e){if("number"==typeof e)return""+e;if("string"==typeof e)return e;if("object"==typeof e){for(var t="",n=Object.getOwnPropertyNames(e),r=n.length,o=0;o<r;o++)null!==e[n[o]]&&("img"===n[o]?t+="&img="+e[n[o]]:t+="&"+n[o]+"="+encodeURIComponent(e[n[o]]));if(t.length)return t.substring(1)}return""},allTrue=function(e){if(e&&e.constructor===Array){for(var t=0;t<e.length;++t)if(!e[t])return!1;return!0}return!0===e},removeEmpty=function(e){if(e&&e.constructor===Array){var t,n=new Array;for(t=0;t<e.length;t++)typeof e[t]===STRING&&e[t].length&&n.push(e[t]);return n}return e},getCoords=function(e){return e.touches?1==e.touches.length?{x:e.touches[0].clientX,y:e.touches[0].clientY}:e.changedTouches&&1==e.changedTouches.length?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:null:{x:e.clientX,y:e.clientY}},translate=function(e,t){if(e=e.trim(),typeof Texts!==UNDEF&&Texts.hasOwnProperty(e))return Texts[e];if(typeof t!==UNDEF)return DEBUG&&console&&console.log("Using default translation: "+e+"="+t),t;DEBUG&&console&&console.log("Missing translation: "+e);var n=e.replace(/([A-Z])/g," $1").toLowerCase();return n[0]=n.charAt(0).toUpperCase(),n},getKeys=function(e,t){var n,r={},o=e.split(","),i=o.length;for(n=0;n<i;n++)r[o[n]]=translate(o[n],t[o]);return r},getTranslations=function(e){var t,n={};for(t in e)"object"==typeof e[t]?n[t]=getTranslations(e[t]):n[t]=translate(t,e[t]);return n},readData=function(e,t){var n={};if(e&&e.length&&t){t=t.split(",");for(var r,o=0;o<t.length;o++)null!=(r=e.data(t[o]))&&(n[t[o]]=r)}return n},niceByte=function(e){var t=parseFloat(e),n=Math.abs(t),r=function(e){return e<10?e.toFixed(1):Math.round(e)};return n<1e-4?"0":n<.1?t.toFixed(3):n<1?t.toFixed(2):n<1e3?r(t):n<1e6?r(t/1e3)+"k":n<1e9?r(t/1e6)+"M":n<1e12?r(t/1e9)+"G":t.toExponential()},niceTime=function(e){var t=parseFloat(e),n=Math.abs(t),r=function(e){return e<10?e.toFixed(1):Math.round(e)};return n<1e-6?"0s":n<.001?r(1e6*t)+"&#181;s":n<1?r(1e3*t)+"ms":n<60?r(t)+"s":Math.floor(n/60)+"m"+Math.round(n%60)+"s"},toCurrency=function(e,t){return parseFloat(e).toLocaleString(LANGUAGE,{style:"currency",currency:t||"EUR"})},getRelativeDate=function(e){if(!e)return translate("today");if(1===e)return translate("yesterday");var t,n;return e>=730?(t=translate("yearsAgo"),n=Math.round(e/365)):e>=60?(t=translate("monthsAgo"),n=Math.round(e/30.5)):(t=translate("daysAgo"),n=e),t.replace("{0}",n)},getTimespan=function(e){if(!e)return translate("inThePast24Hours");if(e<2)return translate("inThePast48Hours");var t,n;return e>=730?(t=translate("inThePastNYears"),n=Math.round(e/365)):e>=60?(t=translate("inThePastNMonths"),n=Math.round(e/30.42)):(t=translate("inThePastNDays"),n=e),t.replace("{0}",n)},getFractionValue=function(e){var t=e.match(/^([\d\.]+)\/([\d\.]+)/);return t&&t.length>1&&0!==t[2]?t[1]/t[2]:e},getExposure=function(e){return e=e.includes("/")?getFractionValue(e):parseFloat(e)},getRelativePath=function(e,t){if(typeof t===UNDEF||typeof e===UNDEF)return"";if("./"===e&&(e=REL_PATH),"./"===t&&(t=REL_PATH),t.endsWith("/")||(t+="/"),e.endsWith("/")||(e+="/"),e===t)return"";if("/"===e)return t;var n=e.split("/").filter(Boolean);if("/"===t)return getParentFolderLink(n.length);for(var r=t.split("/").filter(Boolean);n.length&&r.length&&n[0]===r[0];)n.shift(),r.shift();return getParentFolderLink(n.length)+(r.length?r.join("/")+"/":"")},getParentFolderLink=function(e){return e>0?"../../../../../../../../../../../../../../../../../../../../".substring(0,3*e):""},encodeAsJava=function(e){var t="";for(e=/^(https?:|file:)?\/\//i.test(e)?encodeURI(e):encodeURIComponent(e),i=0;i<e.length;i++)t+=encodeJ[e.charCodeAt(i)]||e.charAt(i);return t},transcodeJavaURIComponent=function(e){var t="";for(i=0;i<e.length;i++)t+=transCodeJ[e.charCodeAt(i)]||e.charAt(i);return t},extend=function(){if(arguments.length<2)return arguments[0]||{};for(var e=arguments[0],t=1;t<arguments.length;t++)for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e},passDefaults=function(e,t,n){if(e&&t)if(typeof n!==UNDEF){n=n.split(",");for(var r=0;r<n.length;r++)e.hasOwnProperty(n[r])&&(t[n[r]]=e[n[r]])}else for(var o in e)t[o]=e[o]},readUserPrefs=function(e,t){if(typeof t!==UNDEF&&e){t=t.split(",");for(var n,r=0;r<t.length;r++)null!==(n=$.cookie(t[r]))&&(e[t[r]]=n)}},savePrefs=function(e,t,n){var r,o,i={};for(r in t)o=t[r],e.hasOwnProperty(o)&&(i[o]=e[o]);i&&$.cookie(typeof n===UNDEF?"lb_pref":n,i)},loadPrefs=function(e,t,n){var r,o,i=$.cookie(typeof n===UNDEF?"lb_pref":n);if(i)for(r in t)o=t[r],i.hasOwnProperty(o)&&(e[o]="true"===i[o]||"false"===i[o]?!!i[o]:i[o])},addParam=function(e,t,n){if(HISTORY){var r=window.location.hash;r&&(history.state?(history.state.hasOwnProperty("img")&&(history.state.img=encodeURIComponent(history.state.img)),t=extend(history.state,t)):("#"===r.charAt(0)&&(r=r.substring(1)),t=extend(r.objectify(),t))),(r="#"+paramize(t))!==window.location.hash&&history.pushState(t,typeof n===UNDEF?"":n,r.length>1?r:e||"index.html")}},setParam=function(e,t,n){if(HISTORY){var r="#"+paramize(t);r!==window.location.hash&&history.pushState(t,typeof n===UNDEF?"":n,r.length>1?r:e||"index.html")}},removeParam=function(e,t,n){if(HISTORY){var r,o=window.location.hash;o&&(typeof t===UNDEF?(o="",history.pushState("","",e||"index.html")):("#"===o.charAt(0)&&(o=o.substring(1)),(r=o.objectify()).hasOwnProperty(t)&&(delete r[t],o="#"+paramize(r)),history.pushState(r,typeof n===UNDEF?"":n,o.length>1?o:e||"index.html")))}},removeSearch=function(e){HISTORY&&history.replaceState(history.state,typeof e===UNDEF?"":e,window.location.href.replace(window.location.search,""))},restoreScrollPosition=function(){if(LOCALSTORAGE){var e=$.cookie("last-touch"),t=(new Date).valueOf(),n=$.cookie(REL_PATH+PAGE_NAME+":scroll-pos"),r=function(e,t){$("html").height()>=e?$("html").scrollTop(e):t&&setTimeout(r,1e3,e,t-1)};e&&t-e<2e3&&n&&r(n,6)}},saveScrollPosition=function(){if(LOCALSTORAGE){var e=$("html").scrollTop();$.cookie(REL_PATH+PAGE_NAME+":scroll-pos",e||null,300),$.cookie("last-touch",(new Date).valueOf(),300)}},readParam=function(){if(HISTORY){if(history.state)return history.state.hasOwnProperty("img")&&(history.state.img=encodeURIComponent(history.state.img)),history.state;var e=window.location.hash;return"#"===e.charAt(0)&&(e=e.substring(1)),e.objectify()}return null},pushAll=function(e,t){if(e instanceof Array)if(t instanceof Array)for(var n=0,r=t.length;n<r;n++)e.push(t[n]);else e.push(t)},pushNew=function(e,t){if(e instanceof Array)if(t instanceof Array)for(var n=0,r=t.length;n<r;n++)e.includes(t[n])||e.push(t[n]);else e.includes(t)||e.push(t)},videoDurationMs=function(e){var t=e.match(/(\d{2})\:(\d{2})\:(\d{2})(\.(\d+))?/);return t?(t[5]?parseInt(t[5]):0)+1e3*parseInt(t[3])+6e4*parseInt(t[2])+36e5*parseInt(t[1]):null},guessDimensions=function(e){var t,n,r;return e?(t=e.match(/<\w+\s[^>]*\swidth="([\d\.]+)"/i)||e.match(/<\w+\s[^>]*\sstyle=".*width:\s?([\d\.]+)(r?em|px)"/i),n=e.match(/<\w+\s[^>]*\sheight="([\d\.]+)"/i)||e.match(/<\w+\s[^>]*\sstyle=".*height:\s?([\d\.]+)(r?em|px)"/i),t?(r[0]=parseFloat(t[1]),t.length>2&&"px"!==t[2]&&(r[0]*=16),n?(r[1]=parseFloat(n[1]),n.length>2&&"px"!==n[2]&&(r[1]*=16)):r[1]=.75*r[0],r):null):null},currencyToHtml={USD:"US$",EUR:"&euro;",GBP:"GB&pound;",JPY:"&yen;",HUF:"Ft",CAD:"CAN$",AUD:"AU$",RUB:"&#8381;"},codeToCurrency=function(e){return currencyToHtml.hasOwnProperty(e)?currencyToHtml[e]:e},currencyToHtmlShort={USD:"$",EUR:"&euro;",GBP:"&pound;",JPY:"&yen;",HUF:"Ft",CAD:"$",AUD:"$",RUB:"&#8381;"},codeToShortCurrency=function(e){return currencyToHtmlShort.hasOwnProperty(e)?currencyToHtmlShort[e]:e},printImage=function(e,t,n){if(e){var r=window.open("about:blank","print","location=no,status=no,titlebar=no");r.document.open(),r.document.write('<!DOCTYPE html>\n<html>\n<head>\n<meta charset="utf-8">\n<title>'+(t||"Print")+'</title>\n<script>printOut=function(){window.print();window.close();}<\/script>\n<style>body{margin:0;padding:0;text-align:center;overflow:hidden;}\nimg{display:block;width:100%;height:auto;vertical-align:top;}</style>\n</head>\n<body onLoad="setTimeout(printOut,100)"><img src="'+e+'">'+(n||"")+"</body>\n</html>"),r.document.close()}},getFileSize=function(e,t,n){var r=new XMLHttpRequest;r.open("HEAD",e,!0),r.onreadystatechange=function(){this.readyState==this.DONE&&200===this.status&&typeof t===FUNCTION&&(typeof n!==UNDEF?t.call(this,[this.getResponseHeader("content-length")],n):t.call(this,[this.getResponseHeader("content-length")]))},r.send()},moveInView=function(e){var t=$(e);if(t.length&&t.is(":visible")){var n=t.offset().top,r=navigator.userAgent.match(/(iPod|iPhone|iPad)/)?$("body"):$("html"),o=r.scrollTop();(n<o||n>o+window.outerHeight-80)&&(navigator.userAgent.match(/(iPod|iPhone|iPad)/)?window.scrollTo(0,n):r.animate({scrollTop:n},500,function(){r.clearQueue()}))}},xDecrypt=function(e){if("string"!=typeof e)return"";var t,n,r,o=[147,163,87,254,153,4,198,23],i=e.length,a=5*Math.ceil(i/8),s=new Array(a),l="",c=0;for(t=0;t<a;t++)s[t]=0;for(t=0;t<i;t++)(r=e.charCodeAt(t)-48)>9&&(r-=7),r<<=11-c%8,(n=c>>3)<a&&(s[n]|=r>>8,++n<a&&(s[n]|=255&r)),c+=5;for(t=0;t<a;t++)s[t]^=o[t%8];for(a=s[0]|s[1]<<8,r=0,t=4;t<a;t++)l+=String.fromCharCode(s[t]),r+=s[t];return r!=(255&s[2]|s[3]<<8)&&(l=""),l},getStyle=function(t,n){if(t instanceof Element){if(document.defaultView&&document.defaultView.getComputedStyle)return document.defaultView.getComputedStyle(t,"").getPropertyValue(n.unCamelCase());if(t.currentStyle)return e.currentStyle[n]}return null},scrollbarWidth=function(){var e=document.createElement("div"),t=0;return e.style.cssText="width:100px;height:100px;overflow:scroll !important;position:absolute;top:-9999px",document.body&&(document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e)),t},addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},pageZoomed=function(){return!!window.hasOwnProperty("visualViewport")&&window.visualViewport.scale>ZOOM},playVideo=function(e,t){if(e&&"VIDEO"===e.nodeName)if(e.paused){let n=e.play();typeof n!==UNDEF&&n.then(()=>{addClass(e,"playing"),typeof t===FUNCTION&&t.call(null)}).catch(n=>{"NotAllowedError"===n.name?(e.muted=!0,e.play().then(()=>{console.log("Falling back to muted autoplay! Unmute the video manually!"),addClass(e,"playing"),typeof t===FUNCTION&&t.call(null)}).catch(e=>{console.log("Autoplay rejected. Try starting the video manually!")})):console.log("Video format not supported!")})}else typeof t===FUNCTION&&t.call(null)},fullscreenChanged=0,fullscreenChangedSince=function(){return new Date-fullscreenChanged},hasFullscreen=function(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled},isFullscreen=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},requestFullscreen=function(e,t){if(hasFullscreen())if(isFullscreen())typeof e===FUNCTION&&e.call();else{let n=document.documentElement;n.requestFullscreen?n.requestFullscreen().then(e||(()=>{})).catch(e=>{typeof t===FUNCTION?t.call():console.log("Full-screen error: "+e.message+" ("+e.name+")")}):n.mozRequestFullscreen?(n.mozRequestFullscreen(),e.call()):n.webkitRequestFullscreen?(n.webkitRequestFullscreen(),e.call()):n.msRequestFullscreen&&(n.msRequestFullscreen(),e.call()),fullscreenChanged=new Date}},exitFullscreen=function(e,t){if(hasFullscreen())if(isFullscreen()){if(typeof e!==FUNCTION);if(typeof t!==FUNCTION);document.exitFullscreen?document.exitFullscreen().then(e).catch(t):document.mozExitFullscreen?document.mozExitFullscreen().then(e).catch(t):document.webkitExitFullscreen?(document.webkitExitFullscreen(),e.call()):document.msExitFullscreen&&document.msExitFullscreen().then(e).catch(t),fullscreenChanged=new Date}else typeof e===FUNCTION&&e.call()},orientationChanged=function(e,t){"change"===e.type?e.target.type.startsWith("landscape")&&!isFullscreen()&&requestFullscreen(t):"orientationchange"===e.type&&e.target.innerWidth>e.target.innerHeight&&!isFullscreen()&&requestFullscreen(t)},goFullscreenOnLandscapeChange=function(e){(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled)&&(typeof screen!==UNDEF&&screen.hasOwnProperty("orientation")?screen.orientation.addEventListener("change",orientationChanged,e):window.addEventListener("orientationchange",orientationChanged,e))},wakeLock=null,requestWakeLock=async(e,t)=>{if("wakeLock"in navigator&&"request"in navigator.wakeLock){wakeLock=null;try{wakeLock=await navigator.wakeLock.request("screen"),typeof e===FUNCTION&&e.call()}catch(e){typeof t===FUNCTION&&t.call(err)}}},releaseWakeLock=(e,t)=>{wakeLock&&wakeLock.release().then(()=>{wakeLock=null,typeof e===FUNCTION&&e.call()})},loadExternal=function(e,t){return $.getJSON(e+"data1.json").done(function(e){typeof t===FUNCTION&&t.call(e)}).fail(function(t,n,r){DEBUG&&console.log('Not an album, or cannot load album database for: "'+e+'".')})},loadGoogleAnalytics=function(e,t,n){if(!LOCAL){var r=xDecrypt(e);if("classic"===t){var o=o||[];o.push(["_setAccount",r]),o.push(["_trackPageview"]),function(e){var t=e.createElement("script");t.async=!0,t.src=("https:"===e.location.protocol?"https://ssl":"http://www")+(n?".stats.g.doubleclick.net/dc.js":".google-analytics.com/ga.js");var r=e.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r)}(document)}else"universal"===t?(!function(e,t,n,r,o,i,a){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",a.parentNode.insertBefore(i,a)}(window,document,"script",0,"ga"),ga("create",r,"auto"),n&&ga("require","displayfeatures"),ga("send","pageview")):gtag("config",r,{send_page_view:!0})}},loadGoogleAPI=function(e,t){if(!LOCAL){!function(e,t,n,r,o,i,a){(i=t.createElement(n)).appendChild(t.createTextNode("{parsetags:'explicit',lang:'${lang}'}")),a=t.getElementsByTagName(n)[0],i.async=1,i.src=r,a.parentNode.insertBefore(i,a)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//apis.google.com/js/platform.js");var n=30,r=function(){typeof gapi===UNDEF?n--?setTimeout(r,200):"console"in window&&console.log("Google Plus API failed to load!"):setTimeout(function(){gapi[t].go()},200)};e&&r()}},loadFacebookAPI=function(e,t){LOCAL||(window.fbAsyncInit=function(){typeof jQuery!==UNDEF&&jQuery(".social-links").trigger("updateLinks")},function(n,r,o){var i,a=n.getElementsByTagName(r)[0];n.getElementById(o)||((i=n.createElement(r)).id=o,i.src="https://connect.facebook.net/"+(t||"en_US")+"/sdk.js#xfbml=1&version=v3.0&appId="+xDecrypt(e),a.parentNode.insertBefore(i,a))}(document,"script","facebook-jssdk"))},loadDisqusAPI=function(e){LOCAL||function(t,n){(n=t.createElement(n)).async=1,n.src="https://"+xDecrypt(e)+".disqus.com/embed.js",n.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(n)}(document,"script")},loadPinterestAPI=function(){LOCAL||function(e,t){(t=e.createElement(t)).async=1,t.src="https://assets.pinterest.com/js/pinit.js",(e.head||e.body).appendChild(t)}(document,"script")},loadAPIs=function(e,t){if(e&&!isEmpty(e))for(var n in e)if(typeof t===UNDEF||t[n])switch(n){case"googleAnalytics":loadGoogleAnalytics(e[n][0],e[n][1],e[n][2]);break;case"googlePlus":loadGoogleAPI(e[n][0],e[n][1]);break;case"facebook":loadFacebookAPI(e[n][0]);break;case"disqus":loadDisqusAPI(e[n][0]);break;case"pinterest":loadPinterestAPI()}},askTrackingConsent=function(e,t){if((t&&!isEmpty(t)||e.cookiePolicy)&&!LOCAL){e=$.extend({},{stay:15},e),t=t||{};var n=getTranslations({cookiePolicyText:"This album is using cookies to remember your preferences. It does not track you, neither it stores personal data.",cookiePolicyLearnMore:"Learn more",cookiePolicyAgree:"Got it",gdprComplianceText:"This site is using the following external services that might track your visits anonymously. Disabling tracking will stop their functionality.",allowAll:"Allow all",denyAll:"Deny all",allowSelected:"Allow selected"}),r=$.cookie("trackingConsent"),o=!1,i=!1,a="icon-checkmark",s=function(e){var t=$(e.target),n=t.hasClass(a);t.toggleClass(a,!n),l()},l=function(){var e=$("#trackingConsent span."+a).length>0;$("#allow,#deny").toggle(!e),$("#allowsel").toggle(e)},c=function(e){var n,r=$("#trackingConsent span");return n=$.extend({},$.cookie("trackingConsent"),{cookie:1}),"allow"===this.id?r.each(function(){$(this).addClass(a),n[$(this).attr("id")]=1}):"deny"===this.id?r.each(function(){$(this).removeClass(a),n[$(this).attr("id")]=0}):"allowsel"===this.id&&r.each(function(e){n[$(this).attr("id")]=$(this).hasClass(a)}),$.cookie("trackingConsent",n,31622400),u(),loadAPIs(t,n),!1},u=function(){$("#cookiepolicy").fadeOut(500,function(){$(this).remove()})};if(r?(o=!function(){for(var e in t)if(!r.hasOwnProperty(e))return!1;return!0}(),i=e.cookiePolicy&&!r.hasOwnProperty("cookie")):(o=!isEmpty(t),i=e.hasOwnProperty("cookiePolicy")),o||i){var d,p=$("<div>",{id:"cookiepolicy"}).appendTo($("body"));if(p.append($("<a>",{class:"close",html:"&times;"}).on("click",u)),i&&(d=$("<p>",{id:"cookiePolicy",html:n.cookiePolicyText}).appendTo(p),o||d.append($("<a>",{id:"agree",class:"btn icon-ok",text:" "+n.cookiePolicyAgree}).on("click",c))),o){d=$("<p>",{id:"trackingConsent",html:n.gdprComplianceText}).appendTo(p);for(var f in t)d.append($("<span>",{id:f,class:"checkbox"+(r&&r[f]?" "+a:""),html:"&nbsp;"+f.capitalize()}).on("click",s));d.append($("<a>",{id:"allow",class:"btn icon-ok",text:" "+n.allowAll}).on("click",c)),d.append($("<a>",{id:"deny",class:"btn icon-close",text:" "+n.denyAll}).on("click",c)),d.append($("<a>",{id:"allowsel",class:"btn icon-ok",text:" "+n.allowSelected}).on("click",c)),l()}e.cookiePolicyUrl&&d.append(" ").append($("<a>",{text:n.cookiePolicyLearnMore,target:"_blank",href:e.cookiePolicyUrl})),p.fadeIn(500),setTimeout(function(){$("#cookiepolicy").fadeOut(500,function(){$(this).remove()})},1e3*e.stay)}else loadAPIs(t,r)}};addClass(document.getElementsByTagName("html")[0],(TOUCHENABLED?"":"no-")+"touch"),addClass(document.getElementsByTagName("html")[0],(HIDPI?"":"no-")+"hidpi"),function(e,t){"use strict";var n,r,o=!1,i=1;log=function(t){var a=function(e){if(Array.isArray(e)){for(var t="",n=0;n<e.length;n++)t+=a(e[n])+", ";return"[ "+t.substring(0,t.length-2)+" ]"}if("object"==typeof e){t="";for(var n in e)t+=n+": "+a(e[n])+",<br>";return"{ "+t+" }"}return isNaN(e)?e:parseInt(e)===e?e:e.toFixed(4)};DEBUG&&!o&&(n||(n=e('<div id="log" style="position:fixed;left:0;top:0;width:200px;bottom:0;overflow:auto;padding:10px;background-color:rgba(0,0,0,0.5);color:#fff;font-size:0.75em;z-index:999999"></div>').hover(function(){o=!0},function(){o=!1}).appendTo("body")),t===r?n.children().first().empty().html(r+" <sup>("+ ++i+")</sup>"):(e('<div style="height:3em;overflow:auto;">'+a(t)+"</div>").prependTo(n),r=t,i=1))},e.fn.logEvents=function(t){if(DEBUG){var n=t||"mousedown mouseup mouseover mouseout mousewheel wheel dragstart click blur focus load unload reset submit change abort cut copy paste selection drag drop orientationchange touchstart touchmove touchend touchcancel pointerdown pointermove pointerup MSPointerDown MSPointerMove MSPointerUp gesturestart gesturechange gestureend";return this.each(function(){e(this).on(n,function(e){return typeof e===UNDEF?log("Undefined event"):e.target?"log"!==e.target.id&&log(e.type+' <span style="padding:0 4px;font-size:0.75em;background-color:#000;border-radius:4px;"><b>'+(e.target.nodeName?e.target.nodeName.toLowerCase():"???")+"</b>"+(e.target.id?":"+e.target.id:"")+"</span>"+(e.relatedTarget?' <span style="padding:0 4px;font-size:0.6em;background-color:#800;border-radius:4px;"><b>'+e.relatedTarget.nodeName.toLowerCase()+"</b>"+(e.relatedTarget.id?":"+e.relatedTarget.id:"")+"</span>":"")):log("No event target!"),!0})})}},e.fn.logCss=function(t,n,r){if(DEBUG){r=r||20,n=n||2e3;var o=new Date;return this.each(function(){var i=e(this),a=function(e){var t=new Date-o;log(t+"&nbsp;::&nbsp;"+e+" = "+i.css(e)),t>n&&clearInterval(s)},s=setInterval(function(){if(Array.isArray(t))for(var e=0;e<t.length;e++)a(t[e]);else a(t)},r)})}},e.fn.setFocus=function(e){this.length&&(typeof e!==UNDEF?this[0].focus(e):this[0].focus())},void 0===e.fn.deserialize&&(e.fn.deserialize=function(t){if(!t)return this;var n=e(this),r=t.replace(/\+/g,"%20").split("&");return e.each(r,function(e,t){var r=t.split("="),o=decodeURIComponent(r[0]),i=null!==r[1]?decodeURIComponent(r[1]):"",a=n.find("[name="+o+"]");if(!a.length)return!0;if("radio"===a[0].type||"checkbox"===a[0].type){var s=a.filter('[value="'+i+'"]'),l=s.length;l||"on"!==i?s.prop("checked",l):a.eq(0).prop("checked",!0)}else a.val(i)}),this}),void 0===e.when.all&&(e.when.all=function(t){var n=new e.Deferred;return e.when.apply(e,t).then(function(){n.resolve(Array.prototype.slice.call(arguments))},function(){n.fail(Array.prototype.slice.call(arguments))}),n}),e.fn.getRotate=function(){if(this&&this.length){var e,t=window.getComputedStyle(this[0],null),n=t.getPropertyValue("transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-webkit-transform");if(n&&(e=n.match(/matrix3d\(([^\)]+)\)/))&&e&&e.length>2)return e=e.split(/\s*,/),Math.round(Math.atan2(parseFloat(e[1]),parseFloat(e[0]))*(180/Math.PI))}return 0},e.fn.getMatrix=function(){if(this&&this.length){var e,t=window.getComputedStyle(this[0],null),n=t.getPropertyValue("transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-webkit-transform"),r=[];if(n&&(e=n.match(/matrix(3d)?\(([^\)]+)\)/))&&e&&e.length>2)return(e=e[2].split(/,\s*/)).forEach(function(e){r.push(parseFloat(e))}),r}return[1,0,0,1,0,0]},e.fn.getTranslate=function(){if(this&&this.length){var e=this.getMatrix();return[e[4],e[5]]}return[0,0]},e.fn.backwards=[].reverse,e.fn.waitAllImg=function(t,n,r){if(this&&this.length){var o=e(this),i=[];return function(t){return t.filter("img[src]").not('[src=""]').each(function(){i.push(function(t){var n=new e.Deferred,r=new Image;return r.onload=function(){n.resolve(t)},r.onerror=function(){n.reject(new Error("Image not found: "+t.src))},r.src=t.src,n}(this))}),t.filter("video[src]").not('[src=""]').each(function(){i.push(function(t){var n=new e.Deferred,r=document.createElement("VIDEO");return r.addEventListener("loadedmetadata",function(){n.resolve(t)}),r.addEventListener("error",function(){n.reject(new Error("Video not found: "+t.src))}),r.src=t.src,n}(this))}),e.when.all(i)}(o).then(function(e){typeof n===FUNCTION&&n!==t&&n.call(e)},function(e){typeof r===FUNCTION&&r.call(e)}).then(function(){typeof t===FUNCTION&&t.call(o)}),this}t.call(o)},e.fn.askPermission=function(t){var n=getTranslations({restrictedLinkTitle:"Restricted material",restrictedLinkQuestion:"Please verify your age to proceed!",restrictedLinkYes:"I´m over 18",restrictedLinkNo:"I´m below 18"});return e(this).filter("[href]").each(function(){e(this).data("href",e(this).attr("href")),e(this).attr("href",null),e(this).on("click._lap_",function(t){var r=e.extend({},n,function(e){var t={},n=e.data("ask-permission");return n&&null!==(n=n.split("::"))[0]&&(t.restrictedLinkTitle=n[0],null!==n[1]&&(t.restrictedLinkQuestion=n[1],null!==n[2]&&(t.restrictedLinkYes=n[2],null!==n[3]&&(t.restrictedLinkNo=n[3])))),t}(e(this)));return t.preventDefault(),r.link=e(this).data("href"),e("body").modal(e('<div class="text-center">'+r.restrictedLinkQuestion+"</div>"),[{t:r.restrictedLinkYes,c:"icon-checkmark",h:function(){window.location.href=r.link}},{t:r.restrictedLinkNo,c:"icon-close alert",h:function(){return!0}}],{icon:"warning",class:"small warning",title:r.restrictedLinkTitle}),!1})})}}(jQuery);
const J={ALBUM:"album",FOLDERS:"folders",NAME:"name",PATH:"path",THUMB:"thumb",IMAGE:"image",WIDTH:"width",HEIGHT:"height",RENDITIONS:"renditions",ORIGINAL:"original",OBJECTS:"objects",FILEDATE:"fileDate",COMMENT:"comment",TITLE:"title",KEYWORDS:"keywords",COUNTERS:"counters",DEEPCOUNTERS:"deepCounters",FILESIZE:"fileSize",CATEGORY:"category",RATING:"rating",CAMERA:"camera",VIDEO:"video",DURATION:"duration",FPS:"fps",HIDDEN:"hidden",LEVEL:"level",PATHREF:"pathRef",PARENTREF:"parentRef",RELPATH:"relPath",FOLDERCAPTION:"folderCaption",IMAGECAPTION:"imageCaption",THUMBCAPTION:"thumbCaption",PHOTODATA:"photodata",LOCATION:"location",REGIONS:"regions",SHOP:"shop",EXTERNAL:"external",PROJECTIONTYPE:"projectionType",GPANO:"gpano",ORIGINALFILE:"originalFile",DATES:"dates",ADDED:"added",DATETAKEN:"dateTaken",FILEMODIFIED:"fileModified",DATERANGE:"dateRange",MOSTPHOTOS:"mostphotos",HIDEFOTOMOTO:"hideFotomoto",FOTOMOTOCOLLECTION:"fotomotoCollection",AUDIOCLIP:"audioClip",PANORAMA:"panorama",FILTERS:"filters",SORT:"sort",VISITORRATING:"visitorRating",OBJ:"obj",LOADCOUNTER:"loadcounter",TOTAL:"total",FOLDERINDEX:"folderindex",READY:"ready",ONREADY:"onReady",DEEP:"deep",SIZE:"size",CONT:"cont",TYPE:"type"},JCAMERAFIELDS=["aperture","exposureTime","originalDate","cameraModel","location","focusDistance","focalLength35mm","cameraMake","resolution","isoEquivalent","flash","focalLength"];var Album=function(e,t){let r,n,o,a=null,l={treeFile:"tree.json",dataFile:"data1.json",deepDataFile:"deep-data.json",indexName:"index.html",folderImageFile:"folderimage.jpg",folderImageDims:[1200,800],folderThumbFile:"folderthumb.jpg",folderThumbDims:[1024,768],thumbDims:[240,180],thumbsDir:"thumbs",slidesDir:"slides",hiresDir:"hi-res",hiDpiThumbs:!1,hiDpiImages:!1,thumbsFillFrame:!0,audioPoster:"audio.poster.png",defaultAudioPosterSize:[628,360],videoPoster:"video.poster.png",defaultVideoPosterSize:[628,360],rootPath:"",relPath:"",loadDeep:!1,lazy:!0,fatalError:(e,t)=>D("Error: "+(typeof t===UNDEF?translate(e):translate(e).replace(/\{0\}/g,t))),possibleTypes:["folder","webPage","webLocation","image","video","audio","other"],locale:"en-US"},E=getTranslations({and:"and",from:"From {0}"}),i=null,s="",O=[],h=[],f=[],p=!1,T=!1,u=[],A=()=>n&&n.hasOwnProperty(J.DEEP)&&n[J.DEEP],D=e=>{console&&typeof e!==UNDEF&&(e.match(/^Error\:/i)&&console.error("jalbum-album.js "+e),typeof DEBUG!==UNDEF&&DEBUG&&(e.match(/^Warning\:/i)?console.warn("jalbum-album.js "+e):e.match(/^Info\:/i)?console.info("jalbum-album.js "+e):console.log("jalbum-album.js "+e)))},y=e=>decodeURIComponent(e.slice(e.lastIndexOf("/")+1)),I=e=>{var t=M(e).match(/\.(\w+)$/);return t?t[1]:""},c=e=>e.hasOwnProperty(J.CATEGORY)&&-1!=="image.video.audio.other".indexOf(e[J.CATEGORY]),P=function(){if(arguments.length){let e=[];for(let t,r=0;r<arguments.length;r++)(t=arguments[r]).length&&("/"===t?e=[]:("/"===t[0]&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t.length&&e.push(t)));return e.join("/")}return""},N=e=>e&&e.hasOwnProperty(J.PATHREF)&&e[J.PATHREF]?O[e[J.PATHREF]-1]:"",R=e=>e&&e.hasOwnProperty(J.RELPATH)&&e[J.RELPATH]?h[e[J.RELPATH]-1]:"",g=e=>typeof e!==UNDEF?null!==i?P(i,N(e)):R(e):i||"",F=e=>typeof e!==UNDEF?N(e):"",L=e=>{if(typeof e!==UNDEF){let t=g(e),r=e[J.CATEGORY]||"folder";return"folder"===r?t:"video"===r?P(t,e[J.VIDEO][J.PATH]):"audio"===r||"other"===r||e.hasOwnProperty(J.ORIGINAL)?P(t,e[J.ORIGINAL][J.PATH]):"image"===r?P(t,e[J.IMAGE][J.PATH]):"webPage"===r?P(t,e[J.PATH]):e[J.PATH]}return null},m=e=>typeof e!==UNDEF?N(e)+("folder"!==e[J.CATEGORY]?e[J.PATH]:""):null,C=e=>{if(typeof e!==UNDEF){if("video"===e[J.CATEGORY])return[e[J.VIDEO][J.WIDTH],e[J.VIDEO][J.HEIGHT]];if(e.hasOwnProperty(J.ORIGINAL))return[e[J.ORIGINAL][J.WIDTH],e[J.ORIGINAL][J.HEIGHT]]}return null},S=e=>typeof e!==NUMBER||e<=0?n:--e>O.length?(D("Error: out of bounds path reference ("+e+")!"),null):H(O[e]),H=e=>{if(typeof e===UNDEF)return null;if(!e.length)return n;e.endsWith("/")&&(e=e.slice(0,-1)),e.startsWith("/")&&(e=e.slice(1));let t,r=n,o=e.split("/");for(t=0;t<o.length;t++){if(A()){if(r.hasOwnProperty(J.OBJECTS)&&(r=r[J.OBJECTS].find(e=>"folder"===e[J.CATEGORY]&&e[J.PATH]===o[t])))continue}else if(r.hasOwnProperty(J.FOLDERS)&&(r=r[J.FOLDERS].find(e=>e[J.PATH]===o[t])))continue;return null}return t===o.length?r:null},G=e=>{if(typeof e===UNDEF&&(e=o),e===n)return null;let t=S(e.hasOwnProperty(J.PARENTREF)?e[J.PARENTREF]:e[J.PATHREF]);return t===e?null:t},U=function(e,t,r){if(typeof t!==FUNCTION)return;let o=function(e,t){let n=t[0],o=t[1];if(e.hasOwnProperty(J.OBJECTS)){let t;n.endsWith(".webloc")?(n=n.slice(0,-7),t=e[J.OBJECTS].find(function(e){return"webLocation"===e[J.CATEGORY]&&e[J.IMAGE][J.PATH].slice(7).stripExt()===n})):t=e[J.OBJECTS].find(function(e){return e.hasOwnProperty(J.ORIGINAL)&&e[J.ORIGINAL][J.PATH]===n||e[J.PATH]===n}),typeof t===UNDEF&&(t=null),typeof r!==UNDEF?o.call(t,r):o.call(t)}};if(e)if(e.endsWith("/"))typeof r!==UNDEF?t.call(H(e),r):t.call(H(e));else{let r=e.lastIndexOf("/"),a=-1===r?n:H(e.substring(0,r)),l=e.substring(r+1);a&&(T||a.hasOwnProperty(J.READY)&&a.ready?o(a,[l,t]):A()?oe(a,o,[l,t]):q(a,o,[l,t]))}else typeof r!==UNDEF?t.call(n,r):t.call(n);return null},M=e=>"video"===e[J.CATEGORY]?y(e[J.VIDEO][J.PATH]):e.hasOwnProperty(J.ORIGINAL)?y(e[J.ORIGINAL][J.PATH]):e[J.NAME],B=e=>(e=e||o).hasOwnProperty(J.LEVEL)?e[J.LEVEL]:B(G(e)),b=e=>(e||o)[J.TITLE]||"",x=e=>((e||o)[J.NAME]||"").replace(/\.\w+$/,"").replace(/_/g," "),Y=(e,t,r)=>{if(WEBP_LOSSY||(e=e.filter(e=>!e.name.endsWith(".webp"))),e.length>1){let n=t[0]*PIXELRATIO,o=t[1]*PIXELRATIO;e.forEach(e=>{let t=r?Math.max(n/e.width,o/e.height):Math.min(n/e.width,o/e.height);e.match=t>1?3*(1-1/t):1-t}),e.sort((e,t)=>e.match-t.match)}return e[0]},v=(e,t,r,n)=>n?t[0]*r>=e[0]&&t[1]*r>=e[1]:t[0]*r>=e[0]||t[1]*r>=e[1],W=e=>{let t=0,r=typeof e===UNDEF?o:e;return r.hasOwnProperty(J.DEEPCOUNTERS)&&r[J.DEEPCOUNTERS].hasOwnProperty(J.FOLDERS)?r[J.DEEPCOUNTERS][J.FOLDERS]+1:(A()?r.hasOwnProperty(J.OBJECTS)&&r[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||(t+=W(e))}):r.hasOwnProperty(J.FOLDERS)&&r[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||(t+=W(e))}),r.hasOwnProperty(J.DEEPCOUNTERS)||(r[J.DEEPCOUNTERS]={}),r[J.DEEPCOUNTERS][J.FOLDERS]=t,t+1)},V=e=>n.hasOwnProperty(e)?n[e]:null,j=(t,r)=>{let n={};do{t.hasOwnProperty(r)&&(n=e.extend(!0,{},t[r],n))}while(t=G(t));return Object.getOwnPropertyNames(n).length?n:null},k=(t,r)=>{if(r.indexOf(".")>=0){if("album"===(r=r.split("."))[0])return V(r[1]);do{if(t.hasOwnProperty(r[0]))return e.extend(!0,{},t[r[0]][r[1]])}while(t=G(t));return null}do{if(t.hasOwnProperty(r))return e.extend(!0,{},t[r])}while(t=G(t));return null},X=(e,t)=>{let r=t[J.PATH],n=-1;return A()?e.hasOwnProperty(J.OBJECTS)&&(n=e[J.OBJECTS].findIndex(e=>"folder"===e[J.CATEGORY]&&e[J.PATH]===r)):e.hasOwnProperty(J.FOLDERS)&&(n=e[J.FOLDERS].findIndex(e=>e[J.PATH]===r)),n},_=function(t,r,n){if(!Array.isArray(t))return null;Array.isArray(r)||(n=r||{},r=null);let o=e.extend({sortBy:"original",reference:J.DATETAKEN,reverse:!1,foldersFirst:!0},n);switch(o.sortBy){case"random":t.sort(()=>.5-Math.random()),r&&r.sort(()=>.5-Math.random());break;case"date":let e=o.reference;o.reverse?(t.sort((t,r)=>(t.hasOwnProperty(J.DATES)?t[J.DATES][e]:t[J.FILEDATE])-r.hasOwnProperty(J.DATES)?r[J.DATES][e]:r[J.FILEDATE]),r&&r.sort((e,t)=>e[J.FILEDATE]-t[J.FILEDATE])):(t.sort((t,r)=>(r.hasOwnProperty(J.DATES)?r[J.DATES][e]:r[J.FILEDATE])-t.hasOwnProperty(J.DATES)?t[J.DATES][e]:t[J.FILEDATE]),r&&r.sort((e,t)=>t[J.FILEDATE]-e[J.FILEDATE]));break;case J.NAME:o.reverse?(t.sort((e,t)=>(""+e[J.NAME]).localeCompare(""+t[J.NAME])),r&&r.sort((e,t)=>(""+e[J.NAME]).localeCompare(""+t[J.NAME]))):(t.sort((e,t)=>(""+t[J.NAME]).localeCompare(""+e[J.NAME])),r&&r.sort((e,t)=>(""+t[J.NAME]).localeCompare(""+e[J.NAME])));break;case J.FILESIZE:o.reverse?t.sort((e,t)=>e[J.FILESIZE]-t[J.FILESIZE]):t.sort((e,t)=>t[J.FILESIZE]-e[J.FILESIZE]);break;default:o.reverse&&(t.reverse(),r&&r.reverse())}return r?o.foldersFirst?r.concat(t):t.concat(r):t},z=function(e,t){if(typeof e!==UNDEF&&typeof t===STRING){if("label"===t)return x(e);if("fileLabel"===t)return e.hasOwnProperty(J.TITLE)?e[J.TITLE]:x(e);if("originalTime"===t&&e.hasOwnProperty(J.DATES)&&e[J.DATES].hasOwnProperty(J.DATETAKEN))return new Date(1e3*e[J.DATES][J.DATETAKEN]).toLocaleString(l.locale,{month:"2-digit",day:"2-digit",hour12:!1,hour:"2-digit",minute:"2-digit"});if(e.hasOwnProperty(t))return e[t]}return""},Z="../../../../../../../../../../../../../../../../../../../../",K=function(){let e=function(t,r,n,o){let a=r?P(n,t[J.PATH]):"",E=r?(e=>{if(typeof e===UNDEF||!e)return 0;"/"!==e.slice(-1)&&(e+="/");let t=O.indexOf(e);return t>=0?t+1:O.push(e)})(a):0,s=null===i?(e=>{if(typeof e===UNDEF||!e)return 0;"/"!==e.slice(-1)&&(e+="/");let t=h.indexOf(e);return t>=0?t+1:h.push(e)})(function(e,t){if(typeof e===UNDEF||!e.length||"/"===e)return t||"";if(typeof t===UNDEF||!t.length||"/"===t)return Z.slice(0,3*e.split("/").length);if(e===t)return"";for(e=e.split("/"),t=t.split("/");e.length&&t.length&&e[0]===t[0];)e.shift(),t.shift();return Z.slice(0,3*e.length)+t.join("/")}(l.relPath,a)):-1;if(t[J.LEVEL]=r,t[J.PATHREF]=E,null===i&&(t[J.RELPATH]=s),t.hasOwnProperty(J.CATEGORY)||(t[J.CATEGORY]="folder"),r&&(t[J.PARENTREF]=o),t[J.THUMB][J.PATH].startsWith(t[J.PATH]+"/"+l.thumbsDir)&&(t[J.THUMB][J.PATH]=t[J.THUMB][J.PATH].slice(t[J.PATH].length+1)),l.loadDeep){t[J.OBJECTS].filter(e=>"folder"!==e[J.CATEGORY]).forEach(e=>{e[J.PATHREF]=E,null===i&&(e[J.RELPATH]=s)});t[J.OBJECTS].filter(e=>"folder"===e[J.CATEGORY]).forEach((n,o)=>{t[J.FOLDERS]=[],t[J.FOLDERS].push(o++),e(n,r+1,a,E)})}else t.hasOwnProperty(J.FOLDERS)&&t[J.FOLDERS].forEach(t=>e(t,r+1,a,E))};e(n,0,"",0)},$=function(e){e.hasOwnProperty(J.ONREADY)&&Array.isArray(e[J.ONREADY])&&(e[J.ONREADY].forEach(t=>{t.length>1?t[0](e,t[1]):t[0](e)}),e[J.ONREADY]=[])},q=function(e,t,r){e&&typeof t===FUNCTION&&(T||e.hasOwnProperty(J.READY)&&e[J.READY]?typeof r!==UNDEF?t(e,r):t(e):(e.hasOwnProperty(J.ONREADY)||Q(e),typeof r!==UNDEF?e[J.ONREADY].push([t,Array.isArray(r)?r:[r]]):e[J.ONREADY].push([t])))},Q=function(t,r){if(t.hasOwnProperty(J.ONREADY)||(t[J.ONREADY]=[]),t.hasOwnProperty(J.OBJECTS)&&t[J.OBJECTS].length)$(t);else{let o=P(g(t),l.dataFile)+s;f||(f=[]),f.push(e.getJSON(o).done(function(e){!function(e,t){let r,o=0;e[J.OBJECTS]=[],t[J.OBJECTS].forEach(t=>{if(n[J.LOADCOUNTER][t[J.CATEGORY]]++,n[J.LOADCOUNTER][J.TOTAL]++,"folder"===t[J.CATEGORY])if(o<e[J.FOLDERS].length){r=e[J.FOLDERS][o];for(let e in t)e===J.OBJECTS||e===J.ALBUM||r.hasOwnProperty(e)||(r[e]=t[e]);(t={})[J.FOLDERINDEX]=o++}else D('Database error: Folder count inconsistency in folder "'+e[J.NAME]+'". tree.json <> data1.json');else t[J.PATHREF]=e[J.PATHREF],t[J.RELPATH]=e[J.RELPATH];e[J.OBJECTS].push(t)}),e[J.READY]=!0,$(e)}(t,e)}).fail(function(e,t,r){D('Error: Objects could not be loaded for "'+o+'": '+t+", "+r)})),r&&t.hasOwnProperty(J.FOLDERS)&&t[J.FOLDERS].forEach(e=>Q(e,!0))}},ee=function(){n&&(n[J.LOADCOUNTER]={},n[J.LOADCOUNTER][J.TOTAL]=0,l.possibleTypes.forEach(e=>{n[J.LOADCOUNTER][e]=0}))},te=function(){return null!==(o=H(l.relPath))||(typeof l.fatalError===FUNCTION&&l.fatalError.call(this,"noSuchFolder",l.relPath),!1)},re=function(){f=[],Q(l.lazy?o:n,!l.lazy),e.when.apply(e,f).done(function(){let e=new Date;typeof DEBUG!==UNDEF&&DEBUG&&D(f.length+" folder(s) loaded: "+(e-a)+"ms"),p=!0,f=null,typeof l.ready===FUNCTION?(l.ready.call(this),l.ready=null):n.hasOwnProperty(J.FOLDERS)||typeof l.deepReady===FUNCTION&&(l.deepReady.call(this),l.deepReady=null)}).fail(function(e,t,r){typeof l.fatalError===FUNCTION&&l.fatalError.call(this,"cantLoadDataForFolder",o[J.PATH])})},ne=function(e){e.hasOwnProperty(J.READY)||(e[J.READY]=!1),l.loadDeep?e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{"folder"===e[J.CATEGORY]&&ne(e)}):e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>ne(e))},oe=function(e,t,r){e&&typeof t===FUNCTION&&(T?typeof r!==UNDEF?t(e,r):t(e):typeof r!==UNDEF?u.push([e,t,Array.isArray(r)?r:[r]]):u.push([e,t]))},ae=function(t,r){if(T)return void t.call(n);let o=new Date,a=P(i||l.rootPath,l.deepDataFile)+s;return e.getJSON(a).done(function(e){typeof DEBUG!==UNDEF&&DEBUG&&(D("Deep data loaded: "+(new Date-o)+"ms"),o=new Date),function(e){if(l.loadDeep=!0,typeof n===UNDEF)(n=e)[J.DEEP]=!0,ee(),K();else{let t=n,r=function(e,t){for(let r in e)r===J.FOLDERS||r===J.ALBUM||r===J.OBJECTS||r===J.READY||r===J.ONREADY||t.hasOwnProperty(r)||(t[r]=e[r]);if(e.hasOwnProperty(J.ONREADY)&&e[J.ONREADY].forEach(e=>e.length>1?e[0](t,e[1]):e[0](t)),t.hasOwnProperty(J.OBJECTS)){let n=e[J.PATHREF],o=e[J.RELPATH]||null,a=0;t[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]?(e[J.PATHREF]=n,o&&(e[J.RELPATH]=o)):(a||(t[J.FOLDERS]=[]),t[J.FOLDERS].push(a++))}),e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(n=>{const o=t[J.OBJECTS].find(e=>"folder"===e[J.CATEGORY]&&e[J.PATH]===n[J.PATH]);o?r(n,o):D('Database inconsistency when accessing folder "'+e[J.NAME]+'"!')})}};(n=e)[J.DEEP]=!0,r(t,n)}}(e),te()&&(T=!0,typeof t===FUNCTION?t.call(this):(typeof l.ready===FUNCTION&&(l.ready.call(this),l.ready=null),typeof l.deepReady===FUNCTION&&(l.deepReady.call(this),l.deepReady=null)),u.length&&(u.forEach(e=>e.length>2?e[1](e[0],e[2]):e[1](e[0])),u=[]))}).fail(function(e,t,n){typeof l.fatalError===FUNCTION&&l.fatalError.call(this,"databaseAccessDenied",a),typeof r===FUNCTION&&r.call(this)})};return t&&(typeof DEBUG!==UNDEF&&DEBUG&&D("new Album("+JSON.stringify(t)+");"),(t=>{if(a)return a;a=new Date,typeof t!==UNDEF&&e.extend(l,t),p=T=!1,l.hasOwnProperty("albumPath")&&"/"!==(i=l.albumPath).slice(-1)&&(i+="/"),r=(e=>{if(typeof e===UNDEF)return window.location.href.substring(0,window.location.href.lastIndexOf("/"));if(e.match(/^https?\:\/\//i))return e;if("/"===e[0])return window.location.origin+e;{let t=window.location.href;for(t=t.substring(0,t.lastIndexOf("/")),e.endsWith("..")&&(e+="/");e.startsWith("../");)t=t.substring(0,t.lastIndexOf("/",t.length-2)),e=e.slice(3);return t+e}})(i||l.rootPath),l.hasOwnProperty("makeDate")&&(s="?"+l.makeDate),l.loadDeep||l.hasOwnProperty("deepReady")?ae():function(t){let r=new Date,o=P(i||l.rootPath,l.treeFile)+s;l.loadDeep=!1,e.getJSON(o).done(function(e){n=e,ee(),ne(n),typeof DEBUG!==UNDEF&&DEBUG&&(D("Tree loaded: "+(new Date-r)+"ms"),r=new Date),te()&&(K(),typeof t===FUNCTION&&t.call(this))}).fail(function(e,t,r){typeof l.fatalError===FUNCTION&&l.fatalError.call(this,"databaseAccessDenied",o)})}(re)})(t)),{isImage:e=>e.hasOwnProperty(J.CATEGORY)&&"image"===e[J.CATEGORY],isAudio:e=>e.hasOwnProperty(J.CATEGORY)&&"audio"===e[J.CATEGORY],isVideo:e=>e.hasOwnProperty(J.CATEGORY)&&"video"===e[J.CATEGORY],isFolder:e=>e.hasOwnProperty(J.FOLDERINDEX)||e.hasOwnProperty(J.LEVEL),isLightboxable:c,isCurrentFolder:e=>e===o,getAlbumPath:()=>{if(null!==i)return i;let e=window.location.pathname,t=o[J.LEVEL];do{e=e.substring(0,e.lastIndexOf("/")),t-=1}while(t>=0);return e},getAlbumRootPath:()=>r,getPath:g,getAbsolutePath:e=>e.hasOwnProperty(J.LEVEL)?P(i||r,F(e)):P(i||r,F(e),l.indexName+"#img="+e[J.PATH]),getItemPath:L,getAudioClipPath:e=>typeof e!==UNDEF&&e.hasOwnProperty(J.AUDIOCLIP)?P(g(e),e[J.AUDIOCLIP][J.PATH]):null,getDimensions:e=>{if(typeof e===UNDEF||"other"===e[J.CATEGORY]&&"pdf"===I(e).toLowerCase())return null;if(e.hasOwnProperty(J.EXTERNAL)){let t=e[J.EXTERNAL][J.SIZE];return t?(t=t.split("x"),[t[0],t[1]||Math.round(.75*t[0])]):(t=guessDimensions(e[J.EXTERNAL][J.CONT]))||(e[J.EXTERNAL][J.CONT].includes("vimeo.com")||e[J.EXTERNAL][J.CONT].includes("youtube.com")||e[J.EXTERNAL][J.CONT].includes("youtu.be")?(w=1280,(t=e[J.EXTERNAL][J.CONT].match(/.*style="padding(-bottom)?:\s?([\d\.]+)%/))&&t&&t.length>1?[1280,Math.round(w*parseFloat(t[2])/100)]:[1280,720]):[e[J.IMAGE][J.WIDTH],e[J.IMAGE][J.HEIGHT]])}return"audio"===e[J.CATEGORY]&&e[J.IMAGE][J.PATH].endsWith("res/audio.png")?[l.defaultAudioPosterSize[0],l.defaultAudioPosterSize[1]]:"video"===e[J.CATEGORY]?[e[J.VIDEO][J.WIDTH],e[J.VIDEO][J.HEIGHT]]:l.linkOriginals&&l.hiDpiImages?[e[J.IMAGE][J.WIDTH]/2,e[J.IMAGE][J.HEIGHT]/2]:[e[J.IMAGE][J.WIDTH],e[J.IMAGE][J.HEIGHT]]},getOriginalDimensions:C,getMaxDimensions:e=>{if(typeof e!==UNDEF){let t=C(e);if(t)return t;if(e.hasOwnProperty(J.IMAGE)){let r=e[J.IMAGE];if(r.hasOwnProperty(J.RENDITIONS)){t=[r[J.RENDITIONS][0][J.WIDTH],r[J.RENDITIONS][0][J.HEIGHT]];for(let e=1;e<r[J.RENDITIONS].length;e++)r[J.RENDITIONS][e][J.WIDTH]>t[0]&&(t=[r[J.RENDITIONS][e][J.WIDTH],r[J.RENDITIONS][e][J.HEIGHT]]);return t}return l.hiDpiImages?[2*r[J.WIDTH],2*r[J.HEIGHT]]:[r[J.WIDTH],r[J.HEIGHT]]}}return null},getLink:function(e){if(typeof e!==UNDEF)switch(e[J.CATEGORY]){case"folder":return g(e);case"webLocation":return e[J.PATH];case"webPage":return P(g(e),e[J.PATH]);default:return P(g(e),"#img="+e[J.PATH])}return null},getRootPath:e=>typeof e!==UNDEF?P(g(e),e[J.PATH]):null,getFolderPath:F,getRelativeFolderPath:e=>typeof e!==UNDEF?(t=>{let r,n,o=l.rootPath+N(e)+"";for(;(r=o.indexOf("../"))>0;){if(1===r||-1===(n=o.lastIndexOf("/",r-2)))return o.substring(r+3);o=o.substring(0,n)+o.substring(r+2)}return o})():null,getFolder:H,getCurrentFolder:()=>o,getParent:G,getItem:U,getObjects:e=>{let t=typeof e===UNDEF?o:e,r=[];return t.hasOwnProperty(J.OBJECTS)&&t[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]&&r.push(e)}),r},getImages:e=>{let t=typeof e===UNDEF?o:e,r=[];return t.hasOwnProperty(J.OBJECTS)&&t[J.OBJECTS].forEach(e=>{c(e)&&r.push(e)}),r},getFolders:e=>{let t=typeof e===UNDEF?o:e,r=[],n=e=>{let t={};for(let r in e)r!==J.OBJECTS&&r!==J.ALBUM&&r!==J.OBJECTS&&(t[r]=e[r]);return t};return t&&(A()?t.hasOwnProperty(J.OBJECTS)&&t[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e.hidden||r.push(n(e))}):t.hasOwnProperty(J.FOLDERS)&&t[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e.hidden||r.push(n(e))})),r},getAllObjects:e=>{let t=typeof e===UNDEF?o:e,r=[];return t.hasOwnProperty(J.OBJECTS)&&t[J.OBJECTS].forEach(e=>{e.hasOwnProperty(J.FOLDERINDEX)?r.push(t[J.FOLDERS][e[J.FOLDERINDEX]]):r.push(e)}),r},getMakeDate:()=>new Date(n[J.FILEDATE]),getAlbumTitle:()=>n[J.TITLE]||n[J.NAME],getItemName:M,getExtension:I,getLevel:B,getTitle:b,getName:e=>(e||o)[J.NAME]||"",getLabel:x,getAlt:e=>b(e)||x(e),getComment:e=>(e||o)[J.COMMENT]||"",getThumbPath:e=>P(g(e),e.hasOwnProperty(J.LEVEL)?e[J.THUMB][J.PATH].replace(e[J.PATH]+"/",""):e[J.THUMB][J.PATH]),getIconPath:e=>e[J.THUMB][J.PATH].match(/res\/\w+\.png$/)?e[J.THUMB][J.PATH]:"",getImagePath:e=>P(g(e),e.hasOwnProperty(J.LEVEL)?e[J.THUMB][J.PATH].replace(l.thumbsDir+"/",l.slidesDir+"/"):e.hasOwnProperty(J.ORIGINALFILE)?e[J.ORIGINALFILE]:e.hasOwnProperty(J.IMAGE)?e[J.IMAGE][J.PATH]:e[J.THUMB][J.PATH]),getAbsoluteImagePath:e=>P(r,(e=>P(N(e),e.hasOwnProperty(J.ORIGINALFILE)?e[J.ORIGINALFILE]:e.hasOwnProperty(J.IMAGE)?e[J.IMAGE][J.PATH]:e[J.THUMB][J.PATH]))(e)),getThemeImagePath:e=>P(g(e),l.folderImageFile),getOriginalPath:e=>e.hasOwnProperty(J.ORIGINALFILE)?P(g(e),e[J.ORIGINALFILE]):e.hasOwnProperty(J.ORIGINAL)?P(g(e),e[J.ORIGINAL][J.PATH]):null,getVideoPath:e=>e.hasOwnProperty(J.VIDEO)?P(g(e),e[J.VIDEO][J.PATH]):null,getPosterPath:e=>{let t=e[J.CATEGORY],r=e[J.IMAGE][J.PATH];return"audio"!==t&&"video"!==t||r.startsWith(l.slidesDir+"/")?P(g(e),e[J.IMAGE][J.PATH]):P(l.rootPath,"res",l[t+"Poster"])},getOptimalImage:(e,t)=>P(g(e),e.hasOwnProperty(J.LEVEL)?t[0]>l.folderThumbDims[0]||t[1]>l.folderThumbDims[1]?l.folderImageFile:l.folderThumbFile:e.hasOwnProperty(J.ORIGINALFILE)?e[J.ORIGINALFILE]:e.hasOwnProperty(J.IMAGE)&&(t[0]>l.thumbDims[0]||t[1]>l.thumbDims[1])?e[J.IMAGE][J.PATH]:e[J.THUMB][J.PATH]),getOptimalImagePath:(e,t,r,n)=>{n=typeof n!==UNDEF&&n;if(e.hasOwnProperty(J.LEVEL))return R(e)+"/"+l.folderImageFile;if("webLocation"===e[J.CATEGORY])return P(g(e),e[J.IMAGE][J.PATH]);if(e.hasOwnProperty(J.ORIGINALFILE))return P(g(e),e[J.ORIGINALFILE]);let o=e[J.IMAGE].hasOwnProperty(J.RENDITIONS)?Y(e[J.IMAGE][J.RENDITIONS],t||[window.outerWidth,window.outerHeight],n):l.hiDpiImages?{width:2*e[J.IMAGE][J.WIDTH],height:2*e[J.IMAGE][J.HEIGHT]}:{width:e[J.IMAGE][J.WIDTH],height:e[J.IMAGE][J.HEIGHT]};return typeof r!==UNDEF&&r&&e.hasOwnProperty(J.ORIGINAL)&&t[0]>o[J.WIDTH]&&(t=>{var r=e[J.ORIGINAL][J.PATH].match(/\.\w+$/);return!!r&&-1!==".jpg.jpeg.png.webp.webm.gif".indexOf(r[0].toLowerCase())})()?P(g(e),e[J.ORIGINAL][J.PATH]):P(g(e),o.hasOwnProperty(J.NAME)?l.slidesDir+"/"+o[J.NAME]:e[J.IMAGE][J.PATH])},getOptimalThumbPath:(e,t,r)=>{if(e[J.THUMB].hasOwnProperty(J.RENDITIONS)){let n=Y(e[J.THUMB][J.RENDITIONS],t,l.thumbsFillFrame);if("folder"===e[J.CATEGORY])return P(g(e),((e,t)=>e.slice(0,e.lastIndexOf("/")+1)+t)(e[J.THUMB][J.PATH],n[J.NAME]));if("video"===e[J.CATEGORY]||v(t,[n[J.WIDTH],n[J.HEIGHT]],1.07,l.thumbsFillFrame))return P(g(e),l.thumbsDir,n[J.NAME]);if(typeof r!==UNDEF&&r&&e[J.IMAGE].hasOwnProperty(J.RENDITIONS))return n=Y(e[J.IMAGE][J.RENDITIONS],t,l.thumbsFillFrame),P(g(e),l.slidesDir,n[J.NAME])}let n=[e[J.THUMB][J.WIDTH],e[J.THUMB][J.HEIGHT]];return l.hiDpiTHumbs&&(n[0]*=2,n[1]*=2),"video"!==e[J.CATEGORY]&&e.hasOwnProperty(J.IMAGE)&&!v(t,n,1.15,l.thumbsFillFrame)?P(g(e),e[J.IMAGE][J.PATH]):P(g(e),e[J.THUMB][J.PATH])},getSourcePath:e=>P(g(e),e.hasOwnProperty(J.ORIGINAL)?e[J.ORIGINAL][J.PATH]:e.hasOwnProperty(J.IMAGE)?e[J.IMAGE][J.PATH]:e[J.THUMB][J.PATH]),getAbsoluteItemPath:e=>P(r,L(e)),getVideoDuration:e=>{let t=e[J.VIDEO];return t&&t.hasOwnProperty(J.DURATION)?videoDurationMs(t[J.DURATION]):null},hasShop:e=>{if(typeof e===UNDEF)return n.hasOwnProperty(J.SHOP);let t=j(e,J.SHOP);return t&&(t.hasOwnProperty("usePrice")&&t.usePrice||t.hasOwnProperty("options")&&t.options&&"-"!==t.options)},hasLocation:e=>e.hasOwnProperty(J.LOCATION)||e.hasOwnProperty(J.CAMERA)&&e[J.CAMERA].hasOwnProperty(J.LOCATION),getLocation:e=>e.hasOwnProperty(J.LOCATION)?e[J.LOCATION]:e.hasOwnProperty(J.CAMERA)&&e[J.CAMERA].hasOwnProperty(J.LOCATION)?e[J.CAMERA][J.LOCATION].lat+","+e[J.CAMERA][J.LOCATION].long:null,hideFotomoto:e=>e.hasOwnProperty(J.HIDEFOTOMOTO)?e[J.HIDEFOTOMOTO]:k(e,J.HIDEFOTOMOTO)||!1,getPriceRange:e=>{let t=j(e||n,J.SHOP);if(t&&"-"!==t.options&&t.showPriceRange){let e=t.options.split("::"),r=Number.MAX_VALUE,n=Number.MIN_VALUE;if(e.length>1){for(let t=0;t<e.length;t++)r=Math.min(parseFloat(e[t].split("=")[1].split("+")[0]),r);if("minmax"===t.showPriceRange){for(let t=0;t<e.length;t++)n=Math.max(parseFloat(e[t].split("=")[1].split("+")[0]),n);return toCurrency(r,t.currency)+"&ndash;"+toCurrency(n,t.currency)}return E.from.template(toCurrency(r,t.currency))}return toCurrency(e[0].split("=")[1].split("+")[0],t.currency)}return""},getCurrency:()=>V(J.SHOP).currency||"EUR",getDeepFolderCount:W,getRootProperty:V,getInheritedPropertyObject:j,getInheritedProperty:k,getProperty:(t,r,n)=>{let o;return n?o=k(t,r):r.indexOf(".")>0?(r=r.split("."),o=t.hasOwnProperty(r[0])?t[r[0]][r[1]]:null):t.hasOwnProperty(r)&&(o=t[r]),e.extend(!0,{},o)},getPropertyObject:(t,r,n)=>n?j(t,r):t.hasOwnProperty(r)?e.etxend(!0,{},t[r]):null,getNextFoldersFirstImage:function(e){let t=function(e){let t=o||o,r=G(t),n=X(r,t[J.PATH]);if(n>=0)if(l.loadDeep){if(r.hasOwnProperty(J.OBJECTS))for(let e=n+1;e<r[J.OBJECTS].length;e++)if(!("folder"!==r[J.OBJECTS][e][J.CATEGORY]||r[J.OBJECTS][e].hasOwnProperty(J.HIDDEN)&&r[J.OBJECTS][e][J.HIDDEN]))return r[J.OBJECTS][e]}else if(r.hasOwnProperty(J.FOLDERS))for(let e=n+1;e<r[J.FOLDERS].length;e++)if(!r[J.FOLDERS][e].hasOwnProperty(J.HIDDEN)||!r[J.OBJECTS][e][J.HIDDEN])return r[J.FOLDERS][e];return null}(),r=function(e){e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{if(c(e))return e})};t&&(t.hasOwnProperty(J.READY)&&t.ready?e(r(t)):q(t,function(e,t){t[0](r(e))},[e]))},getPreviousFoldersLastImage:function(e){let t=function(e){let t=o||o,r=G(t),n=X(r,t[J.PATH]);if(n>=0)if(l.loadDeep){if(r.hasOwnProperty(J.OBJECTS))for(let e=n-1;e>=0;e--)if(!("folder"!==r[J.OBJECTS][e][J.CATEGORY]||r[J.OBJECTS][e].hasOwnProperty(J.HIDDEN)&&r[J.OBJECTS][e][J.HIDDEN]))return r[J.OBJECTS][e]}else if(r.hasOwnProperty(J.FOLDERS))for(let e=n-1;e>=0;e--)if(!r[J.FOLDERS][e].hasOwnProperty(J.HIDDEN)||!r[J.OBJECTS][e][J.HIDDEN])return r[J.FOLDERS][e];return null}(),r=function(e){if(e.hasOwnProperty(J.OBJECTS))for(let t=e[J.OBJECTS],r=t.length-1;r>=0;r--)if(c(t[r]))return t[r]};return t&&(t.hasOwnProperty(J.READY)&&t.ready?e(r(t)):q(t,function(e,t){t[0](r(e))},[e])),null},sortItems:_,collectByPath:function(t){if(typeof t===UNDEF||!t.hasOwnProperty("paths")||!Array.isArray(t.paths)||typeof t.ready!==FUNCTION)return[];let r,n=[],o=e.extend({folder:"",levels:0,sortBy:"original",reference:"dateTaken",reverse:!1},t),a=o.paths.length,l=0,E=(H(o.folder),function(){clearTimeout(r),l<a&&(D("Error: Timeout collecting items. Image set is incomplete ("+l+"/"+a+")!"),n=function(e){let t=[];for(let r of e)r&&t.push(r);return t}(n)),n=_(n,{sortBy:o.sortBy,reference:o.reference,reverse:o.reverse}),o.ready.call(n,o)});r=setTimeout(E,25*a);for(let e=0;e<a;e++)U(o.paths[e],function(e){this&&typeof e!==UNDEF&&this!==window&&(n[e]=this,++l===a&&(clearTimeout(r),E()))},e)},collectNItem:function(t){if(typeof t===UNDEF||typeof t.ready!==FUNCTION)return;let r=e.extend({folder:"",levels:0,include:"images",max:0,sortBy:"original",sortOrder:0},t),n=[],a=[],E=H(r.folder),i=r.levels?((e,t)=>{let r=typeof e===UNDEF?o:e,n=r[J.LEVEL]+(typeof t===UNDEF?0:t),a=e=>{let t=1;return e[J.LEVEL]<=n&&(A()?e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||(t+=a(e))}):e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||(t+=a(e))})),t};return a(r)})(E,r.levels):1,s=0,O=!1,h=-1!==r.include.indexOf("images"),p=-1!==r.include.indexOf("folders"),T=function(e){e[J.OBJECTS].forEach(e=>{"image"===e[J.CATEGORY]&&(!r.arRange||e[J.IMAGE][J.WIDTH]/e[J.IMAGE][J.HEIGHT]>=r.arRange[0]&&e[J.IMAGE][J.WIDTH]/e[J.IMAGE][J.HEIGHT]<=r.arRange[1])&&n.push(e)})},u=function(e){p&&a.push(e),h&&(e.hasOwnProperty(J.OBJECTS)?T(e):e[J.READY]||q(e,T)),e[J.LEVEL]<=maxLevel&&(A()?e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||u(e)}):e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||u(e)})),s++},D=function(){u(E),setTimeout(function(){f.length?e.when.apply(e,f).done(d):d()},20)},d=function(){O||(r.max&&r.quick&&n.length+a.length>=r.max||!f.length||s>=i?(n=_(n,a,{sortBy:-1===r.sortOrder?"random":r.sortBy||"original",reference:r.reference||J.FILEDATE,reverse:0===r.sortOrder,foldersFirst:r.include.startsWith("folders")}),r.max&&r.max<n.length&&(n=n.slice(0,r.max)),O=!0,r.ready.call(n,r)):setTimeout(d,50))};f=[],O=!1,r.hasOwnProperty("quick")||(r.quick=r.max&&"original"!==r.sortBy),maxLevel=E[J.LEVEL]+r.levels,random=-1===r.sortOrder,random&&(l.sortBy="original"),D()},collectByDate:function(t){if(typeof t===UNDEF||typeof t.ready!==FUNCTION)return;let r,a,l=e.extend({sort:!0,reverse:!1,reference:J.DATETAKEN,depth:"current"},t),E=[],i="current"===l.depth?1:W("tree"===l.depth?n:o),s=0,O=!1,h="tree"===l.depth&&n.hasOwnProperty(J.FOLDERS)||"subfolders"===l.depth&&o.hasOwnProperty(J.FOLDERS)&&o[J.LEVEL]<3,p=function(e){e&&e.hasOwnProperty(J.OBJECTS)&&(e[J.OBJECTS].forEach(e=>{c(e)&&(d=e[J.DATES])&&(d=d[l.reference])&&d>=r&&d<=a&&E.push(e)}),s++)},u=function(e){!e||e.hasOwnProperty(J.HIDDEN)&&e.hidden||(e.hasOwnProperty(J.OBJECTS)?p(e):e[J.READY]||q(e,p),A()?e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||u(e)}):e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||u(e)}))},D=function(){u("tree"===l.depth?n:o),setTimeout(I,20)},y=function(){u("tree"===l.depth?n:o),setTimeout(function(){f.length?e.when.apply(e,f).done(I):I()},20)},I=function(){O||(f.length&&i>s?setTimeout(I,20):(l.sort&&(E=_(E,{sortBy:l.sortBy||"date",reference:l.reference||J.DATETAKEN,reverse:l.reverse||!1})),l.max&&l.max<E.length&&(E=E.slice(0,l.max)),O=!0,l.ready.call(E,l)))};f=[],O=!1,l.hasOwnProperty("end")&&(a=l.end*ONEDAY_S),l.hasOwnProperty("start")&&(r=l.start*ONEDAY_S),l.hasOwnProperty("range")&&(null!==r?a=r+l.range*ONEDAY_S:null!==a?r=a-l.range*ONEDAY_S:(a=Math.round(new Date/1e3),r=a-l.range*ONEDAY_S)),typeof r===UNDEF&&(r=0),typeof a===UNDEF&&(a=Math.round(new Date/1e3)),h&&!T?ae(D,y):y()},collectItems:function(t){if(typeof t===UNDEF||!t.hasOwnProperty("terms")||typeof t.ready!==FUNCTION)return;let r,a,i,s=e.extend({fields:"creator,keywords,name,title,comment,regions",types:"all",depth:"current",divisible:"name,title,comment,photodata",exact:!1,caseSensitive:!1},t),O=[],h=Array.isArray(s.fields)?s.fields:s.fields.split(/,\s?/),p=h.length,u=new Array(p),D=!1,d=!1,y="all"===s.types,I={},c="current"===s.depth?1:W("tree"===s.depth?n:o),P=0,N=!1,R="tree"===s.depth&&n.hasOwnProperty(J.FOLDERS)||"subfolders"===s.depth&&o.hasOwnProperty(J.FOLDERS)&&o[J.LEVEL]<3,w=function(e,t){let r=new Array(a.length).fill(!1),n=function(e,t,r){return s.caseSensitive||(t=t.toLowerCase()),r?(" "+(t=t.replace(i," "))).includes(" "+e):D?e===t:t.startsWith(e)},o=function(e,t,r){if(!Array.isArray(t))return n(e,t,r);let o=!1;for(let a=0;a<t.length;a++)n(e,t[a],r)&&(o=!0);return o},l=function(e,t,n){if(D&&t.includes(";")&&(t=t.split(";")),Array.isArray(e)){let a=!1;for(let l=0;l<e.length;l++)if(o(e[l],t,n)&&(a=r[l]=!0,!d))return!0;return a}return r[0]=o(e,t,n)};for(let r,n,o=0;o<p;o++){if(h[o].length>1){if(h[o][0]!==t)continue;r=h[o][1]}else r=h[o][0];if(JCAMERAFIELDS.indexOf(r)>=0&&e.hasOwnProperty(J.CAMERA)?typeof(n=e[J.CAMERA][r])===UNDEF&&(n=e[r]):r===J.NAME?(n=e.hasOwnProperty(J.ORIGINAL)?decodeURIComponent(e[J.ORIGINAL][J.PATH].getFile()):e[J.NAME],n=n+" "+n.replace(/[\.\-_]/g," ")):r===J.REGIONS?e.hasOwnProperty(J.REGIONS)?(n=[],JSON.parse(e[J.REGIONS]).forEach(e=>n.push(e.split(";")[0]+"")),n=n.filter(Boolean)):n=null:n=e[r],typeof n!==UNDEF&&null!==n&&n.length)if(Array.isArray(n)&&!u[o]){for(let e=0;e<n.length;e++)if(l(a,n[e],u[o])&&!d)return!0}else if(r===J.COMMENT||r.endsWith("Caption")?n=n.stripHTML():Array.isArray(n)?n=n.join(" "):n+="",l(a,n,u[o])&&!d)return!0}return d?r.every(e=>!!e):r.some(e=>!!e)},g=function(e){e&&(e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(t=>{t.hasOwnProperty(J.FOLDERINDEX)?(y||I.folder)&&w(e[J.FOLDERS][t[J.FOLDERINDEX]],"folder")&&O.push(t):t.hasOwnProperty(J.CATEGORY)&&(y||I[t[J.CATEGORY]])&&w(t,t[J.CATEGORY])&&O.push(t)}),P++)},F=function(e){!e||e.hasOwnProperty(J.HIDDEN)&&e.hidden||(e.hasOwnProperty(J.OBJECTS)?g(e):e[J.READY]||q(e,g),A()?e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||F(e)}):"current"!==s.depth&&e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||F(e)}))},L=function(){F("tree"===s.depth?n:o),setTimeout(C,20)},m=function(){F("tree"===s.depth?n:o),setTimeout(function(){f.length?e.when.apply(e,f).done(C):C()},20)},C=function(){N||(f.length&&c>P?setTimeout(C,20):(s.max&&s.max<O.length&&(O=O.slice(0,s.max)),N=!0,s.ready.call(O,s)))};if(f=[],N=!1,r=s.terms.trim(),s.caseSensitive||(r=r.toLowerCase()),'"'===s.terms[0]&&'"'===s.terms[s.terms.length-1])r=r.slice(1,-1).trim(),a=[r],D=!t.hasOwnProperty("exact")||t.exact;else{let e=r.toLowerCase();e.includes(" "+E.and+" ")?(a=r.split(" "+E.and+" "),r.replace(new RegExp(" "+E.and+" ","gi")," "),d=!0):e.includes(" and ")?(a=r.split(" and "),r.replace(/ and /gi," "),d=!0):(a=r.split(" "),d=!1),a=a.filter(Boolean),i=new RegExp("[,\\|\\:"+(r.includes("(")||r.includes(")")?"":"\\(\\)")+(r.includes("-")?"":"\\-")+(r.includes(".")?"":"\\.")+(r.includes("_")?"":"_")+"]","g"),D=!1}for(let e=0,t=s.divisible.split(",");e<p;e++)h[e]=h[e].split(":"),u[e]=t.indexOf(h[e][1]||h[e][0])>=0;y||("-"===s.types.charAt(0)?l.possibleTypes.forEach(e=>{-1===s.types.indexOf(e)&&(I[e]=!0)}):s.types.split(/,\s?/).forEach(e=>{I[e]=!0})),R?T?L():ae(L,m):m()},collectTags:function(t){if(typeof t===UNDEF||typeof t.ready!==FUNCTION)return;let r=e.extend({fields:"creator,keywords,folder:title,webLocation:title,regions",types:"all",depth:"current",divisible:"comment,title"},t),a=[],E=Array.isArray(r.fields)?r.fields:r.fields.split(/,\s?/),i=E.length,s=new Array(i),O="all"===r.types,h={},p=function(e,t){let r="^",n="^",o=function(e,t,o){if(!e)return;let a,l;o?(("comment"===t||t.endsWith("Caption"))&&(e=e.stripHTML()),l=e.split(/[\s,_\.\?\!\-\(\)\[\]]/),l=removeEmpty(l)):l=e.toString().split(";");for(let e=0,t=l.length;e<t;e++)(a=l[e].trim()).length<=2||-1===n.indexOf("^"+a.toUpperCase()+"^")&&(r+=a+"^",n+=a.toUpperCase()+"^")};for(let r,n,a=0;a<i;a++){if(E[a].length>1){if(E[a][0]!==t)continue;r=E[a][1]}else r=E[a][0];if(JCAMERAFIELDS.indexOf(r)>=0&&e.hasOwnProperty(J.CAMERA)?typeof(n=e[J.CAMERA][r])===UNDEF&&(n=e[r]):n=r===J.REGIONS?e.hasOwnProperty(J.REGIONS)?JSON.parse(e[J.REGIONS]):null:e[r],typeof n!==UNDEF&&null!=n)if(r===J.REGIONS)for(let e=0;e<n.length;e++)o(n[e].split(";")[0],r,s[a]);else if(Array.isArray(n))for(let e=0;e<n.length;e++)o(n[e],r,s[a]);else o(n,r,s[a])}r.length>1&&function(e,t){let n=r.split("^").filter(e=>e.length>2);for(let t,r,o,l=0;l<n.length;l++)r=n[l].toUpperCase(),null!==(o=m(e))&&(a&&a.length?(t=a.findIndex(e=>e[2]===r))>=0?-1===a[t][1].indexOf(o)&&a[t][1].push(o):a.push([n[l],[o],r]):a=[[n[l],[o],r]])}(e)},T=function(e){if(e&&(e!==n&&(O||h.folder)&&p(e,"folder"),e.hasOwnProperty(J.OBJECTS)))for(let t,r=0,n=e[J.OBJECTS];r<n.length;r++)n[r].hasOwnProperty(J.CATEGORY)&&(t=n[r][J.CATEGORY],(O||h[t])&&p(n[r],t))},u=function(e){!e||e.hasOwnProperty(J.HIDDEN)&&e.hidden||(q(e,T),A()?e.hasOwnProperty(J.OBJECTS)&&e[J.OBJECTS].forEach(e=>{"folder"!==e[J.CATEGORY]||e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||u(e)}):"current"!==r.depth&&e.hasOwnProperty(J.FOLDERS)&&e[J.FOLDERS].forEach(e=>{e.hasOwnProperty(J.HIDDEN)&&e[J.HIDDEN]||u(e)}))},D=function(){"name"===r.sort?a.sort((e,t)=>(""+e[2]).localeCompare(""+t[2])):"frequency"===r.sort&&a.sort((e,t)=>t[1]-e[1]),r.max&&r.max<a.length&&(a=a.slice(0,r.max)),r.ready.call(a,r)};f=[];for(let e=0,t=r.divisible.split(",");e<i;e++)E[e]=E[e].split(":"),s[e]=-1!==t.indexOf(E[e][1]||E[e][0]);O||("-"===r.types.charAt(0)?l.possibleTypes.forEach(e=>{-1===r.types.indexOf(e)&&(h[e]=!0)}):r.types.split(/,\s?/).forEach(e=>{h[e]=!0})),u("tree"===r.depth?n:o),f.length?e.when.apply(e,f).done(D):D()},processTemplate:function(e,t,r){let n,a,l,E,i=typeof r!==UNDEF&&r,s=t||o;if(e&&e.indexOf("${")>0)for(;l=e.match(/\$\{([\w\.|]+)\}/);){if(l[1].indexOf("|")>0)for(let e=0,t=l[1].split("|");e<t.length&&!(E=z(t[e]));e++);else E=z(s,l[1]);e=null===E&&i&&(n=l.index-1,a=n+l[0].length,n>0&&">"===e[n]&&a<sb.length-1&&"<"===e[a]&&(n=e.lastIndexOf("<",n),a=e.indexOf(">",a),n>=0&&a>=0))?e.slice(0,n)+e.slice(a):e.slice(0,l.index)+(E||"")+e.slice(l.index+l[0].length)}return e}}};
!function(e){"use strict";var t=function(){try{return localStorage.setItem("_t",VER),localStorage.removeItem("_t"),!0}catch(e){return!1}}(),r=DIR_PATH||"/";e.cookie=function(e,n,o){var i=function(e){return!!/^(true|yes)$/.test(e)||!/^(false|no)$/.test(e)&&(/^([\d.]+)$/.test(e)?parseFloat(e):e)},a=function(e){if("string"!=typeof e)return e;if("["===e[0]||"{"===e[0]){e=JSON.parse(e);for(var t in e)"string"==typeof t[e]&&(t[e]=i(t[e]));return e}return i(e)};if(arguments.length>1){l=new Date;return null===n?t?localStorage.removeItem(r+e):document.cookie=encodeURIComponent(e)+"=; expires="+l.toGMTString()+"; path="+r+" SameSite=Strict":(n="object"==typeof n?JSON.stringify(n):String(n),l.setTime(l.getTime()+1e3*("number"!=typeof o?3600:o)),t?localStorage.setItem(r+e,n+"; @"+String(l.getTime())):document.cookie=encodeURIComponent(e)+"="+n+"; expires="+l.toGMTString()+"; path="+r+" SameSite=Strict"),n}if(e)if(t){if(s=localStorage.getItem(r+e)){if(1===(s=s.split("; @")).length&&(s=s[0].split("; ")),!(s.length>1))return a(s);var l;if((l=new Date).getTime()<parseInt(s[1],10))return a(s[0]);localStorage.removeItem(r+e)}}else{var s,u=document.cookie.split(/;\s*/);e+="=";for(var c=0;c<u.length;c++)if(u[c].substring(0,e.length)===e)return a(u[c].substring(e.length))}return null}}(jQuery);
!function(n,e){"use strict";n.fn.dropdownMenu=function(e){return e=n.extend({},n.fn.dropdownMenu.defaults,e),this.each(function(){var s=n(this),t="_ldm_"+Math.floor(1e4*Math.random()),i=new Date;s.find("."+e.hasDropdownClass+"> a").each(function(){n(this).on("click."+t,function(a){if(new Date-i>300){var o=n(this),h=getCoords(a).x-o.offset().left>o.outerWidth()-32,d=o.parent().hasClass(e.openMenuClass);if(!d||h)return a.stopImmediatePropagation(),i=new Date,window.requestAnimationFrame(function(){!function(i,a){var o=n(),h=n(),d=i.parents("."+e.openMenuClass);a&&(d=d.slice(1)),s.find("."+e.openMenuClass).not(d).each(function(){var s=n(this).find("."+e.menuClass);s.length&&(s.data("height")||s.data("height",s.outerHeight()),o=o.add(s)),n(this).removeClass(e.openMenuClass)}),o.on("transitionend."+t,function(){n(this).css({display:"none",transition:"none"})}).css({overflow:"hidden"}),a||((d=i.parent()).hasClass(e.openMenuClass)||((h=d.children("."+e.menuClass)).length&&(h.data("height")||(h.css({display:"flex",visibility:"hidden"}),h.data("height",h.outerHeight()))),d.addClass(e.openMenuClass)),h.parents("."+e.menuClass).css({maxHeight:"none"}),h.on("transitionend."+t,function(){n(this).css({display:"flex",overflow:"visible"})}).css({maxHeight:0,display:"flex",overflow:"hidden",visibility:"visible"})),window.requestAnimationFrame(function(){o.css({transition:"max-height 500ms ease-out",maxHeight:0}),h.css({transition:"max-height 500ms ease-out",maxHeight:h.data("height")||"100vh"})})}(o,h&&d)}),!1}return!0})})})},n.fn.dropdownMenu.defaults={hasDropdownClass:"has-submenu",menuClass:"menu",openMenuClass:"opened"}}(jQuery,$("body"));
!function(o,l,t,r){"use strict";o.fn.scrollToTopBtn=function(){var s=getTranslations({scrollTopTooltip:"Scroll to top"}),n=o("<a>",{class:"scrollup icon-arrow-up",role:"button",title:s.scrollTopTooltip}).appendTo(o(this).eq(0));return l.on("scroll",function(){return n.toggleClass("show",l.scrollTop()>16),!0}),n.on("click",function(){if(o(this).hasClass("show")){return(t.scrollTop()?t:r).animate({scrollTop:0},500),!1}}),n.addTooltip({pos:[2,1,0,1]}),this}}(jQuery,jQuery(window),jQuery("html"),jQuery("body"));
!function(t,e){"use strict";var o=["left","center","right"],s=["top","middle","bottom"];t.fn.alignTo=function(n,a){if(a=t.extend({},t.fn.alignTo.defaults,a),"string"==typeof n&&(n=t(n)),n instanceof t&&n.length){var i,p,l,r=e.width(),f=e.height(),u=function(e){for(;e.length&&"BODY"!==e[0].nodeName;){if("fixed"===e.css("position"))return e;e=e.parent()}return t()}(n);if("AREA"===n[0].nodeName&&"RECT"===n[0].shape.toUpperCase()){i=n.parent().offset();var g=n[0].coords.split(",");i.left+=parseInt(g[0],10),i.top+=parseInt(g[1],10),p=parseInt(g[2],10)-parseInt(g[0],10),l=parseInt(g[3],10)-parseInt(g[1],10)}else i=n.offset(),p=n.outerWidth(),l=n.outerHeight();return i.left-=e.scrollLeft(),i.top-=e.scrollTop(),this.each(function(){var n=t(this),g=n.find("."+a.nubClass),d=a.pos[2],h=a.pos[3];n.css("maxHeight","none");var c=n.outerWidth(),b=n.outerHeight(),m=Math.round(i.left+a.pos[2]*p/2+(a.pos[2]-1)*a.gap),v=Math.round(i.top+a.pos[3]*l/2+(a.pos[3]-1)*a.gap),x=Math.round(m-a.pos[0]*c/2),z=Math.round(v-a.pos[1]*b/2);(z<0||z+b>f)&&(1!==a.pos[2]?z=2*z+b>f?f-b:0:0===a.pos[3]?f>2*i.top+l&&(z=i.top+l+a.gap,h=2):2===a.pos[3]&&f<2*i.top+l&&(z=Math.max(0,i.top-b-a.gap),h=0),z<0&&(z=0)),(x<0||x+c>r)&&(1!==a.pos[3]?x=2*x+c>r?r-c:0:0===a.pos[2]?r>2*i.left+p&&(x=i.left+p+a.gap,d=2):2===a.pos[2]&&r<2*i.left+p&&(x=Math.max(0,i.left-c-a.gap),d=0),x<0&&(x=0),x+c>r&&n.css({maxWidth:r-x-(parseInt(n.css("paddingLeft"),10)+parseInt(n.css("paddingRight"),10))})),a.fixNub&&g.length&&(0===h?g.css({left:i.left-x+p/2-a.nubSize,top:"auto",bottom:-2*a.nubSize}):2===h?g.css({left:i.left-x+p/2-a.nubSize,top:-2*a.nubSize,bottom:"auto"}):0===d?g.css({top:i.top-z+l/2-a.nubSize,left:"auto",right:-2*a.nubSize}):2===d&&g.css({top:i.top-z+l/2-a.nubSize,left:-2*a.nubSize,right:"auto"})),u.length?n.css({position:"fixed",left:x,top:z}):n.css({position:"absolute",left:x+e.scrollLeft(),top:z+e.scrollTop()}),n.removeClass("align-left align-center align-right valign-top valign-middle valign-bottom").addClass("align-"+o[d]).addClass("valign-"+s[h])})}},t.fn.alignTo.defaults={gap:0,pos:[1,2,1,0],fixNub:!0,nubClass:"nub",nubSize:5}}(jQuery,$(window));
!function(t,e){"use strict";t.fn.hideAllTooltips=function(e){return this.each(function(){t(this).data("suppressTooltips",!0).find("[data-tooltip-id]").each(function(){if(!t(this).data("tooltip-keep")){var o=t(this).attr("data-tooltip-id");o&&o.length&&o!==e&&t("#"+o).hide()}})})},t.fn.destroyAllTooltips=function(e){return this.each(function(){t(this).data("suppressTooltips",!0).find("[data-tooltip-id]").each(function(){var o=t(this).attr("data-tooltip-id");o&&o.length&&o!==e&&t("#"+o).remove()})})},t(document).on("mouseleave._ltt_",function(){e.hideAllTooltips()}),t.fn.addTooltip=function(o,i){typeof o===UNDEF||typeof o===STRING||o.jquery||(i=o,o=null),i=t.extend({},t.fn.addTooltip.defaults,i);var a=function(e){if(typeof e!==UNDEF&&e&&e.length){if(e.is(":hidden")||e.css("opacity")<.25)return!1;var o=!0;return e.parents().each(function(){if(t(this).is(":hidden")||t(this).css("opacity")<.25)return o=!1,!1}),o}return!0};return this.each(function(){if(t(this).data("tooltip-id"))return!0;var n,s,l,r,u,d=t(this),p=i,c=!1,f=!1,h=!1,T="_ltt_"+Math.floor(1e4*Math.random()),m=function(e){c=!0,a(t(this))&&clearTimeout(l)},y=function(t){f||(c=!1,clearTimeout(l),l=setTimeout(v,Math.max(p.stay,500)))},v=function(){clearTimeout(l),!1===c&&(h=!1,clearTimeout(s),n&&n.css({opacity:0}).one("transitionend",function(){t(this).css({display:"none"})}))},g=function(){clearTimeout(l),l=setTimeout(v,p.stay)},b=function(){var o=d.offset();d.data("suppressTooltips")||(clearTimeout(l),(!r||Math.abs(o.top-r.top)<1&&Math.abs(o.left-r.left)<1)&&(p.exclusive&&(d.data("tooltip-keep",!0),e.hideAllTooltips(d.data("tooltip-id")),d.data("tooltip-keep",null)),n.css({opacity:0,display:"block"}).alignTo(d,{gap:p.gap,pos:p.pos}).css({opacity:1}).one("transitionend",function(){t(this).css({display:"block"}),g()}),h=!0),r=o)},k=function(){return!!n&&n.is(":visible")&&n.css("opacity")>.99},A=function(t){var e=t.closest("a");return e.length&&e.attr("href")&&!e.attr("href").startsWith("javascript")},x=function(e){d.off("."+T),clearTimeout(s),clearTimeout(l),d.data("suppressTooltips",!0),t("#"+d.attr("data-tooltip-id")).remove(),d.attr("data-tooltip-id",null)};d.attr("data-tooltip")&&typeof d.data("tooltip")===OBJECT&&(p=t.extend({},p,d.data("tooltip")),d.removeAttr("data-tooltip")),d.attr("data-tooltip-id",T).data("suppressTooltips",!1).on("destroyTooltip",x).on("removeTooltip",v).on("focus."+T+" mouseenter."+T,function(e){if(!d.data("suppressTooltips")&&a(t(e.target).closest("[data-tooltip-id]"))){if(h=k(),u=new Date,r=d.offset(),(n=t("#"+d.data("tooltip-id"))).length)clearTimeout(l);else if(d.data("suppressTooltips")||!(n=function(e,o){var a;if(o)if(typeof o===STRING)a=t("<div>",{html:o}).appendTo("body");else{if(!o.jquery)return t();a=t.contains(document.body,o[0])?o:o.appendTo("body")}else{if((o=e.data("tooltip"))?o.jquery?o.removeClass("hidden"):typeof o===STRING?"."===o.charAt(0)?o=e.find(o).eq(0):"#"===o.charAt(0)&&(o=t(o)):(typeof o===OBJECT&&(i=t.extend({},i,o)),o=e.attr("title"),e.removeAttr("title")):(o=e.attr("title"),e.removeAttr("title")),!o||!o.length)return t();a=t("<div>",{html:o}).appendTo("body")}return a.is(":empty")?null:(a.attr("id",e.attr("data-tooltip-id")).addClass(i.className).attr("role","tooltip").attr("aria-hidden",!0).hide().append(t("<span>",{class:i.nub})),a)}(d,o))||(n.on("mouseenter."+T,m).on("mouseleave."+T,y),n.find("input, textarea").on("focus."+T,function(){f=!0,m(this)}).on("blur."+T,function(){f=!1}),n.find("[data-closer]").on("click."+T,function(){return setTimeout(g,1e3),!0}),0))return x(),!0;clearTimeout(s),s=null,"mouse"===whatInput.ask("intent")&&(s=setTimeout(b,p.delay))}return!0}).on("blur."+T+" mouseleave."+T,function(e){return a(t(e.target).closest("[data-tooltip-id]"))&&(clearTimeout(l),l="mouse"===whatInput.ask("intent")?setTimeout(v,500):setTimeout(v,3e3)),!1}).on("click."+T,function(e){if(a(t(e.target).closest("[data-tooltip-id]"))){if(clearTimeout(s),p.touchToggle||"mouse"!==whatInput.ask("intent")){var o=new Date;if(p.touchToggle||o-u>1e3)return!(!A(t(e.target))||!k())||(function(t){t.preventDefault(),clearTimeout(s),clearTimeout(l)}(e),h?v():b(),!1)}else if(A(t(e.target)))return!0;h&&(clearTimeout(l),v()),c=!1}return!0})})},t.fn.addTooltip.defaults={delay:100,className:"tooltip",nub:"nub",stay:2e3,exclusive:!0,touchToggle:!1,pos:[1,2,1,0],gap:6}}(jQuery,$("body"));
!function(t,a,o){"use strict";t.fn.modal=function(a,s,e){if("string"==typeof a&&(a=t(document.createTextNode(a))),a instanceof t&&a.length){typeof s===UNDEF||Array.isArray(s)||(e=s,s=null),a.data("modal")&&(e=t.extend({},e,a.data("modal"))),e=t.extend({},t.fn.modal.defaults,e);var l=t(this),n=l.find("."+e.modalClass),d=n.length?parseInt(n.last().css("zIndex")):3e5,i=getTranslations(t.fn.modal.text),r=function(a,o){var s,n,r;if((s=t("<div>",{class:e.modalClass,zIndex:d+1}).appendTo(l)).data("modal-ns","lmo_"+Math.floor(1e4*Math.random())),n=t("<div>",{class:e.windowClass+(e.hasOwnProperty("class")?" "+e.class:""),role:"dialog"}).appendTo(s),t("<a>",{class:e.closeClass,title:i.closeWindow}).appendTo(e.alignTo?s:n).addTooltip(),r=t("<div>",{class:e.contentClass+" scrollable"}).appendTo(n),e.title&&n.addClass(e.hasHeaderClass).prepend(t("<header>",{class:e.headerClass+(e.icon?" icon-"+e.icon:""),html:"<h4>"+e.title+"</h4>"})),r.append(a.show()),o){var u,p,h=t("<div>",{class:e.buttonsClass}).appendTo(r),f=function(a){a.preventDefault();var o=a.target;return typeof o.handler===FUNCTION&&!1!==o.handler.call(this)&&c(t(o).closest("."+e.modalClass)),!1};for(u=0;u<o.length;u++)p=t("<button>",{class:[e.buttonClass,o[u].c].filter(Boolean).join(" "),html:" "+o[u].t}).on("click",f).appendTo(h),typeof o[u].h===FUNCTION&&(p[0].handler=o[u].h)}return s},c=function(t){t.length&&(clearTimeout(t.data("to")),t.destroyAllTooltips(),t.fadeOut(e.speed,function(){t.data("keep")?t.hide().css("opacity",1):t.remove()}),o.toggleClass(e.hasModalClass,l.find("."+e.modalClass).length))};return function(a,s){var n=function(a){return t.contains(document.documentElement,a[0])}(a)?function(t){var a=t.parents("."+e.modalClass);return a.length&&a.parent()===l||(a=t.appendTo(l)),a.data("keep",!0),a}(a):typeof s===UNDEF?r(a):r(a,s);e.hasOwnProperty("closeOnClick")&&t(e.closeOnClick).on("click",function(){c(t(this).closest("."+e.modalClass))});var d=e.hasOwnProperty("alignTo")?e.alignTo instanceof jQuery?e.alignTo:t(e.alignTo):t();return d.length&&d.is(":visible")&&function(a,o){o.jquery||(o=t(o));var s,l,n=o.position(),d=[o.outerWidth(),o.outerHeight()],i=[a.outerWidth(),a.outerHeight()],r=[(n.left+d[0]/2)/i[0],(n.top+d[1]/2)/i[1]],c=null,u=null,p=null,h=null,f={},C={};r[0]>.333&&r[0]<.667?c="50%":r[0]<=.333?c=n.left+"px":(u=i[0]-(n.left+d[0])+"px",c="auto"),r[1]<=.5?(p=n.top+d[1]+4+"px",s=n.top+d[1]-e.closeSize+"px"):(h=i[1]-n.top+4+"px",p="auto",l=i[1]-n.top-e.closeSize+"px",s="auto"),f.left=C.left=c,null!==u&&(f.right=C.right=u),f.top=p,C.top=s,null!==h&&(f.bottom=h,C.bottom=l),f.transform=C.transform="50%"===c&&"50%"===p?"translate(-50%,-50%)":"50%"===c?"translateX(-50%)":"50%"===p?"translateY(-50%)":"none",a.children("."+e.windowClass).css(f),a.children("."+e.closeClass).css(C)}(n,d),n.hide().css("opacity",1).fadeIn(e.speed),o.addClass(e.hasModalClass),n.on("destroy",function(){c(t(this))}),n.on("close",function(){c(t(this))}),n.find("."+e.closeClass).add(n).on("click."+n.data("modal-ns"),function(a){if(a.target===this)return c(t(this).closest("."+e.modalClass)),typeof e.onClose===FUNCTION&&e.onClose.call(this),!1}),e.autoFade&&n.data("to",setTimeout(function(){c(n)},e.autoFade)),n}(a,s)}},t.fn.modal.defaults={modalClass:"modal",windowClass:"window",headerClass:"header",closeClass:"close",contentClass:"content",buttonsClass:"buttons",buttonClass:"button",hasHeaderClass:"has-header",hasModalClass:"has-modal",speed:300,autoFade:0,width:400,type:"normal",closeSize:40},t.fn.modal.text={closeWindow:"Close window"}}(jQuery,jQuery(window),jQuery("body"));
!function(e){"use strict";e.fn.renderShares=function(t){t=e.extend({},e.fn.renderShares.defaults,t);var i,a,n,r,s=e(this),o=getTranslations({share:"Share",shareOn:"Share on",checkThisOut:"This album is worth checking out",email:"Email",slideshow:"Slideshow",copy:"Copy",copied:"Copied",localWarning:"Can't share local albums. Please upload your album first!"}),l=t.emailSubject||o.checkThisOut,c=t.emailBody||"{title}\n\r{description}\n\r{link}",p=(t.indexName.getExt(),function(e){var t,i=this.querySelector("input[name=url]"),a=i.value;if(i){i.focus(),i.setSelectionRange(0,a.length);try{t=document.execCommand("copy")}catch(e){t=!1}t&&(i.value=o.copied+"...",i.classList.add("copied"),setTimeout(function(){i.value=a,i.classList.remove("copied")},500))}return!1}),d=function(e){var t=this.checked,i=this.name,a=this.parentNode.querySelector("input[name=url]");t?a.value.indexOf("#")>=0?-1===a.value.indexOf(new RegExp("[#&]"+i))&&(a.value+="&"+i):a.value+="#"+i:a.value=a.value.replace(new RegExp("[#&]"+i,"g"),"")},h=function(i){typeof i===UNDEF?i=t:(i.hasOwnProperty("href")||(i.href=window.location.href),i.hasOwnProperty("title")&&i.title&&(i.title=i.title.stripHTML()),i.hasOwnProperty("description")&&i.description&&(i.description=i.description.stripHTML()),i=e.extend({},t,i)),i.image.startsWith("http")||(i.image=window.location.href.getDir()+i.image);var r=e(i.currCardHook);if(r.length){if(!i.hasOwnProperty("title")&&(i.title=r.find(".caption .title").text(),!i.title)){var h=r.find("img, video");i.title=h.length?h.attr("title")||h.attr("alt")||(h.attr("src")?h.attr("src").getFile().replace(/\.(jpg|gif|png|mp4)$/i,"").replace(/_/g," "):""):""}if(i.hasOwnProperty("description")||(i.description=r.find(".caption .comment").text()),!i.hasOwnProperty("image")){var u=e(i.currCardHook+" img");u.length?i.image=u.attr("src"):(u=e(i.currCardHook+" video")).length?i.image=u.attr("src").replaceExt("jpg"):(u=e("link[rel=image_src]"),i.image=u.length?u.attr("href"):window.location.href.getDir()+"folderthumb.jpg")}i.usePreview&&(i.hasOwnProperty("image")&&a.attr("src",i.image),n.empty(),i.hasOwnProperty("title")&&n.append('<h3 class="title">'+i.title+"</h3>"),i.hasOwnProperty("description")&&n.append('<div class="description">'+i.description+"</div>"))}var m,f=encodeURIComponent(i.href),g=i.href.indexOf("#img=")>0?i.href.replace(t.indexName,"").replace("#img=","slides/").replaceExt(i.pageExt):i.href,b=encodeURIComponent(i.title),w=encodeURIComponent(i.description),k=encodeURIComponent(i.image);s.find("."+t.sharesClass+" a").each(function(){var a=e(this);switch(a.data("share")){case"facebook":if(typeof FB!==UNDEF)return void a.off(".share").on("click.share",function(){return FB.ui({method:"share",href:g,caption:i.title,description:i.description,picture:i.image}),!1});m="https://www.facebook.com/sharer.php?s=100&p%5Burl%5D="+i.href+"&p%5Bimages%5D%5B0%5D="+i.image+"&p%5Btitle%5D="+b;break;case"twitter":m="https://twitter.com/intent/tweet?url="+b+":%20"+f;break;case"tumblr":m="https://www.tumblr.com/share/link?url="+f+"&name="+b;break;case"pinterest":m="https://pinterest.com/pin/create/button/?url="+f+"&media="+k+"&description="+b;break;case"linkedin":m="https://www.linkedin.com/shareArticle?mini=true&url="+f+"&title="+b+"&summary="+w;break;case"digg":m="https://digg.com/submit?url="+i.href;break;case"reddit":m="https://www.reddit.com/submit?url="+i.href;break;case"email":m="mailto:?subject="+encodeURIComponent(l.replace("{title}",i.title).replace("{description}",i.description).replace("{album}",t.albumTitle||""))+"&body="+encodeURIComponent(c.replace("{title}",i.title).replace("{description}",i.description).replace("{link}",i.href).replace("{album}",t.albumTitle||""));break;case"link":var n=e('<form class="copy-url"><input name="url" type="text" readonly value="'+i.href+'"><input name="slideshow" id="slideshowcb" type="checkbox"><label for="slideshowcb">'+o.slideshow+'</label> <button type="submit" class="button icon-copy" data-closer> '+o.copy+"</button></form>");return n.on("submit",p),n.find("[name=slideshow]").on("change",d),void a.addClass("copy-url-btn").trigger("destroyTooltip").addTooltip(n,{stay:3e3,pos:t.pos,touchToggle:!0});default:return}a.attr({href:m,target:"_blank"})})};if(t.hasOwnProperty("href")||(t.href=window.location.href),!t.hasOwnProperty("image")){var u=e("link[rel=image_src]");t.image=u.length?u.attr("href"):""}return t.hasOwnProperty("title")||(t.title=s.find("h3,.title").eq(0).text()||e("meta[name=title]").attr("content")||e("title").text()||""),t.hasOwnProperty("description")||(t.description=s.find(".description").text()||""),t.hasOwnProperty("pageExt")||(t.pageExt=t.indexName.getExt()),t.usePreview?((i=s.find("."+t.contClass)).length||(i=e("<div>",{class:t.contClass}).appendTo(s)),(a=i.find("img")).length||(t.image?a=e("<img>",{src:t.image}).appendTo(i):i.addClass("no-image")),(n=i.find("."+t.captionClass)).length||(n=e("<div>",{class:t.captionClass,html:'<h3 class="title">'+t.title+"</h3>"+(t.description?'<div class="description">'+t.description+"</div>":"")}).appendTo(i)),(r=i.find("."+t.socialLinksClass)).length||(r=e("<div>",{class:t.socialLinksClass}).appendTo(i))):r=s,function(i){for(var a,n,r=e("<div>",{class:t.sharesClass}).appendTo(i||s),l=t.sites.split(","),c=0;c<l.length;c++)a=l[c],"facebook,twitter,tumblr,pinterest,linkedin,digg,reddit,email,link".indexOf(a)>=0&&(n=e("<a>",{class:t.btnClass+" icon-"+a.unCamelCase(),rel:"noopener",text:" "+(t.buttonLabels?a.capitalize():"")}).data("share",a).appendTo(r),"email"===a?n.data("tooltip",o.email):"link"!==a&&n.data("tooltip",o.shareOn+" "+a.capitalize()));h(),r.children("a").not(".copy-url-btn").addTooltip({pos:t.pos})}(r),t.hasOwnProperty("buttons")&&!LOCAL&&function(i){for(var a=t.buttons.split(","),n=encodeURIComponent(window.location.href.split("#")[0]),r=encodeURIComponent(t.title||e("meta[name=title]").attr("content")||e("title").text()),o=t.image?(t.image.startsWith("http")?"":window.location.href.getDir())+encodeURIComponent(t.image):e("link[rel=image_src]").attr("href"),l=e("<div>",{class:t.buttonsClass}).appendTo(i||s),c=0;c<a.length;c++)switch(a[c]){case"facebook":l.append('<div class="likebtn fb-like" data-href="'+n+'" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="false"></div>');break;case"twitter":l.append('<a class="likebtn twitter-share-button icon-twitter" href="https://twitter.com/intent/tweet?text='+r+"&url="+n+'" data-size="large" target="_blank"> Tweet</a>');break;case"pinterest":l.append('<div class="likebtn"><a data-pin-do="buttonPin" data-pin-count="beside" data-pin-tall="true" data-pin-save="true" href="https://www.pinterest.com/pin/create/button/?url='+n+"&media="+o+"&description="+r+'" data-pin-do="buttonPin"></a></div>')}}(r),s.closest(".modal").length&&s.find("."+t.sharesClass+" a").not(".copy-url-btn").on("click",function(){return e(this).closest(".modal").trigger("close"),!0}),s.on("updateLinks",function(e,t){h(t)}),this},e.fn.renderShares.defaults={buttonLabels:!1,usePreview:!0,contClass:"preview",captionClass:"caption",socialLinksClass:"social-links",sharesClass:"shares",buttonsClass:"buttons",btnClass:"btn",sites:"facebook,twitter,tumblr",indexName:"index.html",currCardHook:".lightbox .curr",emailSubject:"",emailBody:"",pos:[2,1,0,1]}}(jQuery);
!function(s,t){"use strict";s.fn.sticky=function(i){i=s.extend({stickyClass:"sticky",stickToEdge:"st-stick",topmostClass:"st-topmost",bottommostClass:"st-bottommost",topClass:"st-top",bottomClass:"st-bottom",placeholderClass:"st-placeholder",controlsClass:"st-controls",minimizedClass:"minimized",maximizedClass:"maximized",watch:".thumbnails",watchThreshold:100,minimizableThreshold:80,placeBelow:".top-bar.sticky"},i);var a="lst_"+Math.floor(1e4*Math.random()),o=new Array,e=-999,l=function(t){var a=s("[data-sticky-rel="+o[t].id+"]"),e=s("#"+o[t].id);a.length&&a.hasClass(i.stickyClass)&&(e.height(0),a.removeClass(i.stickyClass+" "+i.topClass+" "+i.bottomClass))},c=function(t){var a=t?s("."+i.bottomClass+"."+i.stickyClass+":visible").backwards():s("."+i.topClass+"."+i.stickyClass+":visible"),o=t?0:s(i.placeBelow+":visible").outerHeight()||0;a.each(function(){s(this).css(t?"bottom":"top",o),o+=s(this).outerHeight()})},h=function(){var a,c,h,n,r,d=t.scrollTop(),C=t.outerHeight(),m=s(i.watch+":visible");if(!(Math.abs(d-e)<=2)){if(m.length&&(r=m.position().top),!m.length||r>d+C-i.watchThreshold||r+m.outerHeight()<=d+i.watchThreshold)!function(){for(var s=0;s<o.length;s++)l(s)}();else{a=s(i.placeBelow+":visible").outerHeight()||0,h=!0,s("."+i.topClass+"."+i.stickyClass+":visible").each(function(){a+=s(this).outerHeight(),h=!1}),c=0,n=!0,s("."+i.bottomClass+"."+i.stickyClass+":visible").each(function(){c+=s(this).outerHeight(),n=!1});for(var u,b,p,g=0;g<o.length;g++)u=s("[data-sticky-rel="+o[g].id+"]"),b=s("#"+o[g].id),u.length&&b.length&&((p=b.position().top)<d+a||p+o[g].height>d+C-c?u.hasClass(i.stickyClass)||(b.height(o[g].height),u.addClass(i.stickyClass),p<d+a?(a?u.removeClass(i.stickToEdge).css("top",a):u.addClass(i.stickToEdge),a+=s(this).outerHeight(),h&&(u.addClass(i.topmostClass),h=!1),u.addClass(i.topClass).removeClass(i.bottomClass)):u.addClass(i.bottomClass).removeClass(i.topClass)):l(g));c=0,s("."+i.bottomClass+"."+i.stickyClass).backwards().each(function(){s(this).css("bottom",c),c?s(this).removeClass(i.stickToEdge):s(this).addClass(i.stickToEdge),c+=s(this).outerHeight(),n&&(s(this).addClass(i.bottommostClass),n=!1)})}return!0}};return this.each(function(t){var e=s(this),l=e.children().first(),h=a+"_"+t,n=e.outerHeight();e.before(s("<div>",{id:h,class:i.placeholderClass})),n>i.minimizableThreshold&&l.prepend(s("<div>",{class:i.controlsClass}).append(s("<a>",{class:"minimize"}).on("click",function(){e.removeClass(i.maximizedClass).addClass(i.minimizedClass),c(e.hasClass(i.bottomClass))})).append(s("<a>",{class:"maximize"}).on("click",function(){e.removeClass(i.minimizedClass).addClass(i.maximizedClass),c(e.hasClass(i.bottomClass))}))),e.attr("data-sticky-rel",h).addClass(i.maximizedClass),o[t]={id:h,height:n}}),s(this).on("stickyRefresh",function(){e=-999,h()}),t.on("scroll."+a+" resize."+a,function(){h()}),h(),this}}(jQuery,jQuery(window));
!function(t,o){"use strict";var e,i,a="undefined",n="function",s=function(){var t=(document.body||document.documentElement).style;if(void 0!==t.webkitTransition)e="-webkit-",i="webkitTransitionEnd";else if(void 0!==t.MozTransition)e="-moz-",i="transitionend";else if(void 0!==t.OTransition)e="-o-",i="oTransitionEnd";else{if(void 0===t.transition)return!1;e="",i="transitionend"}return!0}(),r={left:0,top:0,center:.5,middle:.5,right:1,bottom:1};t.fn.translateX=function(o,r,p,f){var c={};if(typeof o===a){var l=t(this).eq(0);return s?l.position().left-parseFloat(l.css("left")):l.position().left-l.data("leftPos")||0}return typeof p===a?p="ease-out":typeof p===n&&(f=p,p="ease-out"),s&&(c[e+"transform"]="translateX("+o+"px)",c[e+"transition"]=e+"transform"+(r?" "+r+"ms "+p:"")),this.each(function(){var e=t(this);if(s)typeof f===n&&e.one(i,f),e.css(c);else{var a=e.data("leftPos");void 0===a&&e.data("leftPos",a=e.position().left),c.left=a+o,r?e.animate(c,{duration:r,easing:p,complete:f}):(typeof f===n&&setTimeout(function(){f.call(e[0])},50),e.css(c))}})},t.fn.translateY=function(o,r,p,f){var c={};if(typeof o===a){var l=t(this).eq(0);return s?l.position().top-parseFloat(l.css("top")):l.position().top-l.data("topPos")||0}return typeof p===a?p="ease-out":typeof p===n&&(f=p,p="ease-out"),s&&(c[e+"transform"]="translateY("+o+"px)",c[e+"transition"]=e+"transform"+(r?" "+r+"ms "+p:"")),this.each(function(){var e=t(this);if(s)typeof f===n&&e.one(i,f),e.css(c);else{var a=e.data("topPos");void 0===left&&e.data("topPos",a=e.position().top),c.top=a+o,r?e.animate(c,{duration:r,easing:p,complete:f}):(typeof f===n&&setTimeout(function(){f.call(e[0])},50),e.css(c))}})},t.fn.translate=function(o,r,p,f){var c={};if(typeof o===a){var l=t(this).eq(0);return s?[l.position().left-parseFloat(l.css("left")),l.position().top-parseFloat(l.css("top"))]:[l.position().left-l.data("leftPos")||0,l.position().top-l.data("topPos")||0]}return typeof p===a?p="ease-out":typeof p===n&&(f=p,p="ease-out"),s&&(c[e+"transform"]="translate("+o[0]+"px,"+o[1]+"px)",c[e+"transition"]=e+"transform"+(r?" "+r+"ms "+p:"")),this.each(function(){var e=t(this);if(s)typeof f===n&&e.one(i,f),e.css(c);else{var a=e.data("leftPos");top=e.data("topPos"),void 0===a&&e.data("leftPos",a=e.position().left),void 0===top&&e.data("topPos",top=e.position().top),c.left=a+o[0],c.top=top+o[1],r?e.animate(c,{duration:r,easing:p,complete:f}):(typeof f===n&&setTimeout(function(){f.call(e[0])},50),e.css(c))}})},t.fn.translateXAndFade=function(o,r,p,f,c){var l={opacity:r};return typeof f===a?f="ease-out":typeof f===n&&(c=f,f="ease-out"),s&&(l[e+"transform"]="translateX("+o+"px)",l[e+"transition-property"]=e+"transform, opacity",l[e+"transition-duration"]=p+"ms",l[e+"transition-timing-function"]=f+", linear"),this.each(function(){var e=t(this);if(s)typeof c===n&&e.one(i,c),e.css(l);else{var a=e.data("leftPos");void 0===a&&e.data("leftPos",a=e.position().left),l.left=a+o,p?e.animate(l,{duration:p,specialEasing:[f,"linear"],complete:c}):(e.css(l),typeof c===n&&setTimeout(function(){c.call(e[0])},50))}})},t.fn.translateYAndFade=function(o,r,p,f,c){var l={opacity:r};return typeof f===a?f="ease-out":typeof f===n&&(c=f,f="ease-out"),s&&(l[e+"transform"]="translateY("+o+"px)",l[e+"transition-property"]=e+"transform, opacity",l[e+"transition-duration"]=p+"ms",l[e+"transition-timing-function"]=f+", linear"),this.each(function(){var e=t(this);if(s)typeof c===n&&e.one(i,c),e.css(l);else{var a=e.data("topPos");void 0===a&&e.data("topPos",a=e.position().top),l.top=a+o,p?e.animate(l,{duration:p,specialEasing:[f,"linear"],complete:c}):(e.css(l),typeof c===n&&setTimeout(function(){c.call(e[0])},50))}})},t.fn.translateAndFade=function(o,r,p,f,c){var l={opacity:r};return typeof f===a?f="ease-out":typeof f===n&&(c=f,f="ease-out"),s&&(l[e+"transform"]="translate("+o[0]+"px,"+o[1]+"px)",l[e+"transition-property"]=e+"transform, opacity",l[e+"transition-duration"]=p+"ms",l[e+"transition-timing-function"]=f),this.each(function(){var e=t(this);if(s)typeof c===n&&e.one(i,c),e.css(l);else{var r=e.data("leftPos"),u=e.data("topPos");typeof r===a&&e.data("leftPos",r=e.position().left),typeof u===a&&e.data("topPos",u=e.position().top),l.left=r+o[0],l.top=u+o[1],p?e.animate(l,{duration:p,specialEasing:[f,"linear"],complete:c}):(e.css(l),typeof c===n&&setTimeout(function(){c.call(e[0])},50))}})},t.fn.opacity=function(o,r,p,f){var c=t(this);if(typeof o===a||"boolean"==typeof o)return c.css("opacity");var l=!1,u={},y=function(){l||(l=!0,typeof f===n&&f.call(c[0]))};return typeof r===n?(f=r,p="ease-out",r=0):typeof p===n&&(f=p,p="ease-out"),c.css("opacity")===o?(typeof f===n&&setTimeout(function(){f.call(c[0])},50),this):(u.opacity=o,s?r?(u[e+"transition"]="opacity "+r+"ms "+p,c.one(i,y),setTimeout(y,r+50),c.css(u)):(u[e+"transition"]="none",c.css(u),typeof f===n&&setTimeout(function(){f.call(c[0])},50)):r?c.animate(u,{duration:r,easing:p,complete:f}):(c.css(u),typeof f===n&&setTimeout(function(){f.call(c[0])},50)),this)},t.fn.transform=function(o,p,f,c,l){var u=t(this).eq(0),y=u.data("transform")||{origo:[0,0],position:[0,0],origin:[.5,.5],baseSize:[u.width(),u.height()],baseScale:[1,1],scale:[1,1],rotate:0};if("object"!=typeof o)return y;arguments.length>1?(typeof p===n?(l=p,f="ease-out",p=void 0):typeof f===n?(l=f,f="ease-out"):typeof c===n&&(l=c,c=!1),"boolean"==typeof f&&(c=f,f="ease-out"),"boolean"==typeof p&&(c=p,p=void 0)):f="ease-out";var d,m=!1,g={},h=function(){setTimeout(function(){m||(m=!0,typeof l===n&&l.call(u[0]))},20)};if(o.hasOwnProperty("opacity")&&(g.opacity=o.opacity),o.hasOwnProperty("origo")){if(!s||c){var v=u.data("originalPosition");typeof v===a&&(v=[u.position().left,u.position().top],u.data("originalPosition",v)),o.origo[0]+=v[0],o.origo[1]+=v[1]}}else o.origo=y.origo;return o.hasOwnProperty("baseScale")?"number"==typeof o.baseScale&&(o.baseScale=[o.baseScale,o.baseScale]):o.baseScale=y.baseScale,o.hasOwnProperty("baseSize")?o.scale||o.size||(o.scale=[1,1]):o.baseSize=y.baseSize,o.hasOwnProperty("position")?(typeof o.position[0]===a&&(o.position[0]=y.position[0]),typeof o.position[1]===a&&(o.position[1]=y.position[1])):o.position=y.position,o.hasOwnProperty("origin")?("string"==typeof o.origin[0]&&(o.origin[0]=r[o.origin[0]]),"string"==typeof o.origin[1]&&(o.origin[1]=r[o.origin[1]])):o.origin=y.origin,o.hasOwnProperty("scale")?"number"==typeof o.scale&&(o.scale=[o.scale,o.scale]):o.hasOwnProperty("size")?o.scale=[o.size[0]/o.baseSize[0],o.size[1]/o.baseSize[1]]:o.scale=y.scale,d=[o.scale[0]*o.baseScale[0],o.scale[1]*o.baseScale[1]],u.data("transform",o),s&&!c?(o.origin[0]===y.origin[0]&&o.origin[1]===y.origin[1]||(g[e+"transform-origin"]=100*o.origin[0]+"% "+100*o.origin[1]+"%"),g[e+"transform"]="translate("+(o.origo[0]+o.position[0])+"px,"+(o.origo[1]+o.position[1])+"px)"+(1===d[0]&&1===d[1]?"":" scale("+d[0]+","+d[1]+")")+(o.rotate?" rotate("+o.rotate+"deg)":""),p?(g[e+"transition-property"]=e+"transform"+(void 0!==o.opacity?", opacity":""),g[e+"transition-duration"]=p+"ms",f&&(g[e+"transition-timing-function"]=f),typeof l===n&&(u.one(i,h),setTimeout(h,p+50)),u.css(g)):(g[e+"transition"]="none",u.css(g),typeof l===n&&setTimeout(function(){l.call(u[0])},50))):(g.left=o.origo[0]+o.position[0],g.top=o.origo[1]+o.position[1],o.hasOwnProperty("size")?(g.width=o.size[0],g.height=o.size[1]):(g.width=o.baseSize[0]*d[0],g.height=o.baseSize[1]*d[1],g.left-=(g.width-o.baseSize[0])*o.origin[0],g.top-=(g.height-o.baseSize[1])*o.origin[1]),p?u.animate(g,{duration:p,easing:f,complete:l}):(u.css(g),typeof l===n&&setTimeout(function(){l.call(u[0])},50))),this}}(jQuery,document);
!function(e,t,o,n){"use strict";e.fn.swipe=function(n){n=e.extend({onSwipedLeft:!1,onSwipedRight:!1,onSwipedUp:!1,onSwipedDown:!1,onSmallSwipe:!1,onSwipeStart:!1,onClick:!1,onDoubleClick:!1,onFinished:!1,threshold:20,clickThreshold:150,doubleClickThreshold:200,noSwipeInside:".caption",swipeoutSpeed:300,overThreshold:.25},n);var i=function(e){return[e.outerWidth(),e.outerHeight()]},a=function(e){return e.touches&&1===e.touches.length?[Math.round(e.touches[0].pageX),Math.round(e.touches[0].pageY)]:null!==e.clientX?[Math.round(e.pageX),Math.round(e.pageY)]:null};return this.each(function(){var r,l,u,s,p,c,d,h,f,w=e(this),g=w.parent(),T=w.data("lsw_ns")||"lsw_"+Math.floor(1e4*Math.random()),m=!0,S=!0,N=!0,C=!0,v=!1,y=!0,U=!1,D=null,O=(w.hasClass("audio")||w.hasClass("video"),function(e){clearTimeout(null),typeof n.onFinished===FUNCTION&&n.onFinished.call(w[0],e)}),I=function(e){E(e),typeof n.onClick===FUNCTION&&n.onClick.call(w[0],e)},M=function(e){S||(E(e),S=!0,n.onSwipedRight.call(w[0],e))},b=function(e){S||(E(e),S=!0,n.onSwipedLeft.call(w[0],e))},E=function(e){"mouseup"===e.type||"mouseout"===e.type?(w.off("mouseup."+T+" mouseout."+T),o.off("mousemove."+T)):e.type===TOUCH.END&&w.off(TOUCH.END+"."+T)},F=function(e,t,o,n){var i={};Array.isArray(e)||(e=[e,h[1]]),i.transform=f+e[0]+","+e[1]+")",typeof o!==UNDEF&&o?(i.transition="transform "+o+"ms ease-out",null!==t&&(i.transition+=",opacity "+o+"ms ease-out",i.opacity=t)):i.transition="none",typeof n===FUNCTION&&w.one("transitionend",n),w.css(i)},k=function(e){return!!(m||y||e.originalEvent.touches&&e.originalEvent.touches.length>1)||(e.preventDefault(),d=a(e.originalEvent),d[0]-=c[0],d[1]-=c[1],N&&C?d[1]=0:(v&&Math.abs(d[0])<100&&Math.abs(d[0])>15&&Math.abs(d[0]/d[1])>.667&&(N=C=!0),N?d[1]=Math.max(0,d[1]):C&&(d[1]=Math.min(0,d[1]))),F([h[0]+d[0],h[1]+d[1]]),!1)},A=function(e){if(y)return!0;if(e.preventDefault(),D&&(clearTimeout(D),D=null),m=!0,(p=(new Date).getTime())-s>50&&function(e){return Array.isArray(e)?Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)):Math.abs(e)}(d)>n.threshold){var t=1+n.swipeoutSpeed/(p-s);if(w.data({scrolling:!0,swipeEnded:!0,taplength:p-s}),N&&C){var o=h[0]+d[0]*t;l[0]>=r[0]||Math.abs(d[0])>0&&(o-r[0]/2>l[0]*(n.overThreshold-.5)||o+r[0]/2<l[0]*(.5-n.overThreshold))?(F(o,0,n.swipeoutSpeed,O),d[0]>0?M(e):b(e)):(F(o,null,n.swipeoutSpeed),E(e))}else{var i=Math.abs(d[1])>1.5*Math.abs(d[0]);o=[h[0]+d[0]*t,h[1]+d[1]*t],i&&r[1]>l[1]&&(d[1]>0&&o[1]-r[1]/2<=l[1]*(n.overThreshold-.5)||d[1]<0&&o[1]+r[1]/2>=l[1]*(.5-n.overThreshold))||!i&&r[0]>l[0]&&(d[0]>0&&o[0]-r[0]/2<=l[0]*(n.overThreshold-.5)||d[0]<0&&o[0]+r[0]/2>=l[0]*(.5-n.overThreshold))?(F(o,null,n.swipeoutSpeed),E(e)):typeof n.onSwipedDown===FUNCTION&&i&&d[1]>0?(o[0]=h[0],F(o,0,n.swipeoutSpeed,O),function(e){S||(E(e),S=!0,n.onSwipedDown.call(w[0],e))}(e)):typeof n.onSwipedUp===FUNCTION&&i&&d[1]<0?(o[0]=h[0],F(o,0,n.swipeoutSpeed,O),function(e){S||(E(e),S=!0,n.onSwipedUp.call(w[0],e))}(e)):(F(o,0,n.swipeoutSpeed,O),d[0]>0?M(e):b(e))}U=!1}else d[0]||d[1]?(!function(e){E(e),typeof n.onSmallSwipe===FUNCTION&&n.onSmallSwipe.call(w[0],e)}(e),F(h,null,100),U=!1):n.onDoubleClick?U?((new Date).getTime()-p<n.doubleClickThreshold?function(e){E(e),typeof n.onDoubleClick===FUNCTION&&n.onDoubleClick.call(w[0],e)}(e):I(e),U=!1):(U=!0,D=setTimeout(function(e){I(e),U=!1},n.doubleClickThreshold+10,e)):I(e);return!1};w.add(o).off("."+T),w.data("lsw_ns",T),t.on("resize."+T,function(){clearTimeout(u),u=setTimeout(function(){l=i(g)},50)}),w.attr("draggable","false").on(TOUCH.START+"."+T+" dragstart."+T+" mousedown."+T,function(t){if(U)return!1;if("touchstart"!==t.type&&t.preventDefault(),"mousedown"===t.type&&1!==t.which)return function(e){E(e),typeof n.onRightClick===FUNCTION&&n.onRightClick.call(w[0],e)}(t),!0;if(pageZoomed()||t.originalEvent.touches&&t.originalEvent.touches.length>1||n.noSwipeInside&&e(t.target).closest(n.noSwipeInside).length||"A"===t.target.nodeName||"INPUT"===t.target.nodeName||"BUTTON"===t.target.nodeName||"AUDIO"===t.target.nodeName||"VIDEO"===t.target.nodeName&&t.target.controls&&(ISIOSDEVICE||t.offsetY>e(t.target).height()-60))return y=!0,!0;y=!1,m=!1,U=!1,w.data({scrolling:!0,swipeEnded:!1,taplength:0}),s=(new Date).getTime(),c=a(t.originalEvent),l=i(g),r=i(w),(v=l[1]>=r[1])?(N=typeof n.onSwipedUp!==FUNCTION,C=typeof n.onSwipedDown!==FUNCTION):N=C=!1,d=[0,0];var u=w.getMatrix();return h=[u[4],u[5]],f="matrix("+u.slice(0,4).join(",")+",",function(e){"mousedown"===e.type?(w.on("mouseup."+T+" mouseout."+T,A),o.on("mousemove."+T,k)):e.type===TOUCH.START&&w.on(TOUCH.END+"."+T,A),U=!1}(t),function(e){typeof n.onSwipeStart===FUNCTION&&n.onSwipeStart.call(w[0],e)}(t),S=!1,"touchstart"===t.type}).on(TOUCH.MOVE+"."+T+" drag."+T,k).on("removeSwipe."+T,function(){setTimeout(function(){w.data("scrolling",!1)},20),w.removeAttr("draggable"),w.add(o).off("."+T)}).on("selectstart."+T,function(e){return e.preventDefault(),!1})})}}(jQuery,jQuery(window),jQuery(document));
!function(t,a,n,o){"use strict";t.fn.autopano=function(o){o=t.extend({},t.fn.autopano.defaults,o);var e,r,u,s=t(this),i=s.parent(),l=!1,f=!1,d=!1,c=!1,p=s.data("lap_ns"),m=function(){s.data("transform");var t=s.outerWidth(),a=s.outerHeight(),n=i.outerWidth(),o=i.outerHeight();t/n<a/o?(e=a,r=o,c||(c=!0,s.translateX(0),e>r&&g())):(e=t,r=n,c&&(c=!1,s.translateY(0),e>r&&g()))},v=function(){y(),setTimeout(function(){s.data("scrolling",!1)},20),s.removeAttr("draggable"),s.add(n).off("."+p)},h=function(){var t=(e-r)/2,a=1e3*Math.minMax(1.5,Math.abs(t)/o.speed,20);c?s.translateY(t,a,o.easing,function(){l=!0,d||(!f||o.loop?M():b())}):s.translateX(t,a,o.easing,function(){l=!0,d||(!f||o.loop?M():b())})},M=function(){var t=(e-r)/2,a=1e3*Math.minMax(1.5,Math.abs(t)/o.speed,20);c?s.translateY(-t,a,o.easing,function(){f=!0,d||(!l||o.loop?h():b())}):s.translateX(-t,a,o.easing,function(){f=!0,d||(!l||o.loop?h():b())})},g=function(){var t=c?s.translateY():s.translateX();d=!1,(-o.direction||t)>0?h():M(),i.addClass(o.panoMoveClass),i.data("panomove",!0)},y=function(){var t=c?s.translateY():s.translateX();d=!0,t&&(c?s.translateY(t):s.translateX(t)),i.removeClass(o.panoMoveClass)},b=function(){y(),setTimeout(function(){i.data("panomove",!1)},300)};return p&&(a.add(n).off("."+p),s.translate([0,0])),s.data("lap_ns",p="lap_"+Math.floor(1e4*Math.random())),a.on("resize."+p,function(){return clearTimeout(u),u=setTimeout(m,50),!0}),m(),s.on("autopanoRemove."+p,function(){return d=!0,v(),!1}).on("autopanoStart",function(){return d=!1,g(),!1}).on("autopanoStop",function(){return d=!0,b(),!1}),o.autoStart&&g(),o.hasOwnProperty("onReady")&&typeof o.onReady===FUNCTION&&o.onReady(thumb),this},t.fn.autopano.defaults={direction:-1,speed:80,easing:"cubic-bezier(0.2, 0, 0.8, 1)",autoStart:!0,loop:!0,panoMoveClass:"pano-move"}}(jQuery,jQuery(window),jQuery(document),jQuery("body"));
!function(e){"use strict";e.fn.audioPlayer=function(t){e(this).data("audioplayer")&&(t=e.extend({},t,e(this).data("audioplayer"))),(t=e.extend({},e.fn.audioPlayer.defaults,t)).hasOwnProperty("rootPath")&&"."!==t.rootPath||(t.rootPath="");const o="lap_ns",a=(t.rootPath?t.rootPath+"/":"")+t.folder+"/",n="paused";return this.each(function(){let r,s,l,u=e(this),i=e(),p=e(),c=e(),d=e(),f=e(),m=0,v=t.volume,h=!1,y=function(t){if(typeof t!==UNDEF&&typeof t!==e.event||(t=m),f.attr("src")&&t===m){if(!d[0].paused)return}else!function(e){d[0].pause(),(e>=r.length||e<0)&&(e%=r.length),f.attr({src:a+r[e]}),d[0].load(),m=e,c.children().removeClass("active"),c.children().eq(e).addClass("active")}(t);(s=d[0].play())&&s.then(function(){u.addClass("active"),u.data(n,!1)},function(e){u.removeClass("active"),u.data(n,!0),console.log("Autoplay has been prevented by the browser. Interact with the page first!")})},T=function(){clearTimeout(l);let e=d[0].volume;if("number"==typeof e||"number"==typeof(e=parseFloat(e))){if((e=Math.min(e+t.step,1))>=v)return d[0].volume=v,void setTimeout(function(){h=!1},50);d[0].volume=e,l=setTimeout(T,t.stepFreq)}},P=function(){d[0].paused&&(d[0].volume=.01,y()),h=!0,l=setTimeout(T,t.stepFreq),u.data(n,!1)},g=function(){clearTimeout(l);let e=d[0].volume;if("number"==typeof e||"number"==typeof(e=parseFloat(e))){if((e=Math.max(e-t.step,0))<.01)return d[0].volume=0,C(),void setTimeout(function(){h=!1},50);d[0].volume=e,l=setTimeout(g,t.stepFreq)}},k=function(){d[0].paused||(h=!0,l=setTimeout(g,t.stepFreq)),u.data(n,!0)},F=function(){m>=r.length-1?t.loop&&y(0):y(m+1)},C=function(){d[0].pause(),s=null,u.removeClass("active"),u.data(n,!0)},w=function(){e.cookie&&e.cookie("ap-status",(d[0].paused?"0":"1")+"::"+(d[0].currentTime||0)+"::"+(h||d[0].paused?v:d[0].volume)+(m?"::"+m:""))};if(i=e("#"+u.data("rel")),u.data("src"))r=u.data("src").split("::");else{if(!t.hasOwnProperty("src"))return;r="string"==typeof t.src?t.src.split("::"):t.src}t.saveStatus&&function(){if(e.cookie){let o=e.cookie("ap-status");o&&(o=o.split("::"),t.autoPlay="1"===o[0],t.startTime=parseFloat(o[1]||0,10),v=t.volume=parseFloat(o[2])||.2,((m=parseInt(o[3]||0,10))<0||m>r.length)&&(m=0))}}(),function(){if(p=e("<div>",{class:t.playerHook}),(d=e("<audio>",{preload:"auto",controls:!0,controlsList:"nofullscreen nodownload noremote"}).appendTo(p))[0].pause(),u.data(n,!0),f=e("<source>",{src:a+r[m]}).appendTo(d),setTimeout(function(){d.on("ended."+o,function(){return F(),!0}),d.on("pause."+o,function(){u.data(n,!0),u.removeClass("active")}),d.on("playing."+o,function(){u.data(n,!1),0===d[0].volume&&(d[0].volume=v||t.volume),u.addClass("active")}),d.on("volumechange."+o,function(){h||(clearTimeout(l),v=d[0].volume)})},100),r.length){c=e("<ul>",{class:t.playListHook}).appendTo(p);for(var s=0;s<r.length;s++)c.append(e("<li>").append(e("<a>",{text:decodeURIComponent(r[s].replace(/\.[^\.]*$/,""))}).on("click."+o,function(t){var o=c.children().index(e(t.target).parent());return y(o),!1})));c.children().eq(m).addClass("active")}}(),i.length?i.append(p):u.addTooltip(p,{pos:t.pos}),u.on("click."+o,function(){return!(!i.length||i.is(":hidden"))||(u.data(n)?P():k(),!1)}),u.on("removePlayer."+o,function(){p.trigger("removeTooltip"),p.add(u).off("."+o),p.remove()}),u.on("pausePlayer."+o,C),u.on("startPlayer."+o,y),u.on("fadeInPlayer."+o,P),u.on("fadeOutPlayer."+o,k),setTimeout(function(){d[0].volume=t.volume,t.hasOwnProperty("startTime")&&(d[0].currentTime=t.startTime),t.autoPlay&&P(),e(window).on("unload."+o,w)},50)})},e.fn.audioPlayer.defaults={autoPlay:!0,loop:!0,volume:.2,stepFreq:30,step:.02,saveStatus:!0,playerHook:"player",playListHook:"play-list",folder:"res",rootPath:"",pos:[1,2,1,0]}}(jQuery);
!function(e,t,o,a,n){"use strict";e.fn.lightbox=function(n,s){if(typeof n===UNDEF)return this;s=e.extend({},e.fn.lightbox.defaults,s);var i,l,r,d,c,u,p,h,m,f,g,b,C,v,w,T,y,x,P,S,O,k,A,I,M,D,F=e(this),E=getTranslations(e.fn.lightbox.text),L=e([]),N=e(),V=e(),R=e(),B=e(),z=e(),U=e(),H=e(),G=e(),q=e(),Z=!0,W=!1,j=!1,X=!1,K=!1,_=!1,Y=!1,Q=!1,$=!1,ee=null,te=!1,oe=null,ae=null,ne=null,se=null,ie=null,le=!1,re=s.maxZoom*PIXELRATIO,de=s.zoomed,ce=s.thumbsVisible,ue=s.captionVisible,pe=-1,he=0,me=0,fe=s.fitPadding,ge=F.data("llb_ns"),be=!!s.hasOwnProperty("extraSizes")&&s.extraSizes.split(/,\s*/),Ce=e("[data-audioplayer]"),ve=Ce.length&&!Ce.data("paused"),we=function(){var e=0;return"screen"!==s.fitBetween&&(e+=s.thumbsVisible&&L.length>1&&m&&m.length?m.outerHeight():0,"all"===s.fitBetween&&(e+=G.outerHeight())),e},Te=function(){return"screen"!==s.fitBetween&&c.hasClass(s.captionVisibleClass)&&U&&U.length?U.outerHeight():0},ye=function(){return G.outerHeight()},xe=function(){s.useZoom&&s.zoomSlider?(de=!0,Ae(l=l>50?0:100)):de=!de,Fe(!0)},Pe=function(e){l=e,Ae(e),Fe(!0)},Se=function(e){var t=s.zoomSlider?ke():l;t<100&&(t=Math.min(100,t+(typeof e!==UNDEF?e:25))),Pe(t)},Oe=function(e){var t=s.zoomSlider?ke():l;t>0&&(t=Math.max(0,t-(typeof e!==UNDEF?e:25))),Pe(t)},ke=function(){return parseInt(T.val())},Ae=function(e){T.val(e)},Ie=function(e,t){s.zoomSlider?e||t?(c.addClass("show-zoom-level"),0===l?C.removeClass("icon-zoom-out icon-zoom-level").addClass("icon-zoom-in"):100===l?C.removeClass("icon-zoom-in icon-zoom-level").addClass("icon-zoom-out"):C.removeClass("icon-zoom-in icon-zoom-out").addClass("icon-zoom-level")):c.removeClass("show-zoom-level"):(c.toggleClass("show-zoom-out",t),c.toggleClass("show-zoom-in",e&&!t))},Me=function(e){M.html(e>=1e3?Math.round(e/1e3)+"s":e+"ms")},De=function(){var e=[c.width(),c.height()];return[e[0]-2*fe,e[1]-Math.max(we(),fe)-Math.max(Te(),fe)]},Fe=function(e,t){if(V&&V.length){var o,a,i=L.eq(pe).data(J.OBJ),r=[c.width(),c.height()],u=n.getDimensions(i),p=n.getMaxDimensions(i),h=function(e){return Math.max((r[0]-2*fe-2*d)/e[0],(r[1]-Math.max(o,fe)-Math.max(a,fe)-2*d)/e[1])},m=function(e){return Math.min((r[0]-2*fe-2*d)/e[0],(r[1]-Math.max(o,fe)-Math.max(a,fe)-2*d)/e[1])};if(typeof d===UNDEF&&(d=parseInt(V.css("paddingTop"))),typeof fe===UNDEF&&(fe=s.hasOwnProperty("fitRatio")?Math.round((1-s.fitRatio)*Math.min(r[0],r[1])/2):0),typeof l!==UNDEF&&null!==l||(l=de?0:100,s.useZoom&&s.zoomSlider&&Ae(l)),_||X||K||j&&B.hasClass("default")){o=we(),a=Te();var f=r[0]-2*fe,g=r[1]-Math.max(o,fe)-Math.max(a,fe),b=fe,C=Math.max(o,fe);K||j?u[0]<f&&u[1]<g&&(b+=Math.round((f-u[0])/2),C+=Math.round((g-u[1])/2),f=u[0],g=u[1]):X&&(C+=ye(),g-=ye()),V.css({transition:"none",left:b,top:C,width:f,height:g}).show(),s.useZoom&&Ie(!1,!1)}else{var v,w,T,y,x,P=[0,0];if(o=we(),a=Te(),v=Math.min(1,m(u)),w=W||j?Math.min(re,m(u)):p?Math.max(re,Math.min(p[0]/u[0],p[1]/u[1])):Math.min(re,m(u)),v>w){var S=v;v=w,w=S}if(s.useZoom&&s.zoomSlider?V.data("inited")?T=v+l*(w-v)/100:(T=Q?Math.min(re,h(u)):s.zoomed?Math.min(re,m(u)):1,l=100*Math.minMax(0,(T-v)/(w-v),1),Ae(l),V.data("inited",!0)):T=Q?Math.min(re,de?h(u):m(u)):de?Math.min(Math.max(re,w),m(u)):1,y=[u[0]*T,u[1]*T],x=Q&&(y[0]>r[0]||y[1]>r[1])||s.autoPano&&(u[0]/u[1]>2||u[0]/u[1]<.5625)&&(y[0]/r[0]>=s.panoramaAutoDetect||y[1]/r[1]>=s.panoramaAutoDetect),Z&&(p[0]>u[0]||p[1]>u[1])&&(y[0]>u[0]||y[1]>u[1])&&(!V.data("lastDims")||V.data("lastDims")[0]<y[0])&&(V.children("img").eq(0).attr("src",n.getOptimalImagePath(i,y,s.displayOriginals)),V.data("lastDims",y)),y=[y[0]+2*d,y[1]+2*d],e&&(typeof t===FUNCTION&&V.on("transitionEnd",function(){t.call(null)}),!s.zoomSlider||l>0)){var O,k;((O=V.getTranslate())[0]||O[1])&&(y[0]>r[0]&&(P[0]=O[0]*y[0]/V.width(),(k=P[0]+(r[0]-y[0])/2)>.25*r[0]?P[0]=y[0]/2-r[0]/4:k+y[0]<.75*r[0]&&(P[0]=r[0]/4+1.5*y[0]),P[0]=Math.round(P[0])),y[1]>r[1]&&(P[1]=O[1]*y[1]/V.height(),(k=P[1]+(r[1]-y[1])/2)>.25*r[1]?P[1]=y[1]/2-r[1]/4:k+y[1]<.75*r[1]&&(P[1]=r[1]/4+1.5*y[1]),P[1]=Math.round(P[1])))}Z&&(x?V.data("hasAutoPano")?V.data("panomove")&&(V.trigger("autopanoStop"),se=setTimeout(function(){V.trigger("autopanoAdjust")},550)):(y[0]/y[1]>r[0]/r[1]?P[0]-=s.autoPanoStart*(y[0]-r[0])/2:P[1]-=s.autoPanoStart*(y[1]-r[1])/2,se=setTimeout(function(){V.autopano({direction:-s.autoPanoStart||me,speed:s.autoPanoSpeed})},550)):(clearTimeout(se),se=null,V.trigger("autopanoStop"))),V.css({transition:e?"transform "+s.transitionProps+", left "+s.transitionProps+", top "+s.transitionProps+", width "+s.transitionProps+", height "+s.transitionProps:"none",transform:"translate("+P[0]+"px,"+P[1]+"px)",left:Math.round((r[0]-y[0])/2),top:Math.round(Math.max(fe,o)+(r[1]-Math.max(o,fe)-Math.max(a,fe)-y[1])/2),width:Math.round(y[0]),height:Math.round(y[1])}).show(),s.useZoom&&Ie(T<w,T>v)}e||typeof t!==FUNCTION||t.call(null)}},Ee=function(){var e=c.find("."+s.regionsClass);return e.length&&(s.regionsVisible=!s.regionsVisible,e.is(":visible")?e.fadeOut():e.fadeIn()),!1},Je=function(){R.length&&(R.remove(),R=e())},Le=function(){switch(s.transitionType){case"crossFadeAndSlide":var t=(o=V.getMatrix())[4];me?(o[4]+=100*me,V.css({transition:"none",opacity:0,transform:"matrix("+o.join(",")+")"})):V.css({transition:"none",opacity:0}),window.requestAnimationFrame(function(){if(R.length)if(R.data("swiped"))setTimeout(Je,s.speed/2);else{var e=R.getMatrix();e[4]-=100*me,R.one("transitionend",Je).css({transition:"transform "+s.speed/2+"ms ease-out, opacity "+s.speed/2+"ms ease-out",transform:"matrix("+e.join(",")+")",opacity:0})}V.one("transitionend",function(){window.requestAnimationFrame(Ne)}),me?(o[4]=t,V.css({transition:"transform "+s.speed+"ms ease-out, opacity "+s.speed+"ms ease-out",transform:"matrix("+o.join(",")+")",opacity:1})):V.css({transition:"transform "+s.speed+"ms ease-out, opacity "+s.speed+"ms ease-out",opacity:1})});break;case"crossFadeAndZoom":var o=V.getMatrix(),a=o[0],n=o[3];me?(o[0]*=1-me/40,o[3]*=1-me/40,V.css({transition:"none",opacity:0,transform:"matrix("+o.join(",")+")"})):V.css({transition:"none",opacity:0}),window.requestAnimationFrame(function(){if(R.length)if(R.data("swiped"))setTimeout(Je,s.speed/2);else{var t=R.getMatrix();t[0]*=1+me/20,t[3]*=1+me/20,R.one("transitionend",function(){R.remove(),R=e()}).css({transition:"transform "+s.speed/2+"ms ease-out, opacity "+s.speed/2+"ms ease-out",transform:"matrix("+t.join(",")+")",opacity:0})}V.one("transitionend",function(){window.requestAnimationFrame(Ne)}),me?(o[0]=a,o[3]=n,V.css({transition:"transform "+s.speed+"ms ease-out, opacity "+s.speed+"ms ease-out",transform:"matrix("+o.join(",")+")",opacity:1})):V.css({transition:"transform "+s.speed+"ms ease-out, opacity "+s.speed+"ms ease-out",opacity:1})});break;default:V.css({transition:"none",opacity:0}),window.requestAnimationFrame(function(){R.length&&(R.data("swiped")?setTimeout(Je,s.speed/2):R.on("transitionend",function(){R.remove(),R=e()}).css({transition:"opacity "+s.speed/2+"ms ease-out",opacity:0})),V.one("transitionend",function(){window.requestAnimationFrame(Ne)}).css({transition:"opacity "+s.speed+"ms ease-out",opacity:1})})}},Ne=function(){!1!==s.onLoadEnd&&s.onLoadEnd(N),s.preloadNext&&function(){var e;me<0&&pe>0?e=L.eq(pe-1).data(J.OBJ):pe<L.length-2&&(e=L.eq(pe+1).data(J.OBJ)),e&&"image"===e[J.CATEGORY]&&((new Image).src=n.getOptimalImagePath(e,De(),s.displayOriginals))}()},Ve=function(){if(!(--he>0)){if(p.hide(),DEBUG){var t=new Date;K||_?console.log((K?"External content":"360 player")+" loaded: "+(t-r)+"ms"):B.length&&(console.log((W||j?"Media":"Image")+" ["+pe+"] loaded: "+(t-r)+'ms src="'+B[0].src+'"'),typeof B[0]!==UNDEF&&typeof z[0]!==UNDEF||console.log((B[0],UNDEF,"loadImage.done("+B[0].src+")")))}(Z||W||j)&&s.rightClickProtect&&z.on("contextmenu",function(e){return e.preventDefault(),!1}),(W||j)&&(z.attr({autoplay:s.videoAuto,loop:s.videoLoop}),z[0].volume=s.volume,z.on("volumechange."+ge,function(){s.volume=this.volume})),H.length&&(H.find(".buttons a").trigger("removeTooltip"),H.length>1&&(H.eq(-1).prevAll("."+s.lightboxCaptionClass).remove(),H=c.find("."+s.lightboxCaptionClass)),c.hasClass(s.captionVisibleClass)?H.one("transitionend",function(){H.remove(),H=e()}).css({transition:"opacity "+s.speed/2+"ms ease-out",opacity:0}):H.remove()),_||Y||K&&V.children("iframe").length||V.swipe({onSwipeStart:function(){e(this).trigger("autopanoStop"),e(this).hideAllTooltips()},onSwipedLeft:function(){V.data("swiped",!0),pt()},onSwipedRight:function(){V.data("swiped",!0),ut()},onSwipedDown:function(){ze()},onFinished:function(){$||(e(this).trigger("removeSwipe"),e(this).remove())},onClick:function(t){c.data("panomove")?(t.preventDefault(),e(this).trigger("autopanoStop")):function(t){var o="touch"===e("html").data("whatinput")||"touchend"===t.type;if(W||j){var a=z[0];return a.paused?(a.play(),"ms"!==VEND&&(a.controls=!1),o&&(at(),c.hasClass(s.thumbsVisibleClass)&&lt(),c.hasClass(s.captionVisibleClass)&&dt())):(a.pause(),"ms"!==VEND&&(a.controls=!0),o&&("togglecontrols"===s.clickAction?at():"toggleall"===s.clickAction&&ct())),!1}Z&&("nextimage"===s.clickAction?(getCoords(t).x-V.position().left>V.width()/2?pt():ut(),o&&tt()):"togglecontrols"===s.clickAction?at():"toggleall"===s.clickAction&&ct())}(t)},onRightClick:function(e){Ze(!0)},onDoubleClick:s.useZoom&&s.doubleClickZoom?function(){s.zoomSlider?l<100?Se(50):Pe(0):xe()}:null}),Fe(!1),W&&s.videoAuto&&z[0].paused&&playVideo(z[0]),Le(),ee?(j||W)&&s.videoAuto?(We(),z[0].onended=function(){qe()}):(clearTimeout(ee),ee=setTimeout(pt,s.slideshowDelay),I&&(I.show(),function(e){var t=20/s.slideshowDelay,o=function(e){I.css("width",100*e+"%"),e<1&&(e=Math.min(1,e+t),ie=setTimeout(o,20,e))};clearTimeout(ie),ie=setTimeout(o,20,0)}())):s.autohideControls&&ot()}},Re=function(e){(e=e||V).one("transitionend",function(){e.data("swiped",!1)}).css({transition:"opacity "+2*s.speed+"ms ease-out, transform "+2*s.speed+"ms ease-out",opacity:1,transform:"translateX(0)"})},Be=function(o){if("number"!=typeof o&&(o=L.index(o)),o<0||o>=L.length)if($=!0,o<0)switch(s.afterLast){case"donothing":o=0,V.data("swiped")&&Re();break;case"startover":o=L.length-1;break;case"onelevelup":s.level&&(window.location.href="../"+s.indexName),o=0;break;case"nextfolder":s.baseSet&&s.previousFoldersLast?window.location.href=s.previousFoldersLast:(o=0,V.data("swiped")&&Re());break;case"nextindex":s.baseSet&&s.previousFolderPath?window.location.href=s.previousFolderPath:(o=0,V.data("swiped")&&Re());break;default:o=0,ze()}else switch(s.afterLast){case"donothing":o=L.length-1,Ze(),V.data("swiped")&&Re();break;case"startover":o=0;break;case"onelevelup":s.level&&(window.location.href="../"+s.indexName),o=L.length-1,Ze();break;case"nextfolder":s.baseSet&&s.nextFoldersFirst?window.location.href=s.nextFoldersFirst+(ee?"&slideshow":""):(o=L.length-1,Ze(),V.data("swiped")&&Re());break;case"nextindex":s.baseSet&&s.nextFolderPath?window.location.href=s.nextFolderPath:(o=L.length-1,Ze(),V.data("swiped")&&Re());break;case"ask":var l=Ze(),d=new Array;return V.data("swiped")&&Re(),o=L.length-1,L.length>1&&d.push({t:E.startOver,c:"icon-loop",h:function(e){Be(0)}}),s.level&&d.push({t:s.level?E.upOneLevel:s.homepageLinkText||E.backToHome,c:"icon-one-level-up",h:function(){window.location.href="../"+s.indexName}}),d.push({t:E.backToIndex,c:"icon-arrow-up",h:function(){ze()}}),s.baseSet&&(s.nextFoldersFirst&&d.push({t:E.nextFolder,c:"icon-arrow-right",h:function(){window.location.href=s.nextFoldersFirst+(l?"&slideshow":"")}}),s.nextFolderPath&&d.push({t:E.nextIndex,c:"icon-thumbnails",h:function(){window.location.href=s.nextFolderPath}})),void c.modal(e("<p>",{class:"text-center",text:E.atLastPageQuestion}),d,{onClose:function(){Be(L.length-1)},class:"secondary",icon:"info",title:E.atLastPage});default:o=ee?0:L.length-1,Ze(),ze(L[0])}else $=!1;if(c.is(":visible")){if(me=Math.abs(o-pe)>=L.length-1&&"startover"===s.afterLast?1:pe>o?-1:pe<o?1:0,pe===o)return;V.hideAllTooltips(),s.autoHideControls&&ot()}else le=!0,a.add(e("html")).css("overflow","hidden"),a.addClass(s.lightboxOnClass),me=0,s.lightboxFullscreen&&requestFullscreen(function(){c.addClass("fullscreen")}),s.useRating&&function(e){pe>=0&&(typeof e===UNDEF&&(e=L.eq(pe).data(J.OBJ)[J.VISITORRATING]||0),c.find("."+s.lightboxCaptionClass+" .ratingbox span").removeClass("r0 r1 r2 r3 r4 r5").addClass("r"+e))}(),c.show(),ve=Ce.length&&!Ce.data("paused"),s.autoStart&&Ge(),mt(ft);c.find(".modal").trigger("destroy");var u;pe=o,N=L.eq(pe),u=N.data(J.OBJ),s.useThumbstrip&&L.length>1&&ht(),u?(p.show(),I&&(clearTimeout(ie),I.hide()),function(e){if(W=j=X=Z=_=Y=!1,K=e.hasOwnProperty(J.EXTERNAL),_=!K&&s.use360Player&&(e.hasOwnProperty(J.PROJECTIONTYPE)&&"equirectangular"===e[J.PROJECTIONTYPE]||"video"===e[J.CATEGORY]&&e.hasOwnProperty(J.PANORAMA)&&e[J.PANORAMA]),Q=Z&&(e.hasOwnProperty(J.PANORAMA)&&e[J.PANORAMA]||s.autoPano&&(e[J.IMAGE][J.WIDTH]>c.width()||e[J.IMAGE][J.HEIGHT]>c.height())&&(e[J.IMAGE][J.WIDTH]/e[J.IMAGE][J.HEIGHT]>2.4||e[J.IMAGE][J.HEIGHT]/e[J.IMAGE][J.WIDTH]>2)),!K&&!_)switch(e[J.CATEGORY]){case"video":W=!0;break;case"audio":j=!0;break;case"other":X=!0,Y="pdf"===n.getExtension(e).toLowerCase();break;default:Z=!0}}(u),setTimeout(function(){if(R=c.find("."+s.lightboxMainClass),H=c.find("."+s.lightboxCaptionClass),R.length&&(R.trigger("autopanoRemove").off("."+ge),s.muteBackgroundAudio&&ve&&(j||W?Ce.trigger("fadeOutPlayer"):Ce.trigger("fadeInPlayer")),et(R)),he=1,r=new Date,V=e("<div>",{class:"lightbox-main "+(K?"external":_?"vr":Y?"pdf":u[J.CATEGORY])}).hide().appendTo(c),(s.hasOwnProperty("shop")&&n.hasShop(u)||s.hasOwnProperty("feedback")&&s.showFeedback)&&(V.append(e("<a>",{class:s.checkboxClass+(N.hasClass(s.selectedClass)?" "+s.checkmarkClass:"")}).on("click",function(){return e(this).toggleClass(s.checkmarkClass),N.trigger("toggleCard"),!1})),s.hasOwnProperty("shop")&&n.hasShop(u)?V.append(e("<a>",{class:"icon-shopping-cart-add add-cart-btn"}).addTooltip(E.addCart,{pos:[0,1,2,1]}).on("click",function(e){return ee&&(We(),s.shop.root.trigger("onClose",function(){te&&qe(),s.shop.root.trigger("onClose",null)})),s.shop.root.trigger("addItems",u),!1})):V.append(e("<a>",{class:"icon-email-send add-cart-btn",text:" "+s.feedbackAddBtnLabel}).on("click",function(e){return ee&&(We(),s.feedback.root.trigger("onClose",function(){te&&qe(),s.feedback.root.trigger("onClose",null)})),s.feedback.root.trigger("addItems",u),!1}))),_){var o=Math.round(c.width()*s.fitRatio),a=Math.round(c.height()*s.fitRatio);V.css({width:o,height:a}).attr("id","vr"+pe).addClass("vr").show().one("DOMReady",Ve),typeof PhotoSphereViewer!==UNDEF?setTimeout(function(){var e,t={container:V[0]};"video"===u[J.CATEGORY]?(t.panorama=n.getVideoPath(u),t.adapter=PhotoSphereViewer.EquirectangularVideoAdapter,t.plugins=[PhotoSphereViewer.VideoPlugin,{}],t.navbar=["zoom","fullscreen"]):(t.panorama=n.getAbsoluteImagePath(u),t.navbar=["autorotate","zoom","fullscreen"],s.autoPano&&(t.autorotateDelay=1e3,t.autorotateSpeed="-2rpm")),(e=u.gpano)&&(e.fov&&(t.defaultZoomLvl=e.fov),t.sphereCorrection={pan:e.pan||0,tilt:e.tilt||0,roll:e.roll||0}),new PhotoSphereViewer.Viewer(t)},s.speed):console.log('Fatal Error: Missing "photo-sphere-viewer.min.js"!'),setTimeout(Ve,200)}else if(Z)z=B=e("<img>").appendTo(V),DEBUG&&console.log("Loading image ["+pe+'] src="'+n.getOptimalImagePath(u,De(),s.displayOriginals)+'"'),B[0].complete&&B[0].naturalWidth>0?Ve():B.one("load."+ge,function(e){Ve()}),B[0].src=n.getOptimalImagePath(u,De(),s.displayOriginals);else if(j||W){if(W){var l=n.getVideoDuration(u);z=B=e("<video>",{preload:"auto",controlsList:"nodownload",poster:n.getPosterPath(u)}),null===l||l>=2e3?z[0].controls="true":z[0].loop="true"}else{var d=n.getPosterPath(u);he=2,B=e("<img>",{class:"poster"+(d.endsWith("poster.png")?" default":"")}).one("load",function(e){Ve()}).attr("src",d).appendTo(V),z=e("<audio>",{preload:"auto",controls:"true",controlsList:"nofullscreen nodownload"})}z.one("loadedmetadata",function(e){Ve()}).attr("src",n.getSourcePath(u)).appendTo(V),z.on({playing:Ye,pause:Qe,ended:$e}),s.muteBackgroundAudio&&Ce.length&&(ve=!Ce.data("paused"))}else if(K){var p=u[J.EXTERNAL].cont,h=u[J.EXTERNAL].size;h&&(h=h.split("x"),V.data({oWidth:parseInt(h[0]),oHeight:parseInt(h[1])})),V.one("DOMReady",function(e){Ve()}),p.match(/^https?\:\/\//i)||p.match(/\.html?$/i)||p.match(/^\.\.\//)?V.addClass("iframe").append(e("<iframe>",{width:"100%",height:"100%",src:p,frameborder:0,allowfullscreen:"allowfullscreen"})):(p.match(/^<iframe/i)&&V.addClass("iframe"),V.append(p)),setTimeout(Ve,200)}else if(Y&&HASPDFVIEWER)V.append(e("<object>",{type:"application/pdf"}).attr("data",n.getSourcePath(u))),setTimeout(Ve,500);else if(s.useGoogleDocs&&!LOCAL&&".docx.xlsx.txt.pdf".indexOf("."+(u.hasOwnProperty(J.ORIGINAL)?u[J.ORIGINAL][J.PATH]:u[J.NAME]).getExt())>=0){V.addClass("iframe");var m=e("<iframe>",{width:"100%",height:"100%",frameborder:0,allowfullscreen:"allowfullscreen"}).appendTo(V);setTimeout(function(e,t){e.attr("src","https://docs.google.com/viewer?url="+window.location.href.getDir()+n.getSourcePath(t)+"&embedded=true"),setTimeout(Ve,500)},250,m,u)}else V.append(e("<div>",{class:"icon",html:'<a href="'+n.getSourcePath(u)+'" target="_blank"><img class="other" src="'+n.getImagePath(u)+'"></a><p class="icon-external"> '+E.clickToOpen+"</p></div>"})),Ve();!function(o){U=e("<div>",{class:[s.lightboxCaptionClass,"scrollable",ee?" slideshow":"",s.infoPanelAdapt?"adapt-width":"fixed-width"].filter(Boolean).join(" ")});var a,l=e("<div>",{class:"caption"}),r=e("<div>",{class:"buttons"}),d=s.buttonLabels;if(o[J.IMAGECAPTION]&&l.append(o[J.IMAGECAPTION]),K||!o[J.PHOTODATA]||s.metaAsPopup||l.append(e("<div>",{class:"photodata",html:o[J.PHOTODATA]})),l.is(":empty")?U.addClass("no-caption"):(l.find("[data-tooltip]").addTooltip(),U.append(l)),s.useRating){var u=o[J.RATING]||0;if(s.visitorRating||u){var p;(i=e("<div>",{class:"ratingbox"}).appendTo(r)).append(e("<label>",{html:E.rating})),p=e("<span>",{class:"rating",html:STARS}).appendTo(i),s.visitorRating?(o.hasOwnProperty(J.VISITORRATING)?u=o[J.VISITORRATING]:(s.useJalbumRating||(u=0),o[J.VISITORRATING]=u),p.addClass("r"+u+(s.useJalbumRating?"":" icon-close")).on("click."+ge,function(t){var a=e(this),n=Math.minMax(0,Math.floor((getCoords(t).x-a.offset().left-parseFloat(a.css("paddingLeft")))/16),5);return a.removeClass("r0 r1 r2 r3 r4 r5").addClass("r"+n),o[J.VISITORRATING]=n,F.trigger("refreshRating",L[pe]),!1})):p.addClass("r"+u)}}if(!K&&be&&"image"===o[J.CATEGORY]){i=e("<div>",{class:"download icon-download"}).appendTo(r);for(var h=n.getImagePath(o),m=0;m<be.length;m++)i.append(e("<a>",{text:be[m],href:h.replace("slides/","dl/"+be[m]+"/"),download:""}))}if(s.printImage&&"image"===o[J.CATEGORY]&&!s.rightClickProtect&&(i=e("<a>",{class:s.buttonClass+" icon-printer"}).appendTo(r),d?i.html("<span>"+E.print+"</span>").data("tooltip",E.printLabel):i.data("tooltip",E.print),i.on("click",function(e){printImage(o[J.ORIGINAL]&&s.showDownload?n.getOriginalPath(o):n.getImagePath(o),o[J.TITLE]||"",o[J.THUMBCAPTION]||"")})),!K&&s.showDownload){var f;o[J.ORIGINAL]&&(Z||Y||s.allowDownloadOthers)?f=n.getOriginalPath(o):Z&&s.allowDownloadScaled&&(f=n.getImagePath(o)),f&&(i=e("<a>",{class:s.buttonClass+" icon-download download-btn",href:f,html:d?"<span>"+E.download+"</span>":"",download:""}).appendTo(r),getFileSize(f,function(e,t){e&&t&&t.addTooltip(d?niceByte(e):E.download+" ["+niceByte(e)+"]")},i))}(a=s.hasOwnProperty("shop")&&n.hasShop(o)&&s.showShop)&&(l=n.getPriceRange(o),l=E.addCart+(l?" <b>"+l+"</b>":""),(i=e("<a>",{class:s.buttonClass+" icon-shopping-cart-add add-cart-btn"}).on("click",function(e){return ee&&(We(),s.shop.root.trigger("onClose",function(){te&&qe(),s.shop.root.trigger("onClose",null)})),s.shop.root.trigger("addItems",o),!1}).appendTo(r)).html("<span>"+l+"</span>").data("tooltip",E.shopLabel),(i=e("<a>",{class:s.buttonClass+" secondary icon-shopping-cart view-cart-btn"}).on("click",function(e){return s.shop.root.trigger("showCart"),!1}).appendTo(r)).html("<span>"+E.viewCart+"</span>").data("tooltip",E.viewCartLabel));if(s.hasOwnProperty("feedback")&&s.showFeedback&&(i=e("<a>",{class:s.buttonClass+" icon-email-send feedback-btn"}).on("click",function(e){return ee&&(We(),s.feedback.root.trigger("onClose",function(){te&&qe(),s.feedback.root.trigger("onClose",null)})),s.feedback.root.trigger("addItems",o),!1}).appendTo(r),d?i.html("<span>"+s.feedbackBtnLabel+"</span>").data("tooltip",s.feedbackBtnTooltip):i.data("tooltip",s.feedbackBtnLabel)),LOCAL&&!DEBUG||!s.hasOwnProperty("fotomoto")||n.hideFotomoto(o)||(i=e("<a>",{class:s.buttonClass+" "+(a?"icon-fotomoto":"icon-shopping-cart")+" fotomoto-btn"}).on("click",function(e){return e.preventDefault(),ee&&Ze(),typeof FOTOMOTO!==UNDEF&&FOTOMOTO.API.showWindow(10,n.getOriginalPath(o)||n.getItemPath(o)),!1}).appendTo(r)).html("<span>"+E.fotomotoBtn+"</span>").data("tooltip",E.fotomotoTooltip),!K&&o[J.PHOTODATA]&&s.metaAsPopup&&(i=e("<a>",{class:s.buttonClass+" icon-camera photodata-btn"}).appendTo(r),d?i.html("<span>"+E.metaBtn+"</span>").data("tooltip",E.metaLabel):i.data("tooltip",E.metaBtn),i.on("click",function(){return ee&&We(),c.modal(e("<div>",{class:"photodata",html:o[J.PHOTODATA]}),{title:E.metaBtn,icon:"camera",onClose:function(){te&&qe()}}),!1})),!K&&s.showRegions&&o[J.REGIONS]&&(i=e("<a>",{class:s.buttonClass+" icon-facetag regions-btn"}).appendTo(r),d?i.html("<span>"+(s.regionsBtn||E.regionsBtn)+"</span>").data("tooltip",E.regionsLabel):i.data("tooltip",s.regionsBtn||E.regionsBtn),function(t,o){for(var a,n=e("<div>",{class:s.regionsClass}).appendTo(V),i=0;i<t.length;i++)a=t[i].split(";"),n.append(e("<div>").css({left:100*parseFloat(a[1])+"%",top:100*parseFloat(a[2])+"%",width:100*parseFloat(a[3])+"%",height:100*parseFloat(a[4])+"%"}).append("<span>"+a[0]+"</span>"));n.toggle(typeof o!==UNDEF&&o)}(JSON.parse(o[J.REGIONS]),s.regionsVisible),i.on("click",Ee)),s.showMap&&o[J.LOCATION]&&(i=e("<a>",{class:s.buttonClass+" icon-location map-btn"}).appendTo(r),d?i.html("<span>"+E.mapBtn+"</span>").data("tooltip",E.mapLabel):i.data("tooltip",E.mapBtn),i.on("click",function(){var a=e("<div>",{class:"map-cont"});return ee&&We(),a.height(t.height()*s.mapHeight),c.modal(a,{class:"no-padding large",onClose:function(){te&&qe()}}),setTimeout(function(){a.addMap({apiKey:s.mapApiKey,type:s.mapType||"hybrid",zoom:s.mapZoom||16,location:o[J.LOCATION],fitBounds:!1,fullscreenControl:!1,onTypeChanged:function(e){s.mapType=e},onZoomChanged:function(e){s.mapZoom=e}})},100),!1})),LOCAL||K||!o[J.MOSTPHOTOS]||(i=e("<a>",{class:s.buttonClass+" icon-shopping-cart mostphotos-btn",target:"_blank",href:"https://mostphotos.com/"+o[J.MOSTPHOTOS]}).appendTo(r),d?i.html("<span>"+E.mostphotosBtn+"</span>").data("tooltip",E.mostphotosLabel):i.data("tooltip",E.mostphotosBtn)),(DEBUG||!LOCAL)&&s.share&&s.showShare&&(i=e("<a>",{class:s.buttonClass+" icon-connect share-btn"}).appendTo(r),d?i.html("<span>"+E.share+"</span>").data("tooltip",E.shareLabel):i.data("tooltip",E.share),i.on("click",function(){var t=e("<div>",{class:"social"});return ee&&We(),c.modal(t,{title:E.shareOn,icon:"connect",onClose:function(){te&&qe()}}),setTimeout(function(){t.renderShares({sites:s.share,title:o[J.TITLE]||o[J.NAME].stripExt().replace(/[-_]/g," ").capitalize(),description:o[J.COMMENT],image:n.getOptimalThumbPath(o,[960,640],!1),href:n.getAbsolutePath(o)})},100),!1})),s.showNumbers&&r.prepend(e("<div>",{class:"numbers",html:"<span>"+(pe+1)+"&nbsp;</span>/&nbsp;"+L.length})),!j&&o[J.AUDIOCLIP]){i=e("<div>",{class:"audio-clip paused"}).appendTo(r);var g=e("<a>",{class:s.buttonClass+" icon-volume-up audioclip-btn"}).appendTo(i);g.on("click",function(){return g.hasClass("icon-pause")?Ke():Xe(),!1}),q=e("<audio>",{class:"audioclip",src:n.getAudioClipPath(o),controlsList:"nofullscreen nodownload noremote noplaybackrate"}).appendTo(i),o[J.AUDIOCLIP].hasOwnProperty(J.TYPE)&&(q[0].type=o[J.AUDIOCLIP][J.TYPE],o[J.AUDIOCLIP].hasOwnProperty(J.DURATION)&&q.data("duration",o[J.AUDIOCLIP][J.DURATION]));var b=e('<input class="volume" type="range" name="volume" min="0" max="100" value="'+100*s.audioClipVolume+'">');d?(g.append("<span>"+E.play+"</span>").data("tooltip",E.audioClipLabel),i.append(b)):g.data("tooltip",b),b.on("change",function(t){var o=e(this).val();typeof o!==UNDEF&&(s.audioClipVolume=o/100),q[0].volume=s.audioClipVolume,savePrefs(s,s.prefsKept,"lb_pref"),typeof s.onVolumeChange===FUNCTION&&s.onVolumeChange(s.audioClipVolume)}),q[0].volume=s.audioClipVolume,s.autoplayAudioClips&&Xe()}else q=e();r.is(":empty")||(U.addClass(s.hasbuttonsClass),U.append(r),r.find(".button").not("[download]").addTooltip()),U.is(":empty")?(c.removeClass(s.captionVisibleClass),c.addClass("no-caption")):(c.toggleClass(s.captionVisibleClass,s.captionVisible),c.removeClass("no-caption"),c.append(U))}(u),!1!==s.onLoadStart&&s.onLoadStart(N)},30)):console.log("Fatal error: image ("+pe+") is missing from the database! (Upload data1.json again!)")},ze=function(){if(Ze(!0),F.hideAllTooltips(),le=!1,a.add(e("html")).css("overflow",""),a.removeClass(s.lightboxOnClass),q.remove(),s.muteBackgroundAudio&&ve&&Ce.trigger("fadeInPlayer"),V.length){if((j||W)&&z){var t=z[0].volume,o=s.speed/(50*t),n=function(){if(z){var e=Math.max(z[0].volume-.02,0);e>.005?(z[0].volume=e,setTimeout(n,o)):z[0].pause()}};z.off("."+ge),n()}c.fadeOut(s.speed,function(){SMALLSCREEN||exitFullscreen(function(){c.removeClass("fullscreen")}),V.length&&(V.remove(),V=e()),U.length&&(U.remove(),U=e())}),!1!==s.onClose&&s.onClose(N),a.hideAllTooltips()}else SMALLSCREEN||exitFullscreen(function(){c.removeClass("fullscreen")}),!1!==s.onClose&&s.onClose(N)},Ue=function(e){A&&(e?A.removeClass("icon-play").addClass("icon-pause"):A.removeClass("icon-pause").addClass("icon-play").removeClass("show-progress"))},He=function(){ee?Ze():Ge()},Ge=function(e){clearTimeout(ee),Ue(!0),a.add(c).addClass(s.immerseClass),s.autohideControls&&ot(),U.addClass("slideshow"),!0!==e&&s.backgroundAudioSlideshowControl&&Ce.trigger("fadeInPlayer"),s.slideshowFullscreen&&requestFullscreen(function(){c.addClass("fullscreen")}),requestWakeLock(),oe?(ee=null,te=!0,_e(pt)):(te=!1,ee=setTimeout(pt,s.slideshowDelay/4)),!1!==s.onSlideshowStart&&s.onSlideshowStart(N)},qe=function(){Ue(!0),s.autohideControls&&ot(),a.add(c).addClass(s.immerseClass),ee=setTimeout(pt,s.slideshowDelay/4),te=!1,s.backgroundAudioSlideshowControl&&Ce.trigger("fadeInPlayer")},Ze=function(e){var t=null!==ee;return!1!==s.onSlideshowPause&&s.onSlideshowPause(N),!0!==e&&s.backgroundAudioSlideshowControl&&Ce.trigger("fadeOutPlayer"),Ue(!1),clearTimeout(ee),ee=null,te=!1,U.show().removeClass("slideshow"),a.add(c).removeClass(s.immerseClass),tt(),s.slideshowFullscreen&&!s.lightboxFullscreen&&exitFullscreen(function(){c.removeClass("fullscreen")}),releaseWakeLock(),!1!==s.onSlideshowPause&&s.onSlideshowPause(N),t},We=function(){s.backgroundAudioSlideshowControl&&Ce.trigger("fadeOutPlayer"),clearTimeout(ee),ee=null,te=!0},je=function(e){q.length&&e.length&&e.css("width",100*q[0].currentTime/q[0].duration+"%")},Xe=function(){q.length&&q[0].play().then(function(){var t=q.siblings(".audioclip-btn"),o=t.children(".progress");t.removeClass("icon-volume-up").addClass("icon-pause"),q.parent().removeClass("paused").addClass("playing"),ee&&We(),o.length||(o=e("<div>",{class:"progress"}).appendTo(t)),je(o),oe=setInterval(je,100,o),q.on("ended",function(){t.removeClass("icon-pause").addClass("icon-volume-up"),q.parent().removeClass("playing").addClass("paused"),te&&qe(),o.remove(),clearInterval(oe)})},function(e){btn.removeClass("icon-pause").addClass("icon-volume-up"),console.log(e)})},Ke=function(){if(q.length){var e=q.siblings(".audioclip-btn");q[0].pause(),clearInterval(oe),e.removeClass("icon-pause").addClass("icon-volume-up"),q.parent().removeClass("playing").addClass("paused"),te&&qe()}},_e=function(e,t){q.length&&typeof e===FUNCTION&&(q[0].paused?typeof t!==UNDEF?e.apply(null,t):e.call(null):q.on("ended",e,t))},Ye=function(){s.muteBackgroundAudio&&(ve=!Ce.data("paused"))&&Ce.trigger("fadeOutPlayer"),Xe(),V.addClass(s.playingClass)},Qe=function(){s.muteBackgroundAudio&&ve&&Ce.trigger("fadeInPlayer"),Ke(),V.removeClass(s.playingClass)},$e=function(){s.muteBackgroundAudio&&(ve=!1),Ke(),V.removeClass(s.playingClass)},et=function(e){var t=(e||c).find("audio,video").eq(0);if(t.length){var o=t[0].volume,a=s.speed/(50*o),n=function(){if(t){var e=Math.max(t[0].volume-.02,0);e>.005?(t[0].volume=e,setTimeout(n,a)):t[0].pause()}};t.off("volumechange."+ge),n()}},tt=function(){clearTimeout(ae),c.removeClass(s.controlsHideClass)},ot=function(){clearTimeout(ae),ae=setTimeout(function(){a.hideAllTooltips(),clearTimeout(ae),G.hideAllTooltips(),c.addClass(s.controlsHideClass)},s.hideControlsDelay)},at=function(){clearTimeout(ae),c.toggleClass(s.controlsHideClass,!nt())},nt=function(){return c.hasClass(s.controlsHideClass)},st=function(){isFullscreen()?exitFullscreen(function(){c.removeClass("fullscreen")}):requestFullscreen(function(){c.addClass("fullscreen")})},it=function(){G.hideAllTooltips(),c.addClass(s.thumbsVisibleClass),s.thumbsVisible=ce=!0,savePrefs(s,s.prefsKept,"lb_pref"),Fe(!0)},lt=function(){G.hideAllTooltips(),c.removeClass(s.thumbsVisibleClass),s.thumbsVisible=ce=!1,savePrefs(s,s.prefsKept,"lb_pref"),Fe(!0)},rt=function(){c.addClass(s.captionVisibleClass),s.captionVisible=ue=!0,savePrefs(s,s.prefsKept,"lb_pref"),Fe(!0)},dt=function(){G.hideAllTooltips(),c.removeClass(s.captionVisibleClass),s.captionVisible=ue=!1,savePrefs(s,s.prefsKept,"lb_pref"),Fe(!0)},ct=function(){s.captionVisible||s.thumbsVisible?(ce=s.thumbsVisible,ue=s.captionVisible,G.hideAllTooltips(),clearTimeout(ae),c.addClass(s.controlsHideClass),c.removeClass(s.thumbsVisibleClass+" "+s.captionVisibleClass),s.thumbsVisible=s.captionVisible=!1):(tt(),!ce&&ue||s.thumbsVisible||(c.addClass(s.thumbsVisibleClass),s.thumbsVisible=!0),!ue&&ce||s.captionVisible||(c.addClass(s.captionVisibleClass),s.captionVisible=!0)),savePrefs(s,s.prefsKept,"lb_pref"),"screen"!==s.fitBetween&&Fe(!0)},ut=function(){Be(pe-1)},pt=function(){Be(pe+1)},ht=function(){if(s.useThumbstrip&&!(L.length<2)){var e=f.children().eq(pe<0?0:pe),t=e.position().left,o=e.width(),a=f.translateX(),n=m.width(),i=f.width();f.children().removeClass(s.activeClass),e.addClass(s.activeClass),t<-a?f.translateX(Math.min(0,s.thumbOverhead-t),s.thumbSpeed,mt):t+o>n-a?f.translateX(Math.max(n-t-o-s.thumbOverhead,n-i),s.thumbSpeed,mt):n-a>i&&f.translateX(n-i,s.thumbSpeed,mt)}},mt=function(t){if(c.is(":visible")&&s.useThumbstrip&&!(L.length<2)){var o=m.width(),a=f.translateX()||0;f.children("."+s.lazyloadClass).each(function(){var t=e(this),n=t.position().left,i=t.width();if(n+a<o&&n+i+a>0)t.removeClass(s.lazyloadClass),function(t){if(t.length){var o=e("<img>",{class:"hide-image"}).one("load",function(){e(this).removeClass("hide-image").addClass("show-image")}).attr("src",t.attr("href"));s.rightClickProtect&&o.on("contextmenu",function(e){return e.preventDefault(),!1}),t.append(o).removeAttr("href")}}(t),t.addTooltip({delay:1e3});else if(n+a>=o)return!1}),typeof t===FUNCTION&&t.call(this)}},ft=function(){if(c.is(":visible")){var e=f.children(":last-child");e.position().left+e.outerWidth()>m.width()?(h.addClass(s.scrollClass),ht()):(h.removeClass(s.scrollClass),f.translateX(0,s.thumbSpeed))}},gt=function(e){var t=m.width(),o=f.translateX()||0;t>f.width()?o&&f.translateX(0,s.thumbSpeed,mt):(o=e<0?Math.min(0,o+t):Math.max(t-f.width(),o-t),f.translateX(o,s.thumbSpeed,mt))},bt=function(){s.thumbsVisible&&c.addClass(s.thumbsVisibleClass),(h=e("<div>",{class:"thumb-strip"}).appendTo(c)).append(e("<button>",{class:"left icon-caret-left"}).on("click."+ge,function(e){return gt(-1),!1})),h.append(e("<button>",{class:"right icon-caret-right"}).on("click."+ge,function(e){return gt(1),!1})),(m=e("<div>",{class:"thumb-cont"}).appendTo(h)).on("selectstart."+ge,function(e){return!1});var t,o,a,i=(f=e("<div>",{class:"thumbs"}).appendTo(m)).height()||60,l=0;L.each(function(r){t=e(this).data(J.OBJ),(a=e("<a>",{class:s.lazyloadClass,title:t[J.THUMBCAPTION]||"",href:n.getThumbPath(t)}).appendTo(f)).on("click",function(t){var o=e(t.target).closest("a");return Be(f.children().index(o)),!1}),o=Math.min(t[J.THUMB][J.WIDTH],(i-4)*t[J.THUMB][J.WIDTH]/t[J.THUMB][J.HEIGHT]),a.width(o),l+=o})},Ct=function(){if(G=e("<div>",{class:s.controlsClass+(s.controlsUseText?" use-text":"")}).appendTo(c),L.length>1&&(g=e("<button>",{type:"button",class:"previous",title:E.previousPicture,text:s.controlsUseText?E.previousPictureShort:""}).on("click."+ge,ut).appendTo(G)),b=e("<button>",{type:"button",class:"up icon-arrow-up",title:E.upOneLevel,text:s.controlsUseText?E.upOneLevelShort:""}).on("click."+ge,ze).appendTo(G),s.useZoom)if(s.zoomSlider){var t=e("<div>",{class:"zoom-control"}),o=e("<a>",{class:"zoom-out button"}).appendTo(t);T=e("<input>",{name:"zoom-level",type:"range"}).appendTo(t);var a=e("<a>",{class:"zoom-in button"}).appendTo(t);C=e("<button>",{type:"button",class:"zoom-level icon-zoom-level",text:s.controlsUseText?E.zoom:""}).on("click."+ge,function(){return!(!le||(setTimeout(xe,50),"touch"!==e("html").data("whatinput")))}).addTooltip(e("<div>",{class:"zoom-panel"}).append(t),{touchToggle:!0,pos:[1,0,1,2]}).appendTo(G),T.on("change",function(){return Pe(parseInt(T.val())),!0}),a.on("click",function(){return Se(),!1}),o.on("click",function(){return Oe(),!1})}else v=e("<button>",{type:"button",class:"zoom-in icon-expand",title:E.oneToOneSize,text:s.controlsUseText?E.oneToOneSizeShort:""}).on("click."+ge,xe).appendTo(G),w=e("<button>",{type:"button",class:"zoom-out icon-contract",title:E.fitToScreen,text:s.controlsUseText?E.fitToScreenShort:""}).on("click."+ge,xe).appendTo(G);if(s.useThumbstrip&&L.length>1&&(P=e("<button>",{type:"button",class:"show-thumbs icon-show-top-panel",title:E.showThumbs,text:s.controlsUseText?E.showThumbsShort:""}).on("click."+ge,it).appendTo(G),S=e("<button>",{type:"button",class:"hide-thumbs icon-hide-top-panel",title:E.hideThumbs,text:s.controlsUseText?E.hideThumbsShort:""}).on("click."+ge,lt).appendTo(G)),O=e("<button>",{type:"button",class:"show-caption icon-show-bottom-panel",title:E.showInfo,text:s.controlsUseText?E.showInfoShort:""}).on("click."+ge,rt).appendTo(G),k=e("<button>",{type:"button",class:"hide-caption icon-hide-bottom-panel",title:E.hideInfo,text:s.controlsUseText?E.hideInfoShort:""}).on("click."+ge,dt).appendTo(G),s.useSlideshow&&L.length>1)if(A=e("<button>",{type:"button",class:"play-pause icon-play",title:E.slideshow}).appendTo(G),I=e("<span>",{class:"progress"}).appendTo(A),A.on("click."+ge,function(){return!(!le||(He(),"touch"!==e("html").data("whatinput")))}),s.timingControl){var n=e("<div>",{id:"timing-control",class:"timing-control"}),i=e("<a>",{class:"decr-time"}).appendTo(n);M=e("<span>").appendTo(n);var l=e("<a>",{class:"incr-time"}).appendTo(n);A.addTooltip(e("<div>",{class:"timing-panel"}).append(e("<div>",{class:"label",html:E.timing})).append(n),{touchToggle:!0,pos:[1,0,1,2]}),l.on("click",function(){return s.slideshowDelay>1e3?s.slideshowDelay+=1e3:s.slideshowDelay+=100,Me(s.slideshowDelay),!1}),i.on("click",function(){return s.slideshowDelay>500&&(s.slideshowDelay>1e3?s.slideshowDelay-=1e3:s.slideshowDelay-=100),Me(s.slideshowDelay),!1}),setTimeout(function(){Me(s.slideshowDelay)},500)}else A.attr("title",E.startStopSlideshow);s.showFullscreen&&hasFullscreen()&&(y=e("<button>",{type:"button",class:"fullscreen icon-fullscreen",title:E.fullscreen,text:s.controlsUseText?E.fullscreenShort:""}).on("click."+ge,st).appendTo(G),x=e("<button>",{type:"button",class:"exitfullscreen icon-fullscreen-off",title:E.exitFullscreen,text:s.controlsUseText?E.exitFullscreenShort:""}).on("click."+ge,st).appendTo(G),isFullscreen()&&c.addClass("fullscreen")),L.length>1&&(D=e("<button>",{type:"button",class:"next",title:E.nextPicture,text:s.controlsUseText?E.nextPictureShort:""}).on("click."+ge,pt).appendTo(G)),G.children("button").not(".zoom-level").not(".pause").addTooltip({delay:1e3,pos:[1,0,1,2]})};if(ge&&function(o){t.add(document).off("."+o),e("#"+o).remove()}(ge),F.data("llb_ns",ge="llb_"+Math.floor(1e4*Math.random())),L=F.find(s.delegate),loadPrefs(s,s.prefsKept,"lb_pref"),function(t){c=e("<div>",{id:t,class:"lightbox"}).hide().appendTo(F),u=e("<div>",{class:"lightbox-overlay"}).appendTo(c),p=e("<div>",{class:"lightbox-loading"}).append("<div>").append("<div>").append("<div>").appendTo(c),c.toggleClass(s.thumbsVisibleClass,s.thumbsVisible&&L.length>1),c.toggleClass(s.captionVisibleClass,s.captionVisible),Ct(),s.useThumbstrip&&L.length>1&&bt(),s.quitOnDocClick||u.on("click."+t,function(e){return this===e.target&&(getCoords(e).x>=c.width()/2?pt():ut()),!1})}(),t.on("resize."+ge,function(){clearTimeout(ne),ne=setTimeout(function(){clearTimeout(ne),!V||!V.length||_&&isFullscreen()||Fe(),mt(ft)},50)}),s.quitOnDocClick&&u.on("click."+ge,function(t){if(s.autohideControls&&nt())return tt(),!1;V.length&&!e(t.target).is(V)&&ze()}),s.autohideControls&&o.on("mousemove."+ge,function(){tt(),ot()}),s.enableKeyboard&&o.on("keyup."+ge,function(e){if(!le||!V.length||c.children(".modal:visible").length||document.activeElement&&("INPUT"===document.activeElement.nodeName||"TEXTAREA"===document.activeElement.nodeName))return!0;switch(e.preventDefault(),e.keyCode){case 27:ze();break;case 33:case 37:ut();break;case 34:case 39:pt();break;case 97:case 35:Be(L.length-1);break;case 103:case 36:Be(0);break;case 106:case 179:He();break;case 107:s.useZoom?s.zoomSlider?Se():xe():s.captionVisible?dt():rt();break;case 109:s.useZoom&&s.zoomSlider?Oe():ct();break;case 32:W?z[0].paused?playVideo(z[0]):z[0].pause():j?z[0].paused?z[0].play():z[0].pause():He();break;default:return!0}return!1}),s.enableMouseWheel){var vt=null;c.on("mousewheel."+ge+" DOMMouseScroll."+ge,function(t){if(le){if(clearTimeout(vt),!V.length||e(t.target).closest("."+s.lightboxCaptionClass).length||V.hasClass("pdf")||V.hasClass("external")||c.children(".modal:visible").length)return!0;vt=s.useZoom&&s.zoomSlider&&1==t.ctrlKey?setTimeout(t.originalEvent.wheelDelta>0||t.originalEvent.detail<0?function(e){Se()}:function(e){Oe()},100):setTimeout(t.originalEvent.wheelDelta>0||t.originalEvent.detail<0?ut:pt,100)}return!1})}return F.on("lightboxLoad."+ge,function(e,t,o){Ze(!0),t=typeof t===NUMBER?Math.minMax(0,t,L.length):typeof t===UNDEF?0:L.index(t),!1!==s.onStart&&s.onStart(typeof t===NUMBER?L.eq(t):th),Be(t),ee&&Ze(!0),o&&(typeof o===NUMBER?setTimeout(Ge,o):Ge())}).on("lightboxQuit."+ge,function(){return ze(),!1}).on("lightboxRemove."+ge,function(){return Ze(!0),le=!1,L.off("."+ge),o.add(t).add(c).off("."+ge),a.add(e("html")).css("overflow",""),a.removeClass(s.lightboxOnClass),V.length?V.animate({opacity:0},s.speed,function(){c.remove(),s.lightboxFullscreen&&exitFullscreen()}):(s.lightboxFullscreen&&exitFullscreen(),c.remove()),!1}).on("stopAutoHide."+ge,function(){clearTimeout(ae)}).on("lightboxContainer."+ge,function(){return c}).on("lightboxNext."+ge,function(){return Ze(),pt(),!1}).on("lightboxPrevious."+ge,function(){return Ze(),ut(),!1}),s.hasOwnProperty("onReady")&&typeof s.onReady===FUNCTION&&s.onReady(N),s.autoStart&&s.baseSet&&Ge(),this},e.fn.lightbox.defaults={delegate:".card.lbable",lightboxMainClass:"lightbox-main",lightboxCaptionClass:"lightbox-caption",lightboxOnClass:"lightbox-on",controlsClass:"controls",buttonClass:"button",lazyloadClass:"lazyload",activeClass:"active",scrollClass:"scroll",regionsClass:"regions",captionVisibleClass:"caption-visible",thumbsVisibleClass:"thumbs-visible",hasbuttonsClass:"hasbuttons",immerseClass:"immerse",controlsVisibleClass:"controls-visible",controlsHideClass:"controls-hide",checkboxClass:"checkbox",checkmarkClass:"icon-checkmark",selectedClass:"checked",playingClass:"playing",transitionProps:"300ms ease-out",slideshowDelay:4e3,timingControl:!1,hideControlsDelay:2500,prefsKept:["thumbsVisible","captionVisible","audioClipVolume"],controlsUseText:!1,thumbsVisible:!0,useThumbstrip:!0,captionVisible:!0,zoomed:!0,fitBetween:"screen",fitRatio:.94,maxZoom:1.4,displayOriginals:!0,useZoom:!0,zoomSlider:!1,linkOriginals:!1,hiDpiThumbs:!1,hiDpiImages:!1,showFullscreen:!1,indexName:"index.html",baseSet:!0,autohideControls:!1,autoStart:!1,clickAction:"donothing",useSlideshow:!0,autoplayAudioClips:!0,backgroundAudioSlideshowControl:!1,muteBackgroundAudio:!0,use360Player:!0,useGoogleDocs:!0,lightboxFullscreen:!1,slideshowFullscreen:!1,afterLast:"donothing",doubleClickZoom:!0,mapHeight:.8,mapApiKey:"",mapType:"hybrid",mapZoom:15,showShop:!1,showFeedback:!1,showLowestPrice:!1,videoAuto:!1,videoLoop:!1,autoPano:!1,autoPanoStart:0,autoPanoSpeed:80,volume:.5,audioClipVolume:.75,rightClickProtect:!1,useRating:!1,jalbumRating:!1,visitorRating:!1,buttonLabels:!0,showNumbers:!1,infoPanelAdapt:!1,showShare:!1,showDownload:!1,allowDownloadScaled:!1,allowDownloadOthers:!1,showMap:!1,showRegions:!0,regionsVisible:!1,printImage:!1,metaAsPopup:!0,transitionType:"crossFadeAndSlide",speed:400,panoramaAutoDetect:1.5,panoramaTreshold:[2.5,2.5],defaultPosterSize:[628,360],thumbSpeed:400,thumbOverhead:40,preloadNext:!0,enableKeyboard:!0,enableMouseWheel:!0,quitOnEnd:!0,quitOnDocClick:!0,onStart:!1,onClose:!1,onLoadStart:!1,onLoadEnd:!1,onReady:!1,onSlideshowStart:!1,onSlideshowPause:!1,onVolumeChange:!1,feedbackBtnLabel:"Write feedback",feedbackBtnTooltip:"View feedback window",feedback:{}},e.fn.lightbox.text={startOver:"Start over",upOneLevel:"Up one level",upOneLevelShort:"Exit",backToHome:"Back to home",backToIndex:"Back to index page",nextFolder:"Next folder",nextIndex:"Next index page",atLastPageQuestion:"Where to go next?",atLastPage:"At last page",atFirstPage:"At first page",previousPicture:"Previous image",previousPictureShort:"Prev",nextPicture:"Next image",nextPictureShort:"Next",zoom:"Zoom",oneToOneSize:"1:1 size",oneToOneSizeShort:"1:1",fitToScreen:"Fit to screen",fitToScreenShort:"Fit",fullscreen:"Full screen",exitFullscreen:"Exit full screen",fullscreenShort:"Fullscr",exitFullscreenShort:"Normal",showThumbs:"Show thumbnail strip",showThumbsShort:"Thumbnails",hideThumbs:"Hide thumbnail strip",hideThumbsShort:"Hide thumbs",showInfo:"Show caption / info",showInfoShort:"Info",hideInfo:"Hide caption / info",hideInfoShort:"Hide info",startSlideshow:"Start slideshow",startSlideshowShort:"Play",timing:"Timing",pause:"Pause",pauseShort:"Pause",rating:"Rating",download:"Download",print:"Print",printLabel:"Print out this photo on your printer",mapBtn:"Map",mapLabel:"Show the photo location on map",fotomotoBtn:"Buy / Share",fotomotoTooltip:"Buy prints or digital files, share, send free eCards",mostphotosBtn:"Purchase",mostphotosLabel:"Download this image from <b>mostphotos.com</b>!",regionsBtn:"People",regionsLabel:"Show tagged people",share:"Share",shareLabel:"Share this photo over social sites",shareOn:"Share on",shopBtn:"Buy",shopLabel:"Add this item to the shopping cart",viewCartLabel:"View shopping cart",metaBtn:"Photo data",metaLabel:"Display photographic (Exif/Iptc) data",viewCart:"View cart",addCart:"Add to cart",clickToOpen:"Click to open this document with the associated viewer!",play:"Play",audioClipLabel:"Play / pause the attached audio clip"}}(jQuery,jQuery(window),jQuery(document),jQuery("body"));
!function(e,t,a,s,n){"use strict";e.fn.selectable=function(t){t=e.extend({cardClass:"card",thumbClass:"thumb",checkboxClass:"checkbox",selectedClass:"checked",checkmarkClass:"icon-checkmark",hasSelectedClass:"has-selected",allSelectedClass:"all-selected",selectionChange:null},t);var a,n=e(this).eq(0),r=function(e){typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],e),s.toggleClass(t.hasSelectedClass,e>0).toggleClass(t.allSelectedClass,e===a.length)},l=function(){return a.filter("."+t.selectedClass).length},o=function(a){(a instanceof e?a:e(this)).addClass(t.selectedClass).find("."+t.checkboxClass).addClass(t.checkmarkClass)},i=function(a){(a instanceof e?a:e(this)).removeClass(t.selectedClass).find("."+t.checkboxClass).removeClass(t.checkmarkClass)},c=function(a){var s=a instanceof e?a:e(this);s.hasClass(t.selectedClass)?i(s):o(s)},d=function(a){var s=e(a.target).closest("."+t.cardClass),c=l();return s.hasClass(t.selectedClass)?(i(s),c-=1,typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],c)):(o(s),c+=1,typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],c)),r(c),!1},h=function(){var s,r;(a=t.selector?n.find(t.selector):n.find("."+t.cardClass)).each(function(){e(this).find("span."+t.checkboxClass).length||(s=e(this).children("."+t.thumbClass).eq(0),(r=s.length?e("<span>",{class:t.checkboxClass}).appendTo(s):e("<span>",{class:t.checkboxClass}).prependTo(e(this))).on({click:d}),e(this).on({selectCard:o,unselectCard:i,toggleCard:c}))}),typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],l())};return h(),n.on({selectAll:function(){if(n.is(":visible")){var s=l();s<a.length&&(s=a.length,a.not("."+t.selectedClass).each(function(){o(e(this))}),typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],s)),r(s)}},selectNone:function(){if(n.is(":visible")){var s=l();s>0&&(s=0,a.filter("."+t.selectedClass).each(function(){i(e(this))}),typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],s)),r(s)}},selectInverse:function(){if(n.is(":visible")){var s=a.length-l();0===s?(a.each(function(){i(e(this))}),typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],0)):(a.each(function(){c(e(this))}),typeof t.selectionChange===FUNCTION&&t.selectionChange.call(n[0],s)),r(s)}},selectRefresh:h}),this},e.fn.skin=function(a){a=e.extend({},e.fn.skin.defaults,a);var n,r=e(this),l=r.find("#main-cont"),o=getTranslations({foundNTimes:"found {0} time(s)",notFound:"not found",search:"Search",searchPlaceholder:"Search...",newImages:"New images",results:"Results",reset:"Reset",label:"Label",selectedItems:"Selection",addCart:"Add to cart",fotomotoBtn:"Buy / Share",fotomotoTooltip:"Buy prints or digital files, share, send free eCards",return:"return",select:"Select",sortBy:"Sort by",sortedBy:"Sorted by",ascending:"ascending",descending:"descending",multipleSelectHint:"Use SHIFT to select range, CTRL for multiple entries",noRating:"No rating",inTheLastDay:"in the last day",inThePastNDays:"in the past {0} days",sinceMyLastVisit:"since my last visit",betweenDays:"between {0} and {1}",onDay:"on {0}",beforeDay:"before {0}",afterDay:"after {0}",imagesAdded:"Images added",imagesModified:"Images modified",imagesTaken:"Images taken",new:"New",audioClipLabel:"Play / pause the attached audio clip",more:"more",less:"less",image:"image",images:"images",audio:"audio",audio:"audios",video:"video",videos:"videos",other:"other",others:"others"}),i=e(),c=e(),d=e(),h=e(),u="tiger_skin",f="",p=!1,g=a.indexName.split(".")[1]||"html",m=""!==window.location.hash,C=new Date/1e3,v="EUR",y=t.scrollTop(),b=null,T=!1,w=function(){return l.find("."+a.overlayClass).length>0},O=function(){var e=P();if(e.length){var t=e.data("overlay");return t||(t=e.hasClass(a.baseOverlayClass)?"base":N(),e.attr("data-overlay",t),t)}return""},N=function(){return"oly_"+Math.floor(1e4*Math.random())},P=function(e){var t=l.find("."+a.thumbnailsClass).last();return!t.length&&typeof e!==UNDEF&&e&&(t=k()),t},A=function(){return l.find("."+a.thumbnailsClass).eq(0)},x=function(){var e=P();(e.length&&e.offset().top<t.scrollTop()||e.offset().top>t.scrollTop()+t.height()-100)&&t.scrollTop(e.offset().top)},k=function(){var t=N(),s=e("<section>",{class:a.thumbnailsClass+" "+a.overlayClass}).attr({id:t,"data-overlay":t}),n=A();return n.length?n.after(s):l.prepend(s),F(s),l.addClass(a.hasOverlayClass),s},I=function(){return P().children("header").eq(0)},E=function(t){var s=I().find("h"+a.overlayHeadLevel).eq(0);return s.length?t.appendTo(s):e()},R=function(){return e("<div>",{class:a.progressbarClass}).insertAfter(I())},S=function(e){P().find("."+a.progressbarClass).remove()},M=function(t){if(t.length){var a=O();t.each(function(){e(this).attr("data-rel",a)})}},D=function(e){(e=e||O())&&l.find("[data-rel="+e+"]").remove()},F=function(t){t=t||P();return e("<div>",{class:[a.contClass,a.thumbLayout,"caption-"+a.captionPlacement,"below"!==a.captionPlacement&&a.captionShowOnHover?"caption-on-hover":""].filter(Boolean).join(" ")}).appendTo(t)},B=function(){return l.find("."+a.thumbnailsClass+":not(."+a.overlayClass+")").first().children("div."+a.contClass)},L=function(e){var t=l.find("."+a.thumbnailsClass).last().children("div."+a.contClass);return!t.length&&e&&(t=F(P(!0))),t},U=function(e){return B().find("."+a.cardClass+(e||""))},H=function(e){return L().find("."+a.cardClass+(e||""))},G=function(e){return L().find("."+a.cardClass+" ."+a.thumbClass+(e||""))},q=function(){return L().find("."+a.cardClass+"."+a.selectableClass)},_=function(){var s=P();if(s.length&&s.hasClass(a.overlayClass)){var n=s.data("oly-ns");t.off("."+n),s.trigger("removeLightbox"),D(n),s.trigger("overlayRemoved"),s.remove(),l.removeClass(a.hasOverlayClass),function(){var t=A();t.length&&(e("[data-rel="+t.data("overlay")+"]").not(".hidden").show(),t.trigger("refresh"))}(),a.hasOwnProperty("search")&&te(),removeParam(a.indexName),Ee(),q().length?c.add(h).show():c.add(h).hide(),l.hideAllTooltips(),l.find("[data-sticky-rel]").trigger("stickyRefresh")}},V=function(t){w()&&_(),l.hideAllTooltips();var s=k();return function(t,s){var n=e("<header>",{class:[a.contClass,a.overlayTitleClass,t&&t.hasOwnProperty("icon")?t.icon:""].filter(Boolean).join(" ")}).prependTo(s||P());t&&t.hasOwnProperty("title")&&n.append(e("<h"+a.overlayHeadLevel+">",{html:t.title})),n.append(e("<a>",{class:"close",href:"",text:o.return}).on("click",function(){return _(),!1}))}(t,s),l.trigger("overlayReady",s),l.find("[data-sticky-rel]").trigger("stickyRefresh"),s},W=function(t,s){var n,r=e();return n=typeof s!==UNDEF&&s?U():H(),t=decodeURIComponent(t),n.find("."+a.thumbClass).each(function(){var s=e(this).data("name")||function(e){var t=e.data("href")||e.attr("href");return t?t.substring(t.lastIndexOf("/")+1).replace("#img=",""):""}(e(this));if(s===t||function(e,t){return e.slice(-g.length)===g&&e.substring(0,e.lastIndexOf("."))===t.substring(0,t.lastIndexOf("."))}(s,t))return r=e(this).closest("."+a.cardClass),!1}),r},j=function(t){var s=l.find("."+a.foldersClass+" ."+a.contClass);return s.length?s.find("."+a.cardClass+(t||"")):e()},z=function(t){var s=l.find(a.mapBoxHook).last();if(s.length&&s.is(":visible"))return s.find("."+a.mapRootClass);if(t){var n=e('<section class="map show-on-overlay"><div class="cont box"><div class="'+a.mapRootClass+'" data-map-root></div></div></section>');return s.length?s.after(n):P().before(n),M(n),n.find("."+a.mapRootClass)}return e()},Y=function(){return L().find("."+a.lightboxClass)},K=function(e,t){ne(G(" .playing")),L().trigger("lightboxLoad",typeof t===UNDEF?e:[e,t])},Q=function(){var t=[];return L().find("."+a.cardClass+"."+a.selectedClass).each(function(){t.push(e(this).data(J.OBJ))}),t},Z=function(){var t=[];return H().each(function(){t.push(e(this).data(J.OBJ))}),t},$=function(){var t=[];return U().each(function(){t.push(e(this).data(J.OBJ))}),t},X=function(){var e=L().find("."+a.cardClass+"."+a.activeClass);return e.length?e.data(J.OBJ):null},ee=function(s){if(T||Y().is(":visible")||w())clearTimeout(b);else{b&&(clearTimeout(b),b=null);var n=t.scrollTop();if(Math.abs(n-y)>20)return y=n,void(b=setTimeout(ee,a.scrollCheckInterval));var r=j("."+a.lazyloadClass);if(r.length){var l=t.height();T=!0,r.each(function(){var t=e(this),s=t.offset().top;if(s+t.height()>y-l){if(!(s<y+l))return!1;!function(t){t.find("[data-src]").each(function(){var s=e(this),n=t.find("img");n.length||((n=e("<img>",{class:a.hideImageClass,alt:s.data("alt")||""}).appendTo(s))[0].width=s.data("width"),n[0].height=s.data("height")),n.one("load",function(){t.removeClass(a.lazyloadClass),e(this).addClass(a.showImageClass).removeClass(a.hideImageClass)}).attr("src",s.data("src")),s.removeData("src")})}(t)}}),clearTimeout(b),b=setTimeout(ee,a.scrollCheckInterval)}else t.off(".lazy");T=!1,y=n,typeof s===FUNCTION&&s.call(this)}},te=function(){e(a.search.hook).find("input").val("")},ae=function(t){var s,n=e(this);return t.preventDefault(),n[0].hasAttribute("rel")&&(s=e("#"+n.attr("rel"))),s&&s.length||(n.attr("rel","PL_"+Math.floor(1e4*Math.random())),s=function(t){var s=e("<audio>",{class:"audioclip-player",src:t.attr("href"),id:t.attr("rel"),controlsList:"nofullscreen nodownload noremote noplaybackrate"}).hide().insertAfter(t);return s[0].volume=a.audioClipVolume,s}(n)),s[0].paused?(se(),s[0].play().then(function(){n.removeClass("icon-volume-up paused").addClass("icon-pause playing"),s.on("ended",function(){n.removeClass("icon-pause playing").addClass("icon-volume-up paused")})},function(e){n.removeClass("icon-pause playing").addClass("icon-volume-up paused"),console.log(e)})):(s[0].pause(),n.removeClass("icon-pause playing").addClass("icon-volume-up paused")),!1},se=function(){ne(G(" .playing"))},ne=function(t){t.each(function(){var t=e("#"+e(this).attr("rel"));t.length&&(t[0].pause(),e(this).removeClass("icon-pause playing").addClass("icon-volume-up paused"))})},re=function(t){if(t&&t.length){for(var a=[],s=0;s<t.length;s++)a.push(t[s].hasOwnProperty(J.VISITORRATING)?t[s][J.VISITORRATING]:-1);e.cookie(REL_PATH+PAGE_NAME+":ratings",a,604800)}};e.fn.renderImages=function(r,l,c){if(typeof r===UNDEF||!r.length)return this;Array.isArray(r)||(r=[r]);var h=e(this),u=O(),f=L(!0),p=t.scrollTop(),g=null,m=null,v=function(){h.on({setactivecard:function(e,t){x(t)},refreshRating:k,refresh:b}),typeof l===FUNCTION&&(typeof c!==UNDEF?l.call(void 0,h,c):l.call(void 0,h))},y=function(t){var s=P();if(clearTimeout(m),s.length)if(s.is(":visible")){var n=s.children("."+a.contClass).width();if(s.innerWidth()<a.pageWidth&&s.hasClass("overlay")&&(n+=32),s.data("fixedfor")!==n){var r=function(t,s){s>1.6&&(s=1.6);var n=Math.floor(a.thumbDims[1]*s);t.each(function(){e(this).css({width:e(this).data("width")*(s||1)}),e(this).children("."+a.thumbClass).css({height:n}),e(this).children("."+a.captionClass).css({maxWidth:"100%"})})};requestAnimationFrame(function(){!function(e){for(var t,l=0,o=0;e.length&&l<e.length;)o+(t=e.eq(l).data("width")+2*a.thumbGap)>=n?(o+t/2>=n?(r(e.slice(0,l),.9999*(n-2*l*a.thumbGap)/(o-2*l*a.thumbGap)),e=e.slice(l)):(r(e.slice(0,l+1),.9999*(n-2*(l+1)*a.thumbGap)/(o+t-2*(l+1)*a.thumbGap)),e=e.slice(l+1)),l=0,o=0):(l++,o+=t);if(e.length>1){var i=.9999*(n-2*e.length*a.thumbGap)/(o-2*e.length*a.thumbGap);r(e,i>1.2?1:i)}else r(e,1);s.data("fixedfor",n)}(s.find("."+a.cardClass))}),typeof t===FUNCTION&&t.call()}else typeof t===FUNCTION&&t.call()}else m=setTimeout(y,100)},b=function(){clearTimeout(m),m="justified"===a.thumbLayout?setTimeout(y,100,T):setTimeout(T,a.scrollCheckInterval/2)},T=function(){if(!Y().is(":visible")){clearTimeout(g),g=null;var s=t.scrollTop(),n=t.height();if(Math.abs(s-p)>20)return p=s,void(g=setTimeout(T,a.scrollCheckInterval));var r=H("."+a.lazyloadClass).not(":empty");(r=r.add(H("."+a.preloadClass).not(":empty").not(".icon").filter(function(){var t=e(this).find("."+a.thumbClass),s=t.find("img").eq(0);return!(a.fixedShapeThumbs||!s.data("hasrenditions")||!(1.1*s[0].width<t.width()||1.1*s[0].height<t.height()))||(e(this).removeClass(a.preloadClass),!1)}))).length?(r.each(function(){var t=e(this),a=t.offset().top;if(a+t.height()>p-n){if(!(a<p+2*n))return!1;A(t)}}),p=s,g=setTimeout(T,a.scrollCheckInterval)):t.off("scroll."+u)}},w=function(t){return!("A"!==t.target.nodeName||!e(t.target).closest("."+a.commentClass).length&&!e(t.target).hasClass("folder-link"))||(s.hideAllTooltips(),K(e(t.target).closest("."+a.cardClass)),!1)},A=function(t){if(t.length){var s=t.children("."+a.thumbClass).eq(0),r=s.children("img");r.length||s.append(e("<img>",{class:a.hideImageClass})),t.hasClass(a.lazyloadClass)&&typeof r.attr("src")!==UNDEF&&!1!==r.attr("src")?s.removeClass(a.hideImageClass).addClass(a.showImageClass):(t.hasClass(a.lazyloadClass)&&r.one("load",function(){e(this).removeClass(a.hideImageClass).addClass(a.showImageClass)}),r.attr("src",n.getOptimalThumbPath(t.data(J.OBJ),[s.outerWidth(),s.outerHeight()],!a.fixedShapeThumbs))),t.removeClass(a.lazyloadClass+" "+a.preloadClass)}},x=function(s){if(s){var r=e(s),l=r.data(J.OBJ),o=t.height(),i=t.scrollTop(),c=r.offset().top,d=r.outerHeight();H("."+a.activeClass).removeClass(a.activeClass),r.addClass(a.activeClass),a.hasOwnProperty("map")&&(n.hasLocation(l)?z().trigger("setActive",l[J.NAME]):z().trigger("resetMarkers")),c+d>i+o?window.scrollTo({top:Math.round(c-o+d+30),behavior:"smooth"}):c<i&&window.scrollTo({top:Math.round(Math.max(c-30,0)),behavior:"smooth"})}},k=function(t,s,n){if(s){var l=e(s),o=l.data(J.OBJ),i=(typeof n!==UNDEF?n:a.visitorRating?o[J.VISITORRATING]:o[J.RATING])||0;l.find(".rating").removeClass("r0 r1 r2 r3 r4 r5").addClass("r"+i),c?re(r):W(o[J.NAME],!0).find(".rating").removeClass("r0 r1 r2 r3 r4 r5").addClass("r"+i)}};return u||(u=function(e,t){var t=typeof t===UNDEF?P():t,e=typeof e===UNDEF?t.hasClass(a.baseOverlayClass)?"base":N():e;return t.attr("data-overlay",e),e}()),c&&a.useRating&&a.visitorRating&&function(t){var a=e.cookie(REL_PATH+PAGE_NAME+":ratings");if(a){typeof a===STRING&&(a=a.split(":"));for(var s=0;s<t.length&&s<a.length;s++)-1!==a[s]&&(t[s][J.VISITORRATING]=a[s])}}(r),window.requestAnimationFrame(function(){for(var s,l,h,p,g,y,T,O,N,P,A,x=H(),k=a.hasOwnProperty("markNew")?C-a.markNew.days*ONEDAY_S:null,I=0;I<r.length;I++){if(A=r[I],g="folder"===A[J.CATEGORY],y=!g&&n.isLightboxable(A),T="video"===A[J.CATEGORY]||"audio"===A[J.CATEGORY],O=!!A.hasOwnProperty(J.THUMB)&&/res\/\w+\.png$/.test(A[J.THUMB][J.PATH]),l=A.hasOwnProperty(J.THUMB)?A[J.THUMB][J.WIDTH]/A[J.THUMB][J.HEIGHT]:1,N=A[J.THUMBCAPTION],s=I<x.length?x.eq(I):e("<div>",{class:[a.cardClass,a.lazyloadClass,A[J.CATEGORY],N?"hascaption":"",A.hasOwnProperty(J.THUMB)&&A[J.THUMB][J.WIDTH]<a.thumbDims[0]&&A[J.THUMB][J.HEIGHT]<a.thumbDims[1]?"tiny":"",O?"icon":"",l>=1.25?"landscape":l<=.8?"portrait":"square"].filter(Boolean).join(" ")}).appendTo(f),y&&s.addClass(a.lbableClass),s.data(J.OBJ,A),(h=s.children("."+a.thumbClass)).length||(h=e("<a>",{class:a.thumbClass}).appendTo(s)),(p=h.find("img").eq(0)).length||(p=e("<img>",{alt:n.getAlt(A)}).appendTo(h)),O?h.addClass("iconthumb"):(A[J.THUMB].hasOwnProperty(J.RENDITIONS)?p.data("hasrenditions",!0):p.one("load."+u,function(){e(this).parents("."+a.cardClass).removeClass(a.preloadClass)}),p.addClass(a.hideImageClass).one("load."+u,function(){e(this).removeClass(a.hideImageClass).addClass(a.showImageClass).parents("."+a.cardClass).removeClass(a.preloadClass)}),p[0].hasAttribute("src")&&p[0].complete?p.trigger("load"):p.addClass(a.hideImageClass),T||(p.attr({width:A[J.THUMB][J.WIDTH],height:A[J.THUMB][J.HEIGHT]}),A[J.THUMB][J.HEIGHT]/A[J.THUMB][J.WIDTH]<.5&&s.addClass(a.panoClass))),"horizontal"===a.thumbLayout?s.css({flexBasis:Math.round(.9*A[J.THUMB][J.WIDTH])}):"justified"===a.thumbLayout&&s.data("width",A[J.THUMB][J.WIDTH]),h.data("name")||h.attr("data-name",n.getItemName(A)),N&&(s.children("."+a.captionClass).length||e("<div>",{class:a.captionClass,html:N}).appendTo(s),s.addClass(a.hascaptionClass)),y){h.on("click."+u,w),h.data("href")||h.attr("data-href",h.attr("href")||n.getOptimalImagePath(A,[h[0].offsetWidth,h[0].offsetHeight])),h[0].hasAttribute("href")&&h.attr("href","");var E=i.length&&n.hasShop(A);if((E||d.length&&a.feedback)&&s.addClass(a.selectableClass),E&&(P=e("<a>",{class:"icon-shopping-cart add-cart",text:" "+o.addCart}).on("click."+u,function(t){var s=e(t.target).closest("."+a.cardClass);return s.length&&i.trigger("addItems",s.data(J.OBJ)),!1}).appendTo(h)).addTooltip(n.getPriceRange(A)),!E&&d.length&&a.feedback&&(P=e("<a>",{class:"icon-email-send add-cart",text:" "+a.feedback.addBtnLabel}).on("click."+u,function(t){var s=e(t.target).closest("."+a.cardClass);return s.length&&d.trigger("addItems",s.data(J.OBJ)),!1}).appendTo(h)),LOCAL&&!DEBUG||E||!a.hasOwnProperty("fotomoto")||n.hideFotomoto(A)||(P=e("<a>",{class:"icon-shopping-cart add-cart fotomoto-btn",text:" "+o.fotomotoBtn}).on("click."+u,function(t){if(t.preventDefault(),typeof FOTOMOTO!==UNDEF){var s=e(t.target).closest("."+a.cardClass);s.length&&FOTOMOTO.API.showWindow(10,n.getOriginalPath(s.data(J.OBJ))||n.getItemPath(s.data(J.OBJ)))}return!1}).appendTo(h)).addTooltip(o.fotomotoTooltip),!c&&a.linkToFolder){var R=n.getPath(A);R&&h.append(e("<a>",{class:"icon-folder folder-link",href:R+a.indexName}))}a.useAudioClipButton&&A.hasOwnProperty(J.AUDIOCLIP)&&(N=e("<a>",{class:"icon-volume-up audioclip",href:A[J.AUDIOCLIP][J.PATH]}).on("click",ae).appendTo(h),TOUCHENABLED||N.data("tooltip",o.audioClipLabel).addTooltip())}else s.addClass(A[J.CATEGORY]),h.attr("href",n.getItemPath(A));if(null!=k&&(P=A[J.DATES])&&(P=P[a.markNew.reference])&&P>=k&&(N=a.markNew.text?e("<span>",{class:"new-image",text:a.markNew.text}):e("<span>",{class:"icon-new-fill new-image"}),h.append(N),TOUCHENABLED||N.data("tooltip",new Date(1e3*P).toLocaleDateString(LOCALE)).addTooltip()),a.useRating&&y){var S=A[J.RATING]||0;(a.visitorRating||S)&&(N=e("<span>",{class:"rating",html:STARS}).appendTo(h),a.visitorRating?(A.hasOwnProperty(J.VISITORRATING)?S=A[J.VISITORRATING]:(a.useJalbumRating||(S=0),A[J.VISITORRATING]=S),N.addClass("r"+S+(a.useJalbumRating?"":" icon-close")).on("click."+u,function(t){var s=e(this),n=Math.minMax(0,Math.floor((getCoords(t).x-s.offset().left-parseFloat(s.css("paddingLeft")))/16),5),l=s.closest("."+a.cardClass).data(J.OBJ);return s.removeClass("r0 r1 r2 r3 r4 r5").addClass("r"+n),l[J.VISITORRATING]=n,c?re(r):(s=W(l[J.NAME],!0)).length&&(s.find(".rating").removeClass("r0 r1 r2 r3 r4 r5").addClass("r"+n),s.data(J.OBJ)[J.VISITORRATING]=n,re($())),!1})):N.addClass("r"+S))}a.rightClickProtect&&h.on("contextmenu",function(e){return e.preventDefault(),!1})}t.on("resize."+u,function(e){return clearTimeout(m),m=setTimeout(b,500),!0}),b(),window.requestAnimationFrame(v)}),this};var le=function(t,s){if(n){var r=H();if(r.length>1&&e(".filter-cont").length&&Je(s),r.filter("."+a.lbableClass).length){if(n.hasShop()||a.feedback){q().length&&(t.selectable({cardClass:a.selectableClass,selectedClass:a.selectedClass,selectionChange:function(e){i.add(d).trigger("itemsSelected",e)}}),c.add(h).find("."+a.keepSelectedClass).on("click."+u,function(){return de(o.selectedItems,function(){oe(),Ee()}),!1}),l.find("[data-sticky-rel]").trigger("stickyRefresh"),l.find("[data-sticky]").not("[data-sticky-rel]").sticky())}a.hasOwnProperty("map")&&(a.map.hasOwnProperty("apiKey")&&(e.fn.lightbox.defaults.mapApiKey=a.map.apiKey),a.map.hasOwnProperty("type")&&(e.fn.lightbox.defaults.mapType=a.map.type),a.map.hasOwnProperty("zoom")&&(e.fn.lightbox.defaults.mapZoom=a.map.zoom),a.map.index&&Se(Z(),a.map)),t.trigger("lightboxRemove"),t.lightbox(n,{baseSet:typeof s!==UNDEF&&s,onLoadStart:function(e){var t=e.data(J.OBJ);t&&addParam(a.pageName||a.indexName,{img:n.getItemName(t)},t[J.TITLE])},onLoadEnd:function(e){t.trigger("setactivecard",e),setTimeout(Ee,100)},onClose:function(e){a.slideshowFullscreen&&!a.slideshowFullscreenOnlyMobiles&&exitFullscreen(),removeParam(a.pageName||a.indexName,"img"),typeof e!==UNDEF&&t.trigger("setactivecard",e),t.trigger("refresh")},onVolumeChange:function(e){a.audioClipVolume=e},onReady:function(){if(m&&window.location.hash){m=!1;var t=readParam();if(t.hasOwnProperty("label")&&null!==t.label)fe(t.label,function(){addParam(a.indexName,{label:t.label+"",search:null,newimages:null,date:null},o.label+": "+t.label)});else if(t.hasOwnProperty("search")&&null!==t.search)he(t.search,function(){addParam(a.indexName,{search:t.search+"",label:null,newimages:null,date:null},o.search+": "+t.search)});else if(t.hasOwnProperty("newimages"))ye(ge(t.newimages),function(){addParam(a.indexName,{newimages:t.newimages,search:null,label:null,date:null},o.searchNew+": "+t.newimages)});else if(t.hasOwnProperty("date")){var s=me(t.date);ye(s,function(){addParam(a.indexName,{date:t.date,newimages:null,search:null,label:null},Ce(s.reference)+": "+t.date)})}else if(t.hasOwnProperty("img")&&null!==t.img){var n=W(t.img);n.length?t.hasOwnProperty("slideshow")?K(n,2e3):K(n):removeParam(a.pageName||a.indexName,"img")}else t.hasOwnProperty("slideshow")&&K(0,2e3)}e("."+a.startshowClass).fadeIn().on("click",function(){return e(this).trigger("removeTooltip"),ce(),!1})}})}else e("."+a.startshowClass).fadeOut()}},oe=function(e,t){"#"+paramize(e)!==window.location.hash&&(p=!0,e?setParam(a.pageName||a.indexName,e,t||""):removeParam(a.pageName||a.indexName),setTimeout(function(){p=!1},1e3))},ie=function(){if(window.location.hash!==f&&!p){f=window.location.hash,p=!1;var e=readParam();if(e.hasOwnProperty("label")&&null!==e.label)fe(e.label,function(){Ee()});else if(e.hasOwnProperty("search")&&null!==e.search)he(e.search,function(){Ee()});else if(e.hasOwnProperty("newimages")&&null!==e.newimages)ye(ge(e.newimages),function(){Ee()});else if(e.hasOwnProperty("date")&&null!==e.date){var t=me(e.date);ye(t,function(){Ee()})}else if(e.hasOwnProperty("img")&&null!==e.img){var s=W(e.img);s.length?e.hasOwnProperty("slideshow")?K(s,2e3):K(s):removeParam(a.indexName,"img")}else e.hasOwnProperty("slideshow")?K(0,2e3):(L().trigger("lightboxQuit"),_())}},ce=function(t){var s=e();return a.restartSlideshow||(s=H("."+a.activeClass)),s.length||(s=H().eq(0)),!a.slideshowFullscreen||a.slideshowFullscreenOnlyMobiles&&!SMALLSCREEN||requestFullscreen(function(){Y().addClass("fullscreen")}),K(s,2e3),!1},de=function(t,s){var n=Q();if(n.length&&n.length!==H("."+a.lbableClass).length){var r=V({className:"selected-items",icon:"icon-checkbox-checked",title:"&ldquo;"+t+"&rdquo;"});E(e("<small>",{text:o.foundNTimes.replace("{0}",n.length)})),x(),setTimeout(function(){r.renderImages(n,le),typeof s===FUNCTION&&s.call()},50)}},he=function(t,s){var r=V({className:"search-results",icon:"icon-search",title:"&ldquo;"+t+"&rdquo;"});R(),x(),n.collectItems(e.extend(a.search,{terms:t,depth:"tree",ready:function(){E(e("<small>",{text:this.length?o.foundNTimes.replace("{0}",this.length):o.notFound})),r.renderImages(this,le),S(),typeof s===FUNCTION&&s.call()}}))},ue=function(t){if(t.length&&n){a.search=e.extend({depth:"tree",fields:"creator,keywords,title,comment"},a.search);var s=function(e){var t=e.find("input").eq(0).val();return t&&t.length>1&&he(t,function(){oe({search:t},o.search+": "+t),Ee()}),!1};t.find(".search-btn").on("click",function(){return t.hasClass(a.activeClass)?(s(t),t.removeClass(a.activeClass)):(t.find("input").eq(0).focus(),t.addClass(a.activeClass)),!1}),t.on("submit",function(e){return e.preventDefault(),s(t),t.removeClass(a.activeClass),!1}),t.find("input").on("focus",function(){t.addClass(a.activeClass)})}},fe=function(t,s,r){var l=V({className:"tags-found",icon:"icon-tag",title:"&ldquo;"+t+"&rdquo;"});R(),x(),typeof s===UNDEF?s=!1:typeof s===FUNCTION&&(r=s,s=!1),n.collectItems(e.extend(a.tagCloud,{caseSensitive:s,terms:t,ready:function(){E(e("<small>",{text:this.length?o.foundNTimes.replace("{0}",this.length):o.notFound})),l.renderImages(this,le),S(),typeof r===FUNCTION&&r.call()}}))},pe=function(t){var s=e(a.tagCloud.hook||".tag-cloud-cont");if(s.length)if(t.length){var r=s.children("."+a.tagCloudClass),l=function(){var t=e(this).children("span").eq(0).text();return t&&t.length>1&&function(t,a,s){var r=V({className:"tags-found",icon:"icon-tag",title:"&ldquo;"+t+"&rdquo;"});R(),x(),n.collectByPath({paths:a,ready:function(){E(e("<small>",{text:this.length?o.foundNTimes.replace("{0}",this.length):o.notFound})),r.renderImages(this,le),S(),typeof s===FUNCTION&&s.call()}})}(t,e(this).data("paths"),function(){oe({label:t},o.label+": "+t),Ee()}),!1};r.length||(r=e("<div>",{class:a.tagCloudClass}).appendTo(s));for(var i,c,d,h=0,u=t.length;h<u;h++){if(i=e("<a>",{class:"tag"}).on("click",l).data("paths",t[h][1]).append(e("<span>",{html:t[h][0]})),t[h][1].length>1){if(a.tagCloud.fontVaries){for(c=0,d=Math.min(64,t[h][1].length);d>1;)c++,d>>=1;i.addClass("size-"+c)}i.append("&nbsp;").append(e("<sup>",{text:t[h][1].length}))}r.append(i)}r.outerHeight()>175&&function(t){var s;t.css({maxHeight:150,overflow:"hidden"}),(s=e("<div>",{class:"toggle-height"}).insertAfter(t)).append(e("<a>",{class:"icon-caret-down",text:o.more}).on("click",function(){var e=t.parent();e.css({height:e.height(),overflow:"hidden"}),t.css({maxHeight:"none"}),setTimeout(function(){var n=t.prop("scrollHeight");e.css({height:"auto",overflow:"visible"}),t.css({maxHeight:150}),setTimeout(function(){t.css({maxHeight:n+20})},25),s.addClass(a.activeClass)},50)})).append(e("<a>",{class:"icon-caret-up",text:o.less}).on("click",function(){t.css({maxHeight:150}),s.removeClass(a.activeClass)}))}(r),a.tagCloud.useSearch&&function(t){var s=t.find("."+a.tagSearchClass),n=function(e){var t=e.find("input").eq(0).val();return t&&t.length>1&&fe(t,function(){oe({label:t},o.label+": "+t),Ee()}),!1};s.length||((s=e("<form>",{class:a.tagSearchClass}).appendTo(t)).append(e("<div>",{class:"search-input"}).append(e("<input>",{type:"text",placeholder:o.searchPlaceholder,ariaLabel:o.search}))),s.append(e("<a>",{class:"search-btn icon-search"}))),s.find(".search-btn").on("click",function(){var t=e(this).closest("form");return t.find("input").eq(0).focus(),n(t),!1}),s.on("submit",function(t){return t.preventDefault(),n(e(this)),!1})}(s.parent())}else s.parents("section").eq(0).hide()},ge=function(e){return a.hasOwnProperty("searchNew")?{reference:a.searchNew.reference||"dateTaken",depth:a.searchNew.depth||"subfolders",start:C/ONEDAY_S-e}:{reference:"dateTaken",depth:"subfolders",start:C/ONEDAY_S-e}},me=function(e){var t=e.match(/^([amt])?([cts])?\:?(\d+)\-?(\d+)?/i),a={range:0,reference:"dateTaken",depth:"current"};return t&&(t[1]&&("a"===t[1]?a.added="added":"m"===t[1]?a.added="fileModified":"t"===t[1]&&(a.added="dateTaken")),t[2]&&("c"===t[2]?a.depth="current":"t"===t[2]?a.depth="tree":"s"===t[2]&&(a.depth="subfolders")),t[4]?(a.start=parseInt(t[3])||0,a.end=parseInt(t[4])):t[3]&&(a.start=parseInt(t[3]),a.range=1)),a},Ce=function(e){return"dateTaken"===e?o.imagesTaken:"fileModified"===e?o.imagesModified:o.imagesAdded},ve=function(e){var t,a=Ce(e.reference),s=(Math.floor(new Date/ONEDAY_MS),function(e){return new Date(e*ONEDAY_MS).toLocaleDateString(LOCALE)});return e.hasOwnProperty("end")||e.hasOwnProperty("start")?e.hasOwnProperty("end")?t=o.beforeDay.template(s(e.end)):e.hasOwnProperty("start")&&(t=e.hasOwnProperty("range")?e.range>1?o.betweenDays.template(s(e.start),s(e.start+e.range)):o.onDay.template(s(e.start)):getTimespan(C/ONEDAY_S-e.start)):t=getTimespan(e.range),a+" "+t},ye=function(t,a){var s=V({className:"search-results",icon:"icon-calendar",title:ve(t)});R(),x(),n.collectByDate(e.extend(t,{ready:function(){E(e("<small>",{text:this.length?o.foundNTimes.replace("{0}",this.length):o.notFound})),s.renderImages(this,le),S(),typeof a===FUNCTION&&a.call()}}))},be=function(t){return t&&ye(e.extend(a.searchNew,{start:C/ONEDAY_S-t}),function(){oe({newimages:t},Ce(a.searchNew.reference)),Ee()}),!1},Te=function(e,t){return e.hasOwnProperty(J.DATES)?"addedDate"===t?e[J.DATES].added:"originalDate"===t?e[J.DATES].dateTaken:e[J.DATES].fileModified:null},we=function(t,s){var n=e(t.target).closest("form"),r=Z(),l=r.length,i=[];if(n.find("select:visible,input[type=range],input[type=date]").each(function(){var t=this.name,s=n.find("label[for="+t+"]").text(),l=e(this).data("type"),o=e(this).val(),c=function(a){return"rating"===t?Math.round(a):"fileSize"===t?niceByte(a):"date"===l?new Date(1e3*a).toLocaleDateString(LOCALE):"numeric"===l?"seconds"===e(this).data("unit")?niceTime(a):"byte"===e(this).data("unit")?niceByte(a):a>=10?Math.round(a):a>=1?a.toFixed(1):a>=.1?a.toFixed(2):a:toCurrency(a,v)};if("numeric"===l||"date"===l||"financial"===l){var d=e(this).data("low"),h=e(this).data("high");if(d>this.min||h<this.max){if(t.endsWith("Date"))for(u=r.length-1;u>=0;u--)null!==(g=Te(r[u],t))&&g>=d&&g<=h||r.splice(u,1);else if(-1!==JCAMERAFIELDS.indexOf(t))if("exposureTime"===t)for(u=r.length-1;u>=0;u--)r[u].hasOwnProperty(J.CAMERA)&&r[u][J.CAMERA].hasOwnProperty(t)&&(g=getExposure(r[u][J.CAMERA][t]))&&g>=d&&g<=h||r.splice(u,1);else if(t.startsWith("focalLength"))for(u=r.length-1;u>=0;u--)r[u].hasOwnProperty(J.CAMERA)&&r[u][J.CAMERA].hasOwnProperty(t)&&!isNaN(g=parseFloat(r[u][J.CAMERA][t]))&&g>=d&&g<=h||r.splice(u,1);else for(u=r.length-1;u>=0;u--)r[u].hasOwnProperty(J.CAMERA)&&r[u][J.CAMERA].hasOwnProperty(t)&&!isNaN(g=parseFloat(r[u][J.CAMERA][t]))&&g>=d&&g<=h||r.splice(u,1);else if("rating"===t)for(var u=r.length-1,f=a.visitorRating?J.VISITORRATING:J.RATING;u>=0;u--)(g=r[u][f]||0)>=d&&g<=h||r.splice(u,1);else for(u=r.length-1;u>=0;u--)!isNaN(g=parseFloat(r[u][t]))&&g>=d&&g<=h||r.splice(u,1);i.push(s+"="+c(d)+"&ndash;"+c(h))}}else if("SELECT"===this.nodeName&&null!==o&&o.length){if(Array.isArray(o)||(o=[o]),-1!==JCAMERAFIELDS.indexOf(t))for(u=r.length-1;u>=0;u--)r[u].hasOwnProperty(J.CAMERA)&&r[u][J.CAMERA].hasOwnProperty(t)&&null!==(g=r[u][J.CAMERA][t])&&o.includes(g)||r.splice(u,1);else for(var p,g,u=r.length-1;u>=0;u--){if(r[u].hasOwnProperty(t))if(g=r[u][t],Array.isArray(g)){p=!1;for(var m=0;m<o.length;m++)if(g.includes(o[m])){p=!0;break}if(p)continue}else if(o.includes(g))continue;r.splice(u,1)}this.multiple?i.push(t+"=["+o.join(",")+"]"):i.push(s+"="+o)}}),r.length<l){var c=V({className:"filtered-items",icon:"icon-filter",title:o.results});R(),x(),setTimeout(function(){E(e("<small>",{html:i.join(", ")+": "+o.foundNTimes.replace("{0}",r.length)})),c.on("overlayRemoved",ke),c.renderImages(r,le),S(),typeof s===FUNCTION&&s.call()},50)}return!1},Oe=function(t,s){var n=this.selectedOptions[0],r=this.value;if(!n||!r)return!0;var l,i,c=Z(),d=(c.length,e(n).data("sort")),h=d.type,u=d.ascending;if("numeric"===h||"financial"===h||"date"===h)if(r.endsWith("Date"))c=c.sort(function(e,t){return l=Te(e,r),i=Te(t,r),u?(l||0)-(i||0):(i||0)-(l||0)});else if(-1!==JCAMERAFIELDS.indexOf(r))c="exposureTime"===r?c.sort(function(e,t){return l=e.hasOwnProperty(J.CAMERA)&&e[J.CAMERA].hasOwnProperty(r)?e[J.CAMERA][r]:0,i=t.hasOwnProperty(J.CAMERA)&&t[J.CAMERA].hasOwnProperty(r)?t[J.CAMERA][r]:0,u?getExposure(l||0)-getExposure(i||0):getExposure(i||0)-getExposure(l||0)}):c.sort(function(e,t){return l=e.hasOwnProperty(J.CAMERA)&&e[J.CAMERA].hasOwnProperty(r)?parseFloat(e[J.CAMERA][r]):0,i=t.hasOwnProperty(J.CAMERA)&&t[J.CAMERA].hasOwnProperty(r)?parseFloat(t[J.CAMERA][r]):0,u?(l||0)-(i||0):(i||0)-(l||0)});else if("rating"===r){var f=a.visitorRating?J.VISITORRATING:J.RATING;c=c.sort(function(e,t){return u?(e[f]||0)-(t[f]||0):(t[f]||0)-(e[f]||0)})}else c=c.sort(function(e,t){return e.hasOwnProperty(r)&&t.hasOwnProperty(r)?u?parseFloat(e[r])-parseFloat(t[r]):parseFloat(t[r])-parseFloat(e[r]):u?e.hasOwnProperty(r)?1:0:t.hasOwnProperty(r)?-1:0});else c=c.sort(function(e,t){return e.hasOwnProperty(r)&&t.hasOwnProperty(r)?u?(e[r]+"").localeCompare(t[r]+""):(t[r]+"").localeCompare(e[r]+""):u?e.hasOwnProperty(r)?1:0:t.hasOwnProperty(r)?-1:0});var p=V({className:"sorted-items",icon:"icon-ordering",title:o.sortedBy+"<small>"+d.label+" ("+o[d.ascending?"ascending":"descending"]+")</small>"});return R(),setTimeout(function(){p.renderImages(c,le),p.on("overlayRemoved",Ie),S(),typeof s===FUNCTION&&s.call()},50),!1},Ne=function(t){(typeof t===UNDEF||t.hasOwnProperty("target")?e(this).closest("form"):t).find("button[type=reset]").removeClass("disabled")},Pe=function(t){(typeof t===UNDEF||t.hasOwnProperty("target")?e(this).closest("form"):t).find("button[type=reset]").addClass("disabled")},Ae=function(t){t.find("select").each(function(){e(this).prop("selectedIndex",this.multiple?-1:0)}),t.find("input[type=range]").each(function(){e(this).trigger("resetRange")}),Pe(t)},xe=function(t){return Ae(e(t.target).closest("form")),!1},ke=function(){Ie(),Ae(e("#filters form.filter"))},Ie=function(){e("#filters form.sort select").prop("selectedIndex",0)},Je=function(t){var s=Z(),r=n.getPropertyObject(n.getCurrentFolder(),J.FILTERS,!0),l=n.getPropertyObject(n.getCurrentFolder(),J.SORT,!0),i=e("#filters");if((r||l)&&s.length){var c,d,h,f,p,g=i.find("."+a.boxClass),m=g.find("form.filter"),C=g.find("form.sort");if(t?g.addClass(a.hideOnOverlayClass):((g=e("<div>",{class:a.contClass+" "+a.boxClass+" small-column",id:"filters_"+O()}).appendTo(i)).append(e("<h4>",{class:"icon-"+(r?"filter":"ordering"),text:i.find("h4").text()})),r&&(m=e("<form>",{class:"filter"}).appendTo(g)),l&&(C=e("<form>",{class:"sort"}).appendTo(g)),M(g)),f=e("<div>",{class:"buttons"}).appendTo(m),r){r=function(e,t){if(t&&e.length){var s=function(e,t){e.hasOwnProperty("min")&&e.hasOwnProperty("min")?e.min>t?e.min=t:e.max<t&&(e.max=t):e.min=e.max=t};for(var n in t){var r=t[n],l=r.type;if("numeric"===l||"date"===l||"financial"===l)if(n.endsWith("Date"))for(o=e.length-1;o>=0;o--)null!==(c=Te(e[o],n))&&s(r,c);else if(-1!==JCAMERAFIELDS.indexOf(n))if("exposureTime"===n)for(o=e.length-1;o>=0;o--)e[o].hasOwnProperty(J.CAMERA)&&e[o][J.CAMERA].hasOwnProperty(n)&&(c=getExposure(e[o][J.CAMERA][n]))&&s(r,c);else if(n.startsWith("focalLength"))for(o=e.length-1;o>=0;o--)e[o].hasOwnProperty(J.CAMERA)&&e[o][J.CAMERA].hasOwnProperty(n)&&!isNaN(c=parseFloat(e[o][J.CAMERA][n]))&&s(r,c);else for(o=e.length-1;o>=0;o--)e[o].hasOwnProperty(J.CAMERA)&&e[o][J.CAMERA].hasOwnProperty(n)&&!isNaN(c=parseFloat(e[o][J.CAMERA][n]))&&s(r,c);else if("rating"===n)for(var o=e.length-1,i=a.visitorRating?J.VISITORRATING:J.RATING;o>=0;o--)s(r,c=e[o][i]||0);else for(o=e.length-1;o>=0;o--)isNaN(c=parseFloat(e[o][n]))||s(r,c);else if(r.hasOwnProperty("values")||(r.values=[]),-1!==JCAMERAFIELDS.indexOf(n))for(o=0;o<e.length;o++)e[o].hasOwnProperty(J.CAMERA)&&e[o][J.CAMERA].hasOwnProperty(n)&&pushNew(r.values,(e[o][J.CAMERA][n]+"").trim());else{for(var c,o=0;o<e.length;o++)e[o].hasOwnProperty(n)&&pushNew(r.values,e[o][n]);r.values.length>1&&(r.values=r.values.sort(function(e,t){return e.localeCompare(t)}))}}return t}}(s,r);var v;for(var y in r){if(h=r[y].type,c=e("<div>",{class:"group "+("multiple_string"===h||"single_string"===h?"select":"range")}).insertBefore(f),r[y].label&&e("<label>",{for:y,text:r[y].label}).appendTo(c),"multiple_string"===h||"single_string"===h)if("rating"===y&&(r[y].values=[o.noRating,1,2,3,4,5]),d=e("<select>",{id:y,name:y}).appendTo(c),"multiple_string"===h&&(d.attr("multiple",!0),d.addTooltip(o.multipleSelectHint)),r[y].hasOwnProperty("values")&&r[y].values.length){if("single_string"===h&&d.prepend(e("<option>",{text:o.select,disabled:"",selected:""})),r[y].values)for(var b=0;b<r[y].values.length;b++)d.append(e("<option>",{text:r[y].values[b]}));d.on("change",Ne)}else c.remove();else d=e("<input>",{id:y,name:y,type:"range"}).data("type",h).prependTo(c),"rating"===y&&(r[y].step=1,r[y].min=0,r[y].max=5),r[y].hasOwnProperty("min")&&r[y].hasOwnProperty("max")&&r[y].min!==r[y].max?("financial"===h&&(v=r[y].label.match(/\S+\s+[\(\[](\S+)[\)\]]/))?r[y].currency=v[1]:"numeric"===h&&("exposureTime.shutterSpeed".indexOf(y)>=0?r[y].unit="seconds":"fileSize"===y&&(r[y].unit="byte",r[y].step=1)),r[y].onChanged=Ne,r[y].onReseted=Pe,d.rangeSlider(r[y])):c.remove();d.attr("data-type",h||"single_string")}(d=m.find("input,select")).length&&(m.data("single",1===d.length&&"SELECT"===d[0].nodeName&&!d.attr("multiple")),t&&m.data("single")||(p=e("<button>",{type:"reset",class:(t?"disabled secondary":"alert")+" button",text:" "+o.reset}).appendTo(f),t?p.on("click."+u,xe):p.on("click."+u,function(){ke(),_()})),m.data("single")?d.on("change."+u,we):((p=m.find("button[type=submit]")).length||(p=e("<button>",{type:"submit",class:"button",text:" "+o.search}).appendTo(f)),p.on("click."+u,we)),m.on("submit."+u,we))}if(f.is(":empty")&&f.remove(),l){e("<label>",{class:"icon-ordering",for:"sortby",text:" "}).appendTo(C),(d=e("<select>",{class:"small",id:"sortby",name:"sortby"}).appendTo(C)).prepend(e("<option>",{text:o.sortBy,disabled:"",selected:""}));for(var T in l)d.append(e("<option>",{html:"&#8613; "+l[T].label,value:T}).data("sort",{type:l[T].type,label:l[T].label,ascending:!0})),d.append(e("<option>",{html:"&#8615; "+l[T].label,value:T}).data("sort",{type:l[T].type,label:l[T].label,asc:!1}));d.on("change."+u,Oe)}C&&C.length&&!C.is(":empty")||m&&m.length&&!m.is(":empty")||i.hide()}else t&&i.hide()},Ee=function(){if(a.hasOwnProperty("share"))if(Y().is(":visible")){var t=X();t&&e(a.share.hook).trigger("updateLinks",{sites:a.share,title:t[J.TITLE]||t[J.NAME].stripExt().replace(/[-_]/g," ").capitalize(),description:t[J.COMMENT]||"",image:n.getOptimalImagePath(t,[1200,800]),href:n.getAbsolutePath(t)})}else e(a.share.hook).trigger("updateLinks")},Re=function(t){e.fn.renderShares.defaults.buttonTheme=t.buttonTheme||"dark",e.fn.renderShares.defaults.indexName=a.indexName,e.fn.renderShares.defaults.facebookAppId=t.facebookAppId||"",e.fn.renderShares.defaults.albumTitle=n.getAlbumTitle(),t.hasOwnProperty("emailSubject")&&(e.fn.renderShares.defaults.emailSubject=t.emailSubject),t.hasOwnProperty("emailBody")&&(e.fn.renderShares.defaults.emailBody=t.emailBody),e(t.hook).renderShares(t),t.hasOwnProperty("sites")&&(e.fn.lightbox.defaults.share=t.sites,e.fn.lightbox.defaults.shareHook=t.hook)},Se=function(t,a){var s,r=z(!0);r.data("inited")||((s=function(e){for(var t,a=[],s=0;s<e.length;s++)e[s]&&(t=n.getLocation(e[s]))&&a.push({title:[s+1+".",e[s].title,e[s].comment].filter(Boolean).join(" "),pos:t,link:e[s].path});return a}(t)).length||a.hasOwnProperty("overlay")?(s.length&&(a.markers=s),r.closest("section").removeClass("hidden"),r.addMap(e.extend({type:"hybrid",zoom:15,autoLoad:!0,fullscreenControl:a.fullscreenEnabled,onMarkerClick:function(){if(this.hasOwnProperty("link")){var e=W(this.link);e.length&&(isFullscreen()&&exitFullscreen(),Y().is(":visible")||P().trigger("setactivecard",e),K(e))}}},a))):r.closest("section").addClass("hidden")),r.data("inited",!0)},Me=function(){a.hasOwnProperty("tagCloud")&&"current"!==a.tagCloud.depth&&n.collectTags(e.extend(a.tagCloud,{ready:function(){pe(this)}}))},De=function(){if(n){var t,s,r=n.getFolders(),l=a.markNew.days*ONEDAY_S;j(":not(.webloc)").each(function(n){n<r.length&&(s=r[n][J.DATES])&&(s=s[a.markNew.reference]||s[J.DATERANGE][1]||s[J.DATERANGE][0])&&C-s<l&&(t=a.markNew.text?e("<span>",{class:"new-image",text:a.markNew.text}):e("<span>",{class:"icon-new-fill new-image"}),TOUCHENABLED||t.data("tooltip",new Date(1e3*s).toLocaleDateString(LOCALE)).addTooltip(),e(this).find("."+a.thumbClass).eq(0).append(t))})}},Fe=function(e){var t={images:0,audios:0,videos:0,others:0};return e.children().each(function(e){var a=this.innerText.split(/\W/),s=this.classList[0];if(!s&&a.length>1)switch(a[1]){case o.image:case o.images:s="images";break;case o.audio:case o.audios:s="audios";break;case o.video:case o.videos:s="videos";break;case o.other:case o.others:s="others";break;default:s="images"}t[s]+=parseInt(a[0])||0}),t},Be=function(e){var t="";return e.images&&(t+='<span class="image">'+e.images+"&nbsp;"+translate(e.images>1?"images":"image")+"</span>"),e.audios&&(t+='<span class="audio">'+e.audios+"&nbsp;"+translate(e.audios>1?"audios":"audio")+"</span>"),e.videos&&(t+='<span class="video">'+e.videos+"&nbsp;"+translate(e.videos>1?"videos":"video")+"</span>"),e.others&&(t+='<span class="other">'+e.others+"&nbsp;"+translate(e.others>1?"others":"other")+"</span>"),t},Le=function(){var t=j();t.length&&(a.hasOwnProperty("markNew")&&setTimeout(De,300),setTimeout(function(){ee(),t.filter("."+a.preloadClass+":first-child img").one("load",function(){e(this).parents("."+a.preloadClass).removeClass(a.preloadClass)}),(!LOCAL||DEBUG)&&a.hasOwnProperty("weblocationCounts")&&a.weblocationCounts&&t.filter(".webloc.has-count").each(function(){var t,a=e(this).children(".caption"),s=Fe(a.find(".counts"));loadExternal(e(this).children(".thumb").attr("href"),function(){typeof this===OBJECT&&this.hasOwnProperty(J.DEEPCOUNTERS)&&(function(e){for(var t in e)if(0!==e[t])return!1;return!0}(t=function(e,t){var a={images:0,audios:0,videos:0,others:0};for(var s in e)t.hasOwnProperty(s)&&e[s]!==t[s]&&(a[s]=e[s]-t[s]);return a}(this[J.DEEPCOUNTERS],s))||(a.find(".counts").empty().append(Be(this[J.DEEPCOUNTERS])),function(t){var a=e(".footer .counts"),s=Fe(a);for(var n in s)0!==t[n]&&(s[n]+=t[n]);a.empty().append(Be(s))}(t)))})})},500))};return window.location.search&&removeSearch(),restoreScrollPosition(),e(window).on("beforeunload."+u,saveScrollPosition),loadPrefs(a,["audioClipVolume"],"lb_pref"),passDefaults(a,e.fn.lightbox.defaults,"indexName,level,previousFoldersLast,previousFolderPath,nextFoldersFirst,nextFolderPath,extraSizes,hiDpiThumbs,hiDpiImages,audioClipVolume,lightboxFullscreen,slideshowFullscreen,rightClickProtect,enableKeyboard,enableMouseWheel,fotomoto,useRating,visitorRating,lbableClass"),passDefaults(a.lightbox,e.fn.lightbox.defaults),function(t){typeof Album===UNDEF&&console.log("Critical Error: Missing jalbum.album.js library!");var s=a.hasOwnProperty("tagCloud")&&"current"!==a.tagCloud.depth||"page"===a.pageType&&"newimages"===a.pageName,r={makeDate:a.makeDate,rootPath:a.rootPath,relPath:a.relPath,hiDpiImages:a.hiDpiImages||!1,hiDpiThumbs:a.hiDpiThumbs||!1,thumbDims:a.thumbDims||[212,170],thumbsFillFrame:a.thumbsFill||!1,ready:"index"===a.pageType?function(){if(n){var t=n.getImages();G().each(function(){var t=e(this).find("a");t.data("href",t.attr("href")),t.attr("href","")}),Le(),e.fn.hasOwnProperty("paypal")&&n.hasShop()&&(i=e("#shop-root"),c=e("#shop .box"),i.length&&(v=n.getCurrency(),e.fn.hasOwnProperty("rangeSlider")&&v&&(e.fn.rangeSlider.defaults.currency=v),i.paypal(n,{resPath:a.resPath,relPath:a.relPath,rootPath:a.rootPath,currency:v,getSelected:Q,selectNone:function(){A().trigger("selectNone")},getCurrent:X,useFloatButton:!(i.parents(".shop-cont[data-sticky]").length||document.body.clientWidth>=640)}),i.find("."+a.addSelectedClass).on("click",function(){return i.trigger("addItems",Q()),A().trigger("selectNone"),!1}),e.fn.lightbox.defaults.hasOwnProperty("shop")||(e.fn.lightbox.defaults.shop={}),e.fn.lightbox.defaults.shop.root=i)),a.hasOwnProperty("feedback")&&(d=e("#feedback-root"),h=e("#feedback .box"),d.length&&(d.feedback(n,e.extend({},a.feedback,{resPath:a.resPath,relPath:a.relPath,rootPath:a.rootPath,getSelected:Q,selectNone:function(){A().trigger("selectNone")},getCurrent:X,useFloatButton:!(d.parents(".feedback-cont[data-sticky]").length||document.body.clientWidth>=640)})),d.find("."+a.addSelectedClass).on("click",function(){return d.trigger("addItems",Q()),A().trigger("selectNone"),!1}),e.fn.lightbox.defaults.hasOwnProperty("feedback")||(e.fn.lightbox.defaults.feedback={}),e.fn.lightbox.defaults.feedback.root=d,e.fn.lightbox.defaults.feedbackBtnLabel=a.feedback.viewBtnLabel,e.fn.lightbox.defaults.feedbackAddBtnLabel=a.feedback.addBtnLabel,e.fn.lightbox.defaults.feedbackBtnTooltip=a.feedback.addBtnTooltip)),c.add(h).find("."+a.selectAllClass).on("click",function(){return P().trigger("selectAll"),!1}),c.add(h).find("."+a.selectNoneClass).on("click",function(){return P().trigger("selectNone"),!1}),t.length?(A().renderImages(t,le,!0),e(a.startSlideshowHook).on("click",ce)):(window.location.hash&&ie(),e(a.startSlideshowHook).hide()),a.hasOwnProperty("tagCloud")&&"current"===a.tagCloud.depth&&n.collectTags(e.extend(a.tagCloud,{ready:function(){pe(this)}})),a.hasOwnProperty("search")&&ue(e(a.search.hook)),a.hasOwnProperty("searchNew")&&function(t){if(t.length&&n){a.searchNew=e.extend({days:"3,30,90",depth:"folder",reference:"dateTaken",sinceLastVisit:!0},a.searchNew);var s=a.searchNew.days.split(",");t.append(e("<label>",{text:Ce(a.searchNew.reference)})),t=e("<div>",{class:"buttons"}).appendTo(t);for(var r=0;r<s.length;r++)t.append(e("<a>",{class:"small button",text:getTimespan(s[r])}).data("days",parseInt(s[r],10)).on("click",function(){be(e(this).data("days"))}));if(a.searchNew.sinceLastVisit){var l=e.cookie("lastVisit"),i=Math.round(new Date/1e3);l&&l<i-ONEDAY_S&&t.append(e("<a>",{class:"small button",text:o.sinceMyLastVisit}).on("click",function(){be((i-l)/ONEDAY_S)})),e.cookie("lastVisit",i,31536e4)}}}(e(a.searchNew.hook)),a.hasOwnProperty("share")&&Re(a.share);var s=e("[data-slider]");if(s.length){var r=s.data("slider")||{},l=[s.innerWidth(),s.innerHeight()];if(r.hasOwnProperty("names")){for(var u=0;u<r.names.length;u++)r.names[u]=[a.relPath,r.names[u]].filter(Boolean).join("/");n.collectByPath({folder:a.relPath,paths:r.names,levels:0,ready:function(){r.src=[];for(var e in this)r.src.push(n.getOptimalImagePath(this[e],l,!0,!0));s.easySlider(r)}})}else n.collectNItem({folder:a.relPath,max:50,quick:!0,levels:2,include:"images",sortBy:"random",arRange:[Math.min(1,.5*l[0]/l[1]),Math.max(1,2*l[0]/l[1])],ready:function(){r.src=[];for(var e in this)r.src.push(n.getOptimalImagePath(this[e],l,!0,!0));s.easySlider(r)}})}var f=e("[data-jalbum-query]");if(f.length){var p=f.data("jalbum-query");p.hasOwnProperty("fn")&&n[p.fn](e.extend(p,{ready:function(t){for(var s,r=0,l=Math.min(this.length,10);r<l;r++)s=this[r],e("<a>",{href:n.getLink(s)}).appendTo(f).append(e("<img>",{src:n.getThumbPath(s),width:s[J.THUMB][J.WIDTH],height:s[J.THUMB][J.HEIGHT],alt:s[J.TITLE]||s[J.NAME]}));this.length>10&&f.append(e("<a>",{class:"more",href:p.linkMore,text:"+"+(this.length-10)})),a.rightClickProtect&&f.on("contextmenu","img",function(e){return e.preventDefault(),!1})}}))}}}:function(){a.hasOwnProperty("search")&&ue(e(a.search.hook)),a.hasOwnProperty("share")&&Re(a.share),a.pageName=window.location.pathname.getFile();var t=[];H().each(function(){var s=e(this).find("."+a.thumbClass);s.data("href",s.attr("href")),s.attr("href",""),t.push(e(this).data(J.PATH))}),t.length&&n.collectByPath({paths:t,ready:function(){this.length&&(A().renderImages(this,le,!0),a.hasOwnProperty("map")&&Se(this,a.map))}})},loadDeep:s};a.indexName!==e.fn.skin.defaults.indexName&&(r.indexName=a.indexName),a.audioPoster!==e.fn.skin.defaults.audioPoster&&(r.audioPoster=a.audioPoster),a.videoPoster!==e.fn.skin.defaults.videoPoster&&(r.videoPoster=a.videoPoster),s&&(r.deepReady=Me),n=new Album(e,r)}(),a.rightClickProtect&&G().add(j()).on("contextmenu","img",function(e){return e.preventDefault(),!1}),function(e){e.length&&e.audioPlayer({rootPath:a.rootPath})}(e("[data-audioPlayer]")),t.on("hashchange."+u,ie),r.on("overlayReady."+u,function(e,t){moveInView(t)}),e("[data-topnav-toggle]").on({click:function(){return s.toggleClass("menu-on"),!1},selectstart:function(e){return e.preventDefault(),!1}}),a.scrollToTopButton&&s.scrollToTopBtn(),hasFullscreen()&&(e("[data-fullscreen-toggle]").on("click",function(){var t=e(this);isFullscreen()?exitFullscreen(function(){s.removeClass("fullscreen"),t.removeClass("icon-fullscreen-off").addClass("icon-fullscreen")}):requestFullscreen(function(){s.addClass("fullscreen"),t.removeClass("icon-fullscreen").addClass("icon-fullscreen-off")})}),window.innerWidth<640&&goFullscreenOnLandscapeChange(function(){s.addClass("fullscreen")})),this.getAlbum=function(){return n},this},e.fn.skin.defaults={locale:"en-US",contentClass:"content",contClass:"cont",startSlideshowHook:".hero .start-show",hasOverlayClass:"has-overlay",baseOverlayClass:"base-overlay",hideOnOverlayClass:"hide-on-overlay",overlayClass:"overlay",overlayTitleClass:"title",overlayHeadLevel:3,progressbarClass:"progressbar",lightboxClass:"lightbox",sliderClass:"slider",belowfoldClass:"below-fold",foldersClass:"folders",folderClass:"folder",thumbnailsClass:"thumbnails",thumbClass:"thumb",boxClass:"box",mapBoxHook:"section.map",mapRootClass:"map-root",tagCloudClass:"tag-cloud",tagSearchClass:"tag-search",thumbLayout:"fixgrid",thumbsFill:!0,useAudioClipButton:!1,columns:5,thumbDims:[212,170],thumbGap:6,fixedShapeThumbs:!1,imageClass:"image",captionClasses:"over bottom hover",cardClass:"card",folderCardClass:"foldercard",mosaicClass:"mosaic",captionPlacement:"below",lbableClass:"lbable",captionClass:"caption",commentClass:"comment",hascaptionClass:"hascaption",selectableClass:"selectable",selectedClass:"checked",activeClass:"active",preloadClass:"preload",lazyloadClass:"lazyload",hideImageClass:"hide-image",showImageClass:"show-image",startshowClass:"start-btn",fullscreenClass:"fullscreen",panoClass:"pano",selectBoxClass:"select-box",selectAllClass:"select-all",selectNoneClass:"select-none",keepSelectedClass:"keep-selected",addSelectedClass:"add-selected",scrollCheckInterval:250,indexName:"index.html",audioPoster:"audio.poster.png",videoPoster:"video.poster.png",dateFormat:"M/d/yyyy",audioClipVolume:.75,lightboxFullscreen:!1,slideshowFullscreen:!1,rightClickProtect:!1,useRating:!1,jalbumRating:!1,visitorRating:!1,enableKeyboard:!0,videoAuto:!0,linkToFolder:!0,scrollToTopButton:!0}}(jQuery,jQuery(window),jQuery(document),jQuery("body"));
