<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>View Data</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #000;
      color: #fff;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #333;
      color: #fff;
    }
    .numeric {
      background-color: #222;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Totals Data</h1>
    <div id="TotalsTableContainer"></div>
    <button onclick="window.close()">Close</button>
  </div>

  <script>
    // Function to generate and display tables
    function populateTotalsTable(allTotals) {
      let output = "";

      // Define the two header orders
      const headerOrder1 = [18, 6, 21, 33, 16, 4, 23, 35, 14, 2, 0, 28, 9, 26, 30, 11, 7, 20, 32];
      const headerOrder2 = [17, 5, 22, 34, 15, 3, 24, 36, 13, 1, '00', 27, 10, 25, 29, 12, 8, 19, 31];

      function generateTable(headerOrder, data, isSecondTable = false) {
        let tableOutput = "<table>";

        // Header row
        tableOutput += "<tr>";

        // Create the header cells
        headerOrder.forEach((number, index) => {
          const headerLabel = number.toString();
          let colorClass;
          if (headerLabel === '0' || headerLabel === '00') {
            colorClass = 'green-header';
          } else if (isSecondTable) { // For headerOrder2
            colorClass = (index % 2 === 0) ? 'black-header' : 'red-header'; // Start with black and alternate
          } else { // For headerOrder1
            colorClass = (index % 2 === 0) ? 'red-header' : 'black-header'; // Start with red and alternate
          }
          tableOutput += "<th class='bold " + colorClass + "'>" + headerLabel + "</th>";
        });

        // Close the header row
        tableOutput += "</tr>";

        // Data rows
        data.forEach((totals, runIndex) => {
          tableOutput += "<tr>";

          headerOrder.forEach((number) => {
            let cellValue;
            if (number === '00') { // Handle '00' as alias for 37
              cellValue = totals[37];
            } else {
              cellValue = totals[number];
            }
            // Replace 0 with empty string
            cellValue = (cellValue === 0) ? '&nbsp;' : cellValue; // Use non-breaking space for consistent row height
            tableOutput += `<td class='numeric'>${cellValue}</td>`;
          });

          tableOutput += "</tr>";
        });

        tableOutput += "</table>";

        return tableOutput;
      }

      // Generate both tables for each set of Totals
      allTotals.forEach((totals, index) => {
        output += `<h2>Run ${index + 1}</h2>`;
        output += generateTable(headerOrder1, [totals]);
        output += "<br>";
        output += generateTable(headerOrder2, [totals], true); // Pass true for the second table
        output += "<br>";
      });

      document.getElementById('TotalsTableContainer').innerHTML = output; // Update TotalsTable content
    }

    // Retrieve allTotals from local storage
    const allTotals = JSON.parse(localStorage.getItem('allTotals')) || [];
    populateTotalsTable(allTotals);
  </script>
</body>
</html>
