<!DOCTYPE html>
<html>
<head>
    <title>Roulette Wheel Animation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
    </style>
</head>
<body>
    <script>
        let wheelRadius = 200;
        let wheelCenterX;
        let wheelCenterY;
        let numSlots = 37;
        let slotAngle;
        let ballRadius = 10;
        let ballX;
        let ballY;
        let ballSpeed;
        let ballAngle;
        let ballGravity = 0.1;
        let ballFriction = 0.99;
        let slotColors = [];
        let slotNumbers = [];
        let winningIndex = null;
        let isSpinning = true;

        function setup() {
            createCanvas(windowWidth, windowHeight);
            wheelCenterX = width / 2;
            wheelCenterY = height / 2;
            slotAngle = 360 / numSlots;

            // Initialize slot numbers in specified order
            slotNumbers = [18, 6, 21, 33, 16, 4, 23, 35, 14, 2, '0', 28, 9, 26, 30, 11, 7, 20, 32, 17, 5, 22, 34, 15, 3, 24, 36, 13, 1, '00', 27, 10, 25, 29, 12, 8, 19, 31];

            // Initialize slot colors
            for (let i = 0; i < numSlots; i++) {
                if (slotNumbers[i] === '0' || slotNumbers[i] === '00') {
                    slotColors.push(color(0, 255, 0)); // Green for 0 and 00
                } else {
                    // Alternate colors between red and black, starting with red for 18
                    slotColors.push((i % 2 === 0) ? color(255, 0, 0) : color(0)); // Red and Black
                }
            }

            // Initialize the ball's random starting position and speed
            let randomAngle = random(0, 360);
            ballAngle = randomAngle;
            ballSpeed = random(3, 8);
            ballX = wheelCenterX + (wheelRadius - ballRadius) * Math.cos(radians(ballAngle));
            ballY = wheelCenterY + (wheelRadius - ballRadius) * Math.sin(radians(ballAngle));
        }

        function draw() {
            background(0);

            // Draw the wheel
            noStroke();
            fill(255);
            ellipse(wheelCenterX, wheelCenterY, wheelRadius * 2, wheelRadius * 2);
            stroke(255);
            for (let i = 0; i < numSlots; i++) {
                let angle = i * slotAngle * Math.PI / 180;
                let x = wheelCenterX + wheelRadius * Math.cos(angle);
                let y = wheelCenterY + wheelRadius * Math.sin(angle);
                line(wheelCenterX, wheelCenterY, x, y);
                fill(slotColors[i]);
                ellipse(x, y, 30, 30);
                fill(255);
                textAlign(CENTER, CENTER);
                textSize(16);
                text(slotNumbers[i], x, y);
            }

            if (isSpinning) {
                // Update and draw the ball
                ballY += ballGravity;
                ballSpeed *= ballFriction;
                ballAngle += ballSpeed;
                ballX = wheelCenterX + (wheelRadius - ballRadius) * Math.cos(radians(ballAngle));
                ballY = wheelCenterY + (wheelRadius - ballRadius) * Math.sin(radians(ballAngle));

                // Check if the ball has landed
                if (ballY > wheelCenterY + wheelRadius - ballRadius) {
                    ballY = wheelCenterY + wheelRadius - ballRadius;
                    ballSpeed *= -0.8;
                    if (Math.abs(ballSpeed) < 0.1) {
                        isSpinning = false; // Stop spinning when the ball slows down
                        winningIndex = determineWinner();
                    }
                }

                fill(255);
                ellipse(ballX, ballY, ballRadius * 2, ballRadius * 2);
            }

            // Highlight the winning number
            if (winningIndex !== null) {
                let angle = (winningIndex + 0.5) * slotAngle * Math.PI / 180; // Center the winning number
                let x = wheelCenterX + (wheelRadius - 30) * Math.cos(angle);
                let y = wheelCenterY + (wheelRadius - 30) * Math.sin(angle);
                stroke(255);
                strokeWeight(5);
                ellipse(x, y, 35, 35);
                strokeWeight(1);
                fill(255);
                textAlign(CENTER, CENTER);
                textSize(18);
                text(slotNumbers[winningIndex], x, y);
            }
        }

        function determineWinner() {
            let angle = atan2(ballY - wheelCenterY, ballX - wheelCenterX) * 180 / Math.PI;
            if (angle < 0) angle += 360;
            let index = Math.floor((angle / 360) * numSlots);
            index = (index + numSlots) % numSlots; // Ensure index is within bounds
            return index;
        }
    </script>
</body>
</html>
